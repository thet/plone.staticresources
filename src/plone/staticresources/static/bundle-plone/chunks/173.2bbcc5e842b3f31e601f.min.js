(window.webpackJsonp=window.webpackJsonp||[]).push([[173],{620:function(n,t,e){(function(n){!function(){"use strict";var t=function(){},e=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n(t.apply(null,e))}},o=function(n){return function(){return n}},r=function(n){return n};function i(n){for(var t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=t.concat(e);return n.apply(null,r)}}var u=function(n){return function(t){return!n(t)}},a=function(n){return function(){throw new Error(n)}},c=o(!1),s=o(!0),f=tinymce.util.Tools.resolve("tinymce.ThemeManager"),l=function(){return(l=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++)for(var r in t=arguments[e])Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}).apply(this,arguments)};function d(n,t){var e={};for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&t.indexOf(o)<0&&(e[o]=n[o]);if(null!=n&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(n);r<o.length;r++)t.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(n,o[r])&&(e[o[r]]=n[o[r]])}return e}function m(){for(var n=0,t=0,e=arguments.length;t<e;t++)n+=arguments[t].length;var o=Array(n),r=0;for(t=0;t<e;t++)for(var i=arguments[t],u=0,a=i.length;u<a;u++,r++)o[r]=i[u];return o}var g,p=function(){return h},h=function(){var n=function(n){return n.isNone()},e=function(n){return n()},r=function(n){return n};return{fold:function(n,t){return n()},is:c,isSome:c,isNone:s,getOr:r,getOrThunk:e,getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:o(null),getOrUndefined:o(void 0),or:r,orThunk:e,map:p,each:t,bind:p,exists:c,forall:s,filter:p,equals:n,equals_:n,toArray:function(){return[]},toString:o("none()")}}(),v=function(n){var t=o(n),e=function(){return i},r=function(t){return t(n)},i={fold:function(t,e){return e(n)},is:function(t){return n===t},isSome:s,isNone:c,getOr:t,getOrThunk:t,getOrDie:t,getOrNull:t,getOrUndefined:t,or:e,orThunk:e,map:function(t){return v(t(n))},each:function(t){t(n)},bind:r,exists:r,forall:r,filter:function(t){return t(n)?i:h},toArray:function(){return[n]},toString:function(){return"some("+n+")"},equals:function(t){return t.is(n)},equals_:function(t,e){return t.fold(c,(function(t){return e(n,t)}))}};return i},b={some:v,none:p,from:function(n){return null==n?h:v(n)}},y=function(n){return function(t){return function(n){var t=typeof n;return null===n?"null":"object"===t&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===t&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":t}(t)===n}},x=function(n){return function(t){return typeof t===n}},w=y("string"),S=y("object"),k=y("array"),C=x("boolean"),O=function(n){return function(t){return n===t}}(void 0),_=function(n){return!function(n){return null==n}(n)},T=x("function"),E=x("number"),D=function(n,t){if(k(n)){for(var e=0,o=n.length;e<o;++e)if(!t(n[e]))return!1;return!0}return!1},B=Array.prototype.slice,A=Array.prototype.indexOf,M=Array.prototype.push,F=function(n,t){return A.call(n,t)},I=function(n,t){return F(n,t)>-1},R=function(n,t){for(var e=0,o=n.length;e<o;e++){if(t(n[e],e))return!0}return!1},V=function(n,t){for(var e=[],o=0;o<n;o++)e.push(t(o));return e},P=function(n,t){for(var e=[],o=0;o<n.length;o+=t){var r=B.call(n,o,o+t);e.push(r)}return e},H=function(n,t){for(var e=n.length,o=new Array(e),r=0;r<e;r++){var i=n[r];o[r]=t(i,r)}return o},z=function(n,t){for(var e=0,o=n.length;e<o;e++){t(n[e],e)}},N=function(n,t){for(var e=[],o=[],r=0,i=n.length;r<i;r++){var u=n[r];(t(u,r)?e:o).push(u)}return{pass:e,fail:o}},L=function(n,t){for(var e=[],o=0,r=n.length;o<r;o++){var i=n[o];t(i,o)&&e.push(i)}return e},j=function(n,t,e){return function(n,t){for(var e=n.length-1;e>=0;e--){t(n[e],e)}}(n,(function(n){e=t(e,n)})),e},U=function(n,t,e){return z(n,(function(n){e=t(e,n)})),e},W=function(n,t){return function(n,t,e){for(var o=0,r=n.length;o<r;o++){var i=n[o];if(t(i,o))return b.some(i);if(e(i,o))break}return b.none()}(n,t,c)},G=function(n,t){for(var e=0,o=n.length;e<o;e++){if(t(n[e],e))return b.some(e)}return b.none()},X=function(n){for(var t=[],e=0,o=n.length;e<o;++e){if(!k(n[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+n);M.apply(t,n[e])}return t},Y=function(n,t){return X(H(n,t))},q=function(n,t){for(var e=0,o=n.length;e<o;++e){if(!0!==t(n[e],e))return!1}return!0},J=function(n){var t=B.call(n,0);return t.reverse(),t},K=function(n,t){return L(n,(function(n){return!I(t,n)}))},$=function(n,t){var e=B.call(n,0);return e.sort(t),e},Q=function(n,t){return t>=0&&t<n.length?b.some(n[t]):b.none()},Z=function(n){return Q(n,0)},nn=function(n){return Q(n,n.length-1)},tn=T(Array.from)?Array.from:function(n){return B.call(n)},en=function(n,t){for(var e=0;e<n.length;e++){var o=t(n[e],e);if(o.isSome())return o}return b.none()},on=function(n){return{is:function(t){return n===t},isValue:s,isError:c,getOr:o(n),getOrThunk:o(n),getOrDie:o(n),or:function(t){return on(n)},orThunk:function(t){return on(n)},fold:function(t,e){return e(n)},map:function(t){return on(t(n))},mapError:function(t){return on(n)},each:function(t){t(n)},bind:function(t){return t(n)},exists:function(t){return t(n)},forall:function(t){return t(n)},toOptional:function(){return b.some(n)}}},rn=function(n){return{is:c,isValue:c,isError:s,getOr:r,getOrThunk:function(n){return n()},getOrDie:function(){return a(String(n))()},or:function(n){return n},orThunk:function(n){return n()},fold:function(t,e){return t(n)},map:function(t){return rn(n)},mapError:function(t){return rn(t(n))},each:t,bind:function(t){return rn(n)},exists:c,forall:s,toOptional:b.none}},un={value:on,error:rn,fromOption:function(n,t){return n.fold((function(){return rn(t)}),on)}};!function(n){n[n.Error=0]="Error",n[n.Value=1]="Value"}(g||(g={}));var an=function(n,t,e){return n.stype===g.Error?t(n.serror):e(n.svalue)},cn=function(n){return{stype:g.Value,svalue:n}},sn=function(n){return{stype:g.Error,serror:n}},fn=function(n){return n.fold(sn,cn)},ln=function(n){return an(n,un.error,un.value)},dn=cn,mn=function(n){var t=[],e=[];return z(n,(function(n){an(n,(function(n){return e.push(n)}),(function(n){return t.push(n)}))})),{values:t,errors:e}},gn=sn,pn=function(n,t){return n.stype===g.Value?t(n.svalue):n},hn=function(n,t){return n.stype===g.Error?t(n.serror):n},vn=function(n,t){return n.stype===g.Value?{stype:g.Value,svalue:t(n.svalue)}:n},bn=function(n,t){return n.stype===g.Error?{stype:g.Error,serror:t(n.serror)}:n},yn=Object.keys,xn=Object.hasOwnProperty,wn=function(n,t){for(var e=yn(n),o=0,r=e.length;o<r;o++){var i=e[o];t(n[i],i)}},Sn=function(n,t){return kn(n,(function(n,e){return{k:e,v:t(n,e)}}))},kn=function(n,t){var e={};return wn(n,(function(n,o){var r=t(n,o);e[r.k]=r.v})),e},Cn=function(n,e){var o={};return function(n,t,e,o){wn(n,(function(n,r){(t(n,r)?e:o)(n,r)}))}(n,e,function(n){return function(t,e){n[e]=t}}(o),t),o},On=function(n,t){var e=[];return wn(n,(function(n,o){e.push(t(n,o))})),e},_n=function(n,t){for(var e=yn(n),o=0,r=e.length;o<r;o++){var i=e[o],u=n[i];if(t(u,i,n))return b.some(u)}return b.none()},Tn=function(n){return On(n,(function(n){return n}))},En=function(n,t){return Dn(n,t)?b.from(n[t]):b.none()},Dn=function(n,t){return xn.call(n,t)},Bn=function(n,t){return Dn(n,t)&&void 0!==n[t]&&null!==n[t]},An=function(n){if(!k(n))throw new Error("cases must be an array");if(0===n.length)throw new Error("there must be at least one case");var t=[],e={};return z(n,(function(o,r){var i=yn(o);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=o[u];if(void 0!==e[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!k(a))throw new Error("case arguments must be an array");t.push(u),e[u]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+i);var c=function(n){var o=yn(n);if(t.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+"\nActual: "+o.join(","));if(!q(t,(function(n){return I(o,n)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+t.join(", "));return n[u].apply(null,e)};return{fold:function(){for(var t=[],o=0;o<arguments.length;o++)t[o]=arguments[o];if(t.length!==n.length)throw new Error("Wrong number of arguments to fold. Expected "+n.length+", got "+t.length);var i=t[r];return i.apply(null,e)},match:c,log:function(n){console.log(n,{constructors:t,constructor:u,params:e})}}}})),e},Mn=Object.prototype.hasOwnProperty,Fn=function(n){return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(0===t.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<t.length;r++){var i=t[r];for(var u in i)Mn.call(i,u)&&(o[u]=n(o[u],i[u]))}return o}},In=Fn((function(n,t){return S(n)&&S(t)?In(n,t):t})),Rn=Fn((function(n,t){return t})),Vn=function(n){var t,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,t=n.apply(null,o)),t}},Pn=An([{strict:[]},{defaultedThunk:["fallbackThunk"]},{asOption:[]},{asDefaultedOptionThunk:["fallbackThunk"]},{mergeWithThunk:["baseThunk"]}]),Hn=function(n){return Pn.defaultedThunk(o(n))},zn=function(n){return Pn.mergeWithThunk(o(n))},Nn=Pn.strict,Ln=Pn.asOption,jn=Pn.defaultedThunk,Un=(Pn.asDefaultedOptionThunk,Pn.mergeWithThunk),Wn=(An([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]),function(n,t){var e;return(e={})[n]=t,e}),Gn=function(n,t){return function(n,t){var e={};return wn(n,(function(n,o){I(t,o)||(e[o]=n)})),e}(n,t)},Xn=function(n,t){return Wn(n,t)},Yn=function(n){return function(n){var t={};return z(n,(function(n){t[n.key]=n.value})),t}(n)},qn=function(n,t){var e,o=function(n){var t=[],e=[];return z(n,(function(n){n.fold((function(n){t.push(n)}),(function(n){e.push(n)}))})),{errors:t,values:e}}(n);return o.errors.length>0?(e=o.errors,un.error(X(e))):function(n,t){return 0===n.length?un.value(t):un.value(In(t,Rn.apply(void 0,n)))}(o.values,t)},Jn=function(n){return e(gn,X)(n)},Kn=function(n,t){var e=mn(n);return e.errors.length>0?Jn(e.errors):function(n,t){return n.length>0?dn(In(t,Rn.apply(void 0,n))):dn(t)}(e.values,t)},$n=function(n){var t=mn(n);return t.errors.length>0?Jn(t.errors):dn(t.values)},Qn=function(n){return S(n)&&yn(n).length>100?" removed due to size":JSON.stringify(n,null,2)},Zn=function(n,t){return gn([{path:n,getErrorInfo:t}])},nt=An([{field:["key","okey","presence","prop"]},{state:["okey","instantiator"]}]),tt=function(n,t,e){return En(t,e).fold((function(){return function(n,t,e){return Zn(n,(function(){return'Could not find valid *strict* value for "'+t+'" in '+Qn(e)}))}(n,e,t)}),dn)},et=function(n,t,e){var o=En(n,t).fold((function(){return e(n)}),r);return dn(o)},ot=function(n,t,e,r){return e.fold((function(e,i,u,a){var c=function(t){var o=a.extract(n.concat([e]),r,t);return vn(o,(function(n){return Wn(i,r(n))}))},s=function(t){return t.fold((function(){var n=Wn(i,r(b.none()));return dn(n)}),(function(t){var o=a.extract(n.concat([e]),r,t);return vn(o,(function(n){return Wn(i,r(b.some(n)))}))}))};return u.fold((function(){return pn(tt(n,t,e),c)}),(function(n){return pn(et(t,e,n),c)}),(function(){return pn(function(n,t){return dn(En(n,t))}(t,e),s)}),(function(n){return pn(function(n,t,e){var o=En(n,t).map((function(t){return!0===t?e(n):t}));return dn(o)}(t,e,n),s)}),(function(n){var r=n(t),i=vn(et(t,e,o({})),(function(n){return In(r,n)}));return pn(i,c)}))}),(function(n,e){var o=e(t);return dn(Wn(n,r(o)))}))},rt=function(n){return{extract:function(t,e,o){return hn(n(o,e),(function(n){return function(n,t){return Zn(n,(function(){return t}))}(t,n)}))},toString:function(){return"val"}}},it=function(n){return yn(Cn(n,(function(n){return null!=n})))},ut=function(n){var t=at(n),e=j(n,(function(n,t){return t.fold((function(t){return In(n,Xn(t,!0))}),o(n))}),{});return{extract:function(n,o,r){var i=C(r)?[]:it(r),u=L(i,(function(n){return!Bn(e,n)}));return 0===u.length?t.extract(n,o,r):function(n,t){return Zn(n,(function(){return"There are unsupported fields: ["+t.join(", ")+"] specified"}))}(n,u)},toString:t.toString}},at=function(n){return{extract:function(t,e,o){return function(n,t,e,o){var r=H(e,(function(e){return ot(n,t,e,o)}));return Kn(r,{})}(t,o,n,e)},toString:function(){return"obj{\n"+H(n,(function(n){return n.fold((function(n,t,e,o){return n+" -> "+o.toString()}),(function(n,t){return"state("+n+")"}))})).join("\n")+"}"}}},ct=function(n){return{extract:function(t,e,o){var r=H(o,(function(o,r){return n.extract(t.concat(["["+r+"]"]),e,o)}));return $n(r)},toString:function(){return"array("+n.toString()+")"}}},st=function(n){return{extract:function(t,e,o){for(var r=[],i=0,u=n;i<u.length;i++){var a=u[i].extract(t,e,o);if(a.stype===g.Value)return a;r.push(a)}return $n(r)},toString:function(){return"oneOf("+H(n,(function(n){return n.toString()})).join(", ")+")"}}},ft=function(n,t){return{extract:function(e,o,i){var u=yn(i),a=function(t,e){return ct(rt(n)).extract(t,r,e)}(e,u);return pn(a,(function(n){var r=H(n,(function(n){return nt.field(n,n,Nn(),t)}));return at(r).extract(e,o,i)}))},toString:function(){return"setOf("+t.toString()+")"}}},lt=o(rt(dn)),dt=e(ct,at),mt=nt.state,gt=nt.field,pt=function(n,t,e,o,r){return En(o,r).fold((function(){return function(n,t,e){return Zn(n,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+Qn(t)}))}(n,o,r)}),(function(o){return o.extract(n.concat(["branch: "+r]),t,e)}))},ht=function(n,t){return{extract:function(e,o,r){return En(r,n).fold((function(){return function(n,t){return Zn(n,(function(){return'Choice schema did not contain choice key: "'+t+'"'}))}(e,n)}),(function(n){return pt(e,o,r,t,n)}))},toString:function(){return"chooseOn("+n+"). Possible values: "+yn(t)}}},vt=rt(dn),bt=function(n){return dt(n)},yt=function(n){return{extract:function(t,e,o){return n().extract(t,e,o)},toString:function(){return n().toString()}}},xt=function(n){return rt((function(t){return n(t).fold(gn,dn)}))},wt=function(n,t){return ft((function(t){return fn(n(t))}),t)},St=function(n,t,e){return ln(function(n,t,e,o){var r=t.extract([n],e,o);return bn(r,(function(n){return{input:o,errors:n}}))}(n,t,r,e))},kt=function(n){return n.fold((function(n){throw new Error(Ot(n))}),r)},Ct=function(n,t,e){return kt(St(n,t,e))},Ot=function(n){return"Errors: \n"+(t=n.errors,e=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:function(){return"... (only showing first ten failures)"}}]):t,H(e,(function(n){return"Failed path: ("+n.path.join(" > ")+")\n"+n.getErrorInfo()}))).join("\n")+"\n\nInput object: "+Qn(n.input);var t,e},_t=function(n,t){return ht(n,t)},Tt=function(n,t){return ht(n,Sn(t,at))},Et=o(vt),Dt=function(n,t){return rt((function(e){var o=typeof e;return n(e)?dn(e):gn("Expected type: "+t+" but got: "+o)}))},Bt=Dt(E,"number"),At=Dt(w,"string"),Mt=Dt(C,"boolean"),Ft=Dt(T,"function"),It=function(n){var t=function(n,t){for(var e=n.next();!e.done;){if(!t(e.value))return!1;e=n.next()}return!0};if(Object(n)!==n)return!0;switch({}.toString.call(n).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(n).every((function(t){return It(n[t])}));case"Map":return t(n.keys(),It)&&t(n.values(),It);case"Set":return t(n.keys(),It);default:return!1}},Rt=rt((function(n){return It(n)?dn(n):gn("Expected value to be acceptable for sending via postMessage")})),Vt=function(n){return xt((function(t){return I(n,t)?un.value(t):un.error('Unsupported value: "'+t+'", choose one of "'+n.join(", ")+'".')}))},Pt=function(n){return gt(n,n,Nn(),lt())},Ht=function(n,t){return gt(n,n,Nn(),t)},zt=function(n){return Ht(n,Bt)},Nt=function(n){return Ht(n,At)},Lt=function(n,t){return gt(n,n,Nn(),Vt(t))},jt=function(n){return Ht(n,Ft)},Ut=function(n,t){return gt(n,n,Nn(),at(t))},Wt=function(n,t){return gt(n,n,Nn(),dt(t))},Gt=function(n,t){return gt(n,n,Nn(),ct(t))},Xt=function(n){return gt(n,n,Ln(),lt())},Yt=function(n,t){return gt(n,n,Ln(),t)},qt=function(n){return Yt(n,Bt)},Jt=function(n){return Yt(n,At)},Kt=function(n){return Yt(n,Ft)},$t=function(n,t){return Yt(n,at(t))},Qt=function(n,t){return gt(n,n,Hn(t),lt())},Zt=function(n,t,e){return gt(n,n,Hn(t),e)},ne=function(n,t){return Zt(n,t,Bt)},te=function(n,t){return Zt(n,t,At)},ee=function(n,t,e){return Zt(n,t,Vt(e))},oe=function(n,t){return Zt(n,t,Mt)},re=function(n,t){return Zt(n,t,Ft)},ie=function(n,t,e){return Zt(n,t,ct(e))},ue=function(n,t,e){return Zt(n,t,at(e))},ae=function(n,t){return mt(n,t)},ce=function(n){var t=n;return{get:function(){return t},set:function(n){t=n}}},se=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:n}},fe={fromHtml:function(n,t){var e=(t||document).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return se(e.childNodes[0])},fromTag:function(n,t){var e=(t||document).createElement(n);return se(e)},fromText:function(n,t){var e=(t||document).createTextNode(n);return se(e)},fromDom:se,fromPoint:function(n,t,e){return b.from(n.dom.elementFromPoint(t,e)).map(se)}},le=function(){return de(0,0)},de=function(n,t){return{major:n,minor:t}},me={nu:de,detect:function(n,t){var e=String(t).toLowerCase();return 0===n.length?le():function(n,t){var e=function(n,t){for(var e=0;e<n.length;e++){var o=n[e];if(o.test(t))return o}}(n,t);if(!e)return{major:0,minor:0};var o=function(n){return Number(t.replace(e,"$"+n))};return de(o(1),o(2))}(n,e)},unknown:le},ge=function(n,t){var e=String(t).toLowerCase();return W(n,(function(n){return n.search(e)}))},pe=function(n,t){return ge(n,t).map((function(n){var e=me.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},he=function(n,t){return ge(n,t).map((function(n){var e=me.detect(n.versionRegexes,t);return{current:n.name,version:e}}))},ve=function(n,t){return-1!==n.indexOf(t)},be=function(n,t){return function(n,t,e){return""===t||n.length>=t.length&&n.substr(e,e+t.length)===t}(n,t,n.length-t.length)},ye=function(n){return function(t){return t.replace(n,"")}}(/^\s+|\s+$/g),xe=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,we=function(n){return function(t){return ve(t,n)}},Se=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return ve(n,"edge/")&&ve(n,"chrome")&&ve(n,"safari")&&ve(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xe],search:function(n){return ve(n,"chrome")&&!ve(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return ve(n,"msie")||ve(n,"trident")}},{name:"Opera",versionRegexes:[xe,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:we("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:we("firefox")},{name:"Safari",versionRegexes:[xe,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(ve(n,"safari")||ve(n,"mobile/"))&&ve(n,"applewebkit")}}],ke=[{name:"Windows",search:we("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return ve(n,"iphone")||ve(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:we("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:we("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:we("linux"),versionRegexes:[]},{name:"Solaris",search:we("sunos"),versionRegexes:[]},{name:"FreeBSD",search:we("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:we("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Ce={browsers:o(Se),oses:o(ke)},Oe=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o("Firefox"),isSafari:o("Safari")}},_e={unknown:function(){return Oe({current:void 0,version:me.unknown()})},nu:Oe,edge:o("Edge"),chrome:o("Chrome"),ie:o("IE"),opera:o("Opera"),firefox:o("Firefox"),safari:o("Safari")},Te=function(n){var t=n.current,e=n.version,o=function(n){return function(){return t===n}};return{current:t,version:e,isWindows:o("Windows"),isiOS:o("iOS"),isAndroid:o("Android"),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o("Solaris"),isFreeBSD:o("FreeBSD"),isChromeOS:o("ChromeOS")}},Ee={unknown:function(){return Te({current:void 0,version:me.unknown()})},nu:Te,windows:o("Windows"),ios:o("iOS"),android:o("Android"),linux:o("Linux"),osx:o("OSX"),solaris:o("Solaris"),freebsd:o("FreeBSD"),chromeos:o("ChromeOS")},De=function(n,t){var e=Ce.browsers(),r=Ce.oses(),i=pe(e,n).fold(_e.unknown,_e.nu),u=he(r,n).fold(Ee.unknown,Ee.nu),a=function(n,t,e,r){var i=n.isiOS()&&!0===/ipad/i.test(e),u=n.isiOS()&&!i,a=n.isiOS()||n.isAndroid(),c=a||r("(pointer:coarse)"),s=i||!u&&a&&r("(min-device-width:768px)"),f=u||a&&!s,l=t.isSafari()&&n.isiOS()&&!1===/safari/i.test(e),d=!f&&!s&&!l;return{isiPad:o(i),isiPhone:o(u),isTablet:o(s),isPhone:o(f),isTouch:o(c),isAndroid:n.isAndroid,isiOS:n.isiOS,isWebView:o(l),isDesktop:o(d)}}(u,i,n,t);return{browser:i,os:u,deviceType:a}},Be=function(n){return window.matchMedia(n).matches},Ae=Vn((function(){return De(navigator.userAgent,Be)})),Me=function(){return Ae()},Fe=function(n,t){var e=n.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(t);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(t);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(t);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")},Ie=function(n){return 1!==n.nodeType&&9!==n.nodeType&&11!==n.nodeType||0===n.childElementCount},Re=function(n,t){return n.dom===t.dom},Ve=function(n,t){return function(n,t){return function(n,t,e){return 0!=(n.compareDocumentPosition(t)&e)}(n,t,Node.DOCUMENT_POSITION_CONTAINED_BY)}(n.dom,t.dom)},Pe=function(n,t){return Me().browser.isIE()?Ve(n,t):function(n,t){var e=n.dom,o=t.dom;return e!==o&&e.contains(o)}(n,t)},He=function(n){return T(n)?n:c},ze=function(n,t,e){for(var o=n.dom,r=He(e);o.parentNode;){o=o.parentNode;var i=fe.fromDom(o),u=t(i);if(u.isSome())return u;if(r(i))break}return b.none()},Ne=function(n,t,e){var o=t(n),r=He(e);return o.orThunk((function(){return r(n)?b.none():ze(n,t,r)}))},Le=function(n,t){return Re(n.element,t.event.target)},je=function(n){if(!Bn(n,"can")&&!Bn(n,"abort")&&!Bn(n,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(n,null,2)+" does not have can, abort, or run!");return Ct("Extracting event.handler",ut([Qt("can",s),Qt("abort",c),Qt("run",t)]),n)},Ue=function(n){var t=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return U(n,(function(n,o){return n&&t(o).apply(void 0,e)}),!0)}}(n,(function(n){return n.can})),e=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return U(n,(function(n,o){return n||t(o).apply(void 0,e)}),!1)}}(n,(function(n){return n.abort}));return je({can:t,abort:e,run:function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];z(n,(function(n){n.run.apply(void 0,t)}))}})},We=o,Ge=We("touchstart"),Xe=We("touchmove"),Ye=We("touchend"),qe=We("touchcancel"),Je=We("mousedown"),Ke=We("mousemove"),$e=We("mouseout"),Qe=We("mouseup"),Ze=We("mouseover"),no=We("focusin"),to=We("focusout"),eo=We("keydown"),oo=We("keyup"),ro=We("input"),io=We("change"),uo=We("click"),ao=We("transitionend"),co=We("selectstart"),so=function(n){return o("alloy."+n)},fo={tap:so("tap")},lo=so("focus"),mo=so("blur.post"),go=so("paste.post"),po=so("receive"),ho=so("execute"),vo=so("focus.item"),bo=fo.tap,yo=so("longpress"),xo=so("sandbox.close"),wo=so("typeahead.cancel"),So=so("system.init"),ko=so("system.touchmove"),Co=so("system.touchend"),Oo=so("system.scroll"),_o=so("system.resize"),To=so("system.attached"),Eo=so("system.detached"),Do=so("system.dismissRequested"),Bo=so("system.repositionRequested"),Ao=so("focusmanager.shifted"),Mo=so("slotcontainer.visibility"),Fo=so("change.tab"),Io=so("dismiss.tab"),Ro=so("highlight"),Vo=so("dehighlight"),Po=function(n,t){Lo(n,n.element,t,{})},Ho=function(n,t,e){Lo(n,n.element,t,e)},zo=function(n){Po(n,ho())},No=function(n,t,e){Lo(n,t,e,{})},Lo=function(n,t,e,o){var r=l({target:t},o);n.getSystem().triggerEvent(e,t,r)},jo=function(n,t,e,o){n.getSystem().triggerEvent(e,t,o.event)},Uo=function(n){return Yn(n)},Wo=function(n,t){return{key:n,value:je({abort:t})}},Go=function(n){return{key:n,value:je({run:function(n,t){t.event.prevent()}})}},Xo=function(n,t){return{key:n,value:je({run:t})}},Yo=function(n,t,e){return{key:n,value:je({run:function(n,o){t.apply(void 0,[n,o].concat(e))}})}},qo=function(n){return function(t){return{key:n,value:je({run:function(n,e){Le(n,e)&&t(n,e)}})}}},Jo=function(n,t,e){return function(n,t){return Xo(n,(function(e,o){e.getSystem().getByUid(t).each((function(t){jo(t,t.element,n,o)}))}))}(n,t.partUids[e])},Ko=function(n,t){return Xo(n,(function(n,e){var o=e.event,r=n.getSystem().getByDom(o.target).fold((function(){return Ne(o.target,(function(t){return n.getSystem().getByDom(t).toOptional()}),c).getOr(n)}),(function(n){return n}));t(n,r,e)}))},$o=function(n){return Xo(n,(function(n,t){t.cut()}))},Qo=function(n){return Xo(n,(function(n,t){t.stop()}))},Zo=function(n,t){return qo(n)(t)},nr=qo(To()),tr=qo(Eo()),er=qo(So()),or=function(n){return function(t){return Xo(n,t)}}(ho()),rr=("undefined"!=typeof window?window:Function("return this;")(),function(n){return n.dom.nodeName.toLowerCase()}),ir=function(n){return function(t){return function(n){return n.dom.nodeType}(t)===n}},ur=ir(1),ar=ir(3),cr=ir(9),sr=ir(11),fr=function(n){return fe.fromDom(n.dom.ownerDocument)},lr=function(n){return cr(n)?n:fr(n)},dr=function(n){return fe.fromDom(lr(n).dom.documentElement)},mr=function(n){return fe.fromDom(lr(n).dom.defaultView)},gr=function(n){return b.from(n.dom.parentNode).map(fe.fromDom)},pr=function(n){return b.from(n.dom.offsetParent).map(fe.fromDom)},hr=function(n){return H(n.dom.childNodes,fe.fromDom)},vr=function(n,t){var e=n.dom.childNodes;return b.from(e[t]).map(fe.fromDom)},br=function(n){return sr(n)&&_(n.dom.host)},yr=T(Element.prototype.attachShadow)&&T(Node.prototype.getRootNode),xr=o(yr),wr=yr?function(n){return fe.fromDom(n.dom.getRootNode())}:lr,Sr=function(n){return br(n)?n:fe.fromDom(lr(n).dom.body)},kr=function(n){var t=wr(n);return br(t)?b.some(t):b.none()},Cr=function(n){return fe.fromDom(n.dom.host)},Or=function(n){return _(n.dom.shadowRoot)},_r=function(n,t){gr(n).each((function(e){e.dom.insertBefore(t.dom,n.dom)}))},Tr=function(n,t){(function(n){return b.from(n.dom.nextSibling).map(fe.fromDom)})(n).fold((function(){gr(n).each((function(n){Dr(n,t)}))}),(function(n){_r(n,t)}))},Er=function(n,t){(function(n){return vr(n,0)})(n).fold((function(){Dr(n,t)}),(function(e){n.dom.insertBefore(t.dom,e.dom)}))},Dr=function(n,t){n.dom.appendChild(t.dom)},Br=function(n,t){z(t,(function(t){Dr(n,t)}))},Ar=function(n){n.dom.textContent="",z(hr(n),(function(n){Mr(n)}))},Mr=function(n){var t=n.dom;null!==t.parentNode&&t.parentNode.removeChild(t)},Fr=function(n){var t,e=hr(n);e.length>0&&(t=n,z(e,(function(n){_r(t,n)}))),Mr(n)},Ir=function(n){return n.dom.innerHTML},Rr=function(n,t){var e,o,r=fr(n).dom,i=fe.fromDom(r.createDocumentFragment()),u=(e=t,(o=(r||document).createElement("div")).innerHTML=e,hr(fe.fromDom(o)));Br(i,u),Ar(n),Dr(n,i)},Vr=function(n,t,e){if(!(w(e)||C(e)||E(e)))throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",e,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(t,e+"")},Pr=function(n,t,e){Vr(n.dom,t,e)},Hr=function(n,t){var e=n.dom.getAttribute(t);return null===e?void 0:e},zr=function(n,t){return b.from(Hr(n,t))},Nr=function(n,t){var e=n.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(t)},Lr=function(n,t){n.dom.removeAttribute(t)},jr=function(n){return function(n,t){return fe.fromDom(n.dom.cloneNode(t))}(n,!1)},Ur=function(n){return br(n)?"#shadow-root":function(n){var t=fe.fromTag("div"),e=fe.fromDom(n.dom.cloneNode(!0));return Dr(t,e),Ir(t)}(jr(n))},Wr=function(n){return Ur(n)},Gr=Uo([function(n,t){return{key:n,value:je({can:t})}}(lo(),(function(n,t){var e=t.event,o=e.originator,r=e.target;return!function(n,t,e){return Re(t,n.element)&&!Re(t,e)}(n,o,r)||(console.warn(lo()+" did not get interpreted by the desired target. \nOriginator: "+Wr(o)+"\nTarget: "+Wr(r)+"\nCheck the "+lo()+" event handlers"),!1)}))]),Xr=Object.freeze({__proto__:null,events:Gr}),Yr=0,qr=function(n){var t=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++Yr+String(t)},Jr=o("alloy-id-"),Kr=o("data-alloy-id"),$r=Jr(),Qr=Kr(),Zr=function(n,t){Object.defineProperty(n.dom,Qr,{value:t,writable:!0})},ni=function(n){var t=ur(n)?n.dom[Qr]:null;return b.from(t)},ti=function(n){return qr(n)},ei=r,oi=function(n){var t=function(t){return function(){throw new Error("The component must be in a context to send: "+t+(n?"\n"+Wr(n().element)+" is not in context.":""))}};return{debugInfo:o("fake"),triggerEvent:t("triggerEvent"),triggerFocus:t("triggerFocus"),triggerEscape:t("triggerEscape"),build:t("build"),addToWorld:t("addToWorld"),removeFromWorld:t("removeFromWorld"),addToGui:t("addToGui"),removeFromGui:t("removeFromGui"),getByUid:t("getByUid"),getByDom:t("getByDom"),broadcast:t("broadcast"),broadcastOn:t("broadcastOn"),broadcastEvent:t("broadcastEvent"),isConnected:c}},ri=oi(),ii=function(n){return H(n,(function(n){return be(n,"/*")?n.substring(0,n.length-"/*".length):n}))},ui=function(n,t){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:ii(i)}},n},ai=qr("alloy-premade"),ci=function(n){return Xn(ai,n)},si=function(n){return function(n,t){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:ii(i.slice(1))}},n}((function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return n.apply(void 0,m([t.getApis(),t],e))}),n)},fi={init:function(){return li({readState:function(){return"No State required"}})}},li=function(n){return n},di=function(n,t){var e={};return wn(n,(function(n,o){wn(n,(function(n,r){var i=En(e,r).getOr([]);e[r]=i.concat([t(o,n)])}))})),e},mi=function(n){return{classes:void 0!==n.classes?n.classes:[],attributes:void 0!==n.attributes?n.attributes:{},styles:void 0!==n.styles?n.styles:{}}},gi=function(n){return n.cHandler},pi=function(n,t){return{name:n,handler:t}},hi=function(n,t,e){var o=l(l({},e),function(n,t){var e={};return z(n,(function(n){e[n.name()]=n.handlers(t)})),e}(t,n));return di(o,pi)},vi=function(n){var t=function(n){return T(n)?{can:s,abort:c,run:n}:n}(n);return function(n,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[n,e].concat(o);t.abort.apply(void 0,i)?e.stop():t.can.apply(void 0,i)&&t.run.apply(void 0,i)}},bi=function(n,t,e){var o=t[e];return o?function(n,t,e,o){try{var r=$(e,(function(e,r){var i=e[t],u=r[t],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+n+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+n+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return un.value(r)}catch(n){return un.error([n])}}("Event: "+e,"name",n,o).map((function(n){var t=H(n,(function(n){return n.handler}));return Ue(t)})):function(n,t){return un.error(["The event ("+n+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(H(t,(function(n){return n.name})),null,2)])}(e,n)},yi=function(n,t){var e=On(n,(function(n,e){return(1===n.length?un.value(n[0].handler):bi(n,t,e)).map((function(o){var r=vi(o),i=n.length>1?L(t[e],(function(t){return R(n,(function(n){return n.name===t}))})).join(" > "):n[0].name;return Xn(e,function(n,t){return{handler:n,purpose:t}}(r,i))}))}));return qn(e,{})},xi="alloy.base.behaviour",wi=function(n){return n.events},Si=function(n,t){var e=Hr(n,t);return void 0===e||""===e?[]:e.split(" ")},ki=function(n){return void 0!==n.dom.classList},Ci=function(n,t){return function(n,t,e){var o=Si(n,t).concat([e]);return Pr(n,t,o.join(" ")),!0}(n,"class",t)},Oi=function(n,t){return function(n,t,e){var o=L(Si(n,t),(function(n){return n!==e}));return o.length>0?Pr(n,t,o.join(" ")):Lr(n,t),!1}(n,"class",t)},_i=function(n,t){ki(n)?n.dom.classList.add(t):Ci(n,t)},Ti=function(n){0===(ki(n)?n.dom.classList:function(n){return Si(n,"class")}(n)).length&&Lr(n,"class")},Ei=function(n,t){ki(n)?n.dom.classList.remove(t):Oi(n,t);Ti(n)},Di=function(n,t){return ki(n)&&n.dom.classList.contains(t)},Bi=function(n,t){z(t,(function(t){_i(n,t)}))},Ai=function(n,t){z(t,(function(t){Ei(n,t)}))},Mi=function(n){return void 0!==n.style&&T(n.style.getPropertyValue)},Fi=function(n){var t=ar(n)?n.dom.parentNode:n.dom;if(null==t||null===t.ownerDocument)return!1;var e,o,r=t.ownerDocument;return kr(fe.fromDom(t)).fold((function(){return r.body.contains(t)}),(e=Fi,o=Cr,function(n){return e(o(n))}))},Ii=function(){return Ri(fe.fromDom(document))},Ri=function(n){var t=n.dom.body;if(null==t)throw new Error("Body is not available yet");return fe.fromDom(t)},Vi=function(n,t,e){if(!w(e))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",e,":: Element ",n),new Error("CSS value must be a string: "+e);Mi(n)&&n.style.setProperty(t,e)},Pi=function(n,t){Mi(n)&&n.style.removeProperty(t)},Hi=function(n,t,e){var o=n.dom;Vi(o,t,e)},zi=function(n,t){var e=n.dom;wn(t,(function(n,t){Vi(e,t,n)}))},Ni=function(n,t){var e=n.dom;wn(t,(function(n,t){n.fold((function(){Pi(e,t)}),(function(n){Vi(e,t,n)}))}))},Li=function(n,t){var e=n.dom,o=window.getComputedStyle(e).getPropertyValue(t);return""!==o||Fi(n)?o:ji(e,t)},ji=function(n,t){return Mi(n)?n.style.getPropertyValue(t):""},Ui=function(n,t){var e=n.dom,o=ji(e,t);return b.from(o).filter((function(n){return n.length>0}))},Wi=function(n){var t={},e=n.dom;if(Mi(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);t[r]=e.style[r]}return t},Gi=function(n,t,e){var o=fe.fromTag(n);return Hi(o,t,e),Ui(o,t).isSome()},Xi=function(n,t){var e=n.dom;Pi(e,t),zr(n,"style").map(ye).is("")&&Lr(n,"style")},Yi=function(n){return n.dom.offsetWidth},qi=function(n){return n.dom.value},Ji=function(n,t){if(void 0===t)throw new Error("Value.set was undefined");n.dom.value=t},Ki=function(n){var t=fe.fromTag(n.tag);!function(n,t){var e=n.dom;wn(t,(function(n,t){Vr(e,t,n)}))}(t,n.attributes),Bi(t,n.classes),zi(t,n.styles),n.innerHtml.each((function(n){return Rr(t,n)}));var e=n.domChildren;return Br(t,e),n.value.each((function(n){Ji(t,n)})),n.uid,Zr(t,n.uid),t},$i=function(n,t){return function(n,t){var e=H(t,(function(n){return $t(n.name(),[Pt("config"),Qt("state",fi)])})),o=St("component.behaviours",at(e),n.behaviours).fold((function(t){throw new Error(Ot(t)+"\nComplete spec:\n"+JSON.stringify(n,null,2))}),(function(n){return n}));return{list:t,data:Sn(o,(function(n){var t=n.map((function(n){return{config:n.config,state:n.state.init(n.config)}}));return function(){return t}}))}}(n,t)},Qi=function(n){var t=function(n){var t=En(n,"behaviours").getOr({}),e=L(yn(t),(function(n){return void 0!==t[n]}));return H(e,(function(n){return t[n].me}))}(n);return $i(n,t)},Zi=function(n,t,e){var o,r,i,u=l(l({},(o=n).dom),{uid:o.uid,domChildren:H(o.components,(function(n){return n.element}))}),a=function(n){return n.domModification.fold((function(){return mi({})}),mi)}(n),c={"alloy.base.modification":a},s=t.length>0?function(n,t,e,o){var r=l({},t);z(e,(function(t){r[t.name()]=t.exhibit(n,o)}));var i=di(r,(function(n,t){return{name:n,modification:t}})),u=function(n){return j(n,(function(n,t){return l(l({},t.modification),n)}),{})},a=j(i.classes,(function(n,t){return t.modification.concat(n)}),[]),c=u(i.attributes),s=u(i.styles);return mi({classes:a,attributes:c,styles:s})}(e,c,t,u):a;return i=s,l(l({},r=u),{attributes:l(l({},r.attributes),i.attributes),styles:l(l({},r.styles),i.styles),classes:r.classes.concat(i.classes)})},nu=function(n,t,e){var o={"alloy.base.behaviour":wi(n)};return function(n,t,e,o){var r=hi(n,e,o);return yi(r,t)}(e,n.eventOrder,t,o).getOrDie()},tu=function(n){var t=function(){return l},e=ce(ri),o=kt(function(n){var t;return St("custom.definition",at([gt("dom","dom",Nn(),at([Pt("tag"),Qt("styles",{}),Qt("classes",[]),Qt("attributes",{}),Xt("value"),Xt("innerHtml")])),Pt("components"),Pt("uid"),Qt("events",{}),Qt("apis",{}),gt("eventOrder","eventOrder",zn((t={},t[ho()]=["disabling",xi,"toggling","typeaheadevents"],t[lo()]=[xi,"focusing","keying"],t[So()]=[xi,"disabling","toggling","representing"],t[ro()]=[xi,"representing","streaming","invalidating"],t[Eo()]=[xi,"representing","item-events","tooltipping"],t[Je()]=["focusing",xi,"item-type-events"],t[Ge()]=["focusing",xi,"item-type-events"],t[Ze()]=["item-type-events","tooltipping"],t[po()]=["receiving","reflecting","tooltipping"],t)),Et()),Xt("domModification")]),n)}(n)),r=Qi(n),i=function(n){return n.list}(r),u=function(n){return n.data}(r),a=Zi(o,i,u),c=Ki(a),s=nu(o,i,u),f=ce(o.components),l={getSystem:e.get,config:function(t){var e=u;return(T(e[t.name()])?e[t.name()]:function(){throw new Error("Could not find "+t.name()+" in "+JSON.stringify(n,null,2))})()},hasConfigured:function(n){return T(u[n.name()])},spec:n,readState:function(n){return u[n]().map((function(n){return n.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(n){e.set(n)},disconnect:function(){e.set(oi(t))},element:c,syncComponents:function(){var n=hr(c),t=Y(n,(function(n){return e.get().getByDom(n).fold((function(){return[]}),(function(n){return[n]}))}));f.set(t)},components:f.get,events:s};return l},eu=function(n){var t=ei(n),e=t.events,o=d(t,["events"]),r=function(n){var t=En(n,"components").getOr([]);return H(t,uu)}(o),i=l(l({},o),{events:l(l({},Xr),e),components:r});return un.value(tu(i))},ou=function(n){var t=fe.fromText(n);return ru({element:t})},ru=function(n){var e=Ct("external.component",ut([Pt("element"),Xt("uid")]),n),r=ce(oi());e.uid.each((function(n){Zr(e.element,n)}));var i={getSystem:r.get,config:b.none,hasConfigured:c,connect:function(n){r.set(n)},disconnect:function(){r.set(oi((function(){return i})))},getApis:function(){return{}},element:e.element,spec:n,readState:o("No state"),syncComponents:t,components:o([]),events:{}};return ci(i)},iu=ti,uu=function(n){return function(n){return En(n,ai)}(n).fold((function(){var t=n.hasOwnProperty("uid")?n:l({uid:iu("")},n);return eu(t).getOrDie()}),(function(n){return n}))},au=ci,cu=function(n,t){var e=function(e){var o=t(e);if(o<=0||null===o){var r=Li(e,n);return parseFloat(r)||0}return o},o=function(n,t){return U(t,(function(t,e){var o=Li(n,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?t:t+r}),0)};return{set:function(t,e){if(!E(e)&&!e.match(/^[0-9]+$/))throw new Error(n+".set accepts only positive integer values. Value was "+e);var o=t.dom;Mi(o)&&(o.style[n]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(n,t,e){var r=o(n,e);return t>r?t-r:0}}},su=cu("height",(function(n){var t=n.dom;return Fi(n)?t.getBoundingClientRect().height:t.offsetHeight})),fu=function(n){return su.get(n)},lu=function(n){return su.getOuter(n)},du=function(n,t){return{left:n,top:t,translate:function(e,o){return du(n+e,t+o)}}},mu=du,gu=function(n,t){return void 0!==n?n:void 0!==t?t:0},pu=function(n){var t=n.dom.ownerDocument,e=t.body,o=t.defaultView,r=t.documentElement;if(e===n.dom)return mu(e.offsetLeft,e.offsetTop);var i=gu(null==o?void 0:o.pageYOffset,r.scrollTop),u=gu(null==o?void 0:o.pageXOffset,r.scrollLeft),a=gu(r.clientTop,e.clientTop),c=gu(r.clientLeft,e.clientLeft);return hu(n).translate(u-c,i-a)},hu=function(n){var t=n.dom,e=t.ownerDocument.body;return e===t?mu(e.offsetLeft,e.offsetTop):Fi(n)?function(n){var t=n.getBoundingClientRect();return mu(t.left,t.top)}(t):mu(0,0)},vu=cu("width",(function(n){return n.dom.offsetWidth})),bu=function(n){return vu.get(n)},yu=function(n){return vu.getOuter(n)},xu=function(n){var t=fe.fromDom(function(n){if(xr()&&_(n.target)){var t=fe.fromDom(n.target);if(ur(t)&&Or(t)&&n.composed&&n.composedPath){var e=n.composedPath();if(e)return Z(e)}}return b.from(n.target)}(n).getOr(n.target)),o=function(){return n.stopPropagation()},r=function(){return n.preventDefault()},i=e(r,o);return function(n,t,e,o,r,i,u){return{target:n,x:t,y:e,stop:o,prevent:r,kill:i,raw:u}}(t,n.clientX,n.clientY,o,r,i,n)},wu=function(n,t,e,o,r){var u=function(n,t){return function(e){n(e)&&t(xu(e))}}(e,o);return n.dom.addEventListener(t,u,r),{unbind:i(Su,n,t,u,r)}},Su=function(n,t,e,o){n.dom.removeEventListener(t,e,o)},ku=function(n){var t=void 0!==n?n.dom:document,e=t.body.scrollLeft||t.documentElement.scrollLeft,o=t.body.scrollTop||t.documentElement.scrollTop;return mu(e,o)},Cu=function(n,t,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(n,t)},Ou=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},_u=function(n){var t=void 0===n?window:n,e=t.document,o=ku(fe.fromDom(e));return function(n){var t=void 0===n?window:n;return b.from(t.visualViewport)}(t).fold((function(){var n=t.document.documentElement,e=n.clientWidth,r=n.clientHeight;return Ou(o.left,o.top,e,r)}),(function(n){return Ou(Math.max(n.pageLeft,o.left),Math.max(n.pageTop,o.top),n.width,n.height)}))},Tu=function(n,t){return n.view(t).fold(o([]),(function(t){var e=n.owner(t),o=Tu(n,e);return[t].concat(o)}))},Eu=Object.freeze({__proto__:null,view:function(n){var t;return(n.dom===document?b.none():b.from(null===(t=n.dom.defaultView)||void 0===t?void 0:t.frameElement)).map(fe.fromDom)},owner:function(n){return fr(n)}}),Du=function(n){var t=fe.fromDom(document),e=ku(t);return function(n,t){var e=t.owner(n),o=Tu(t,e);return b.some(o)}(n,Eu).fold(i(pu,n),(function(t){var o=hu(n),r=j(t,(function(n,t){var e=hu(t);return{left:n.left+e.left,top:n.top+e.top}}),{left:0,top:0});return mu(r.left+o.left+e.left,r.top+o.top+e.top)}))},Bu=function(n,t,e,o){return{x:n,y:t,width:e,height:o,right:n+e,bottom:t+o}},Au=function(n){var t=pu(n),e=yu(n),o=lu(n);return Bu(t.left,t.top,e,o)},Mu=function(n){var t=Du(n),e=yu(n),o=lu(n);return Bu(t.left,t.top,e,o)},Fu=function(){return _u(window)};function Iu(n,t,e,o,r){return n(e,o)?b.some(e):T(r)&&r(e)?b.none():t(e,o,r)}var Ru,Vu=function(n,t,e){for(var o=n.dom,r=T(e)?e:c;o.parentNode;){o=o.parentNode;var i=fe.fromDom(o);if(t(i))return b.some(i);if(r(i))break}return b.none()},Pu=function(n,t,e){return Iu((function(n,t){return t(n)}),Vu,n,t,e)},Hu=function(n,t,e){return Pu(n,t,e).isSome()},zu=function(n,t,e){return Vu(n,(function(n){return Fe(n,t)}),e)},Nu=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return Ie(e)?b.none():b.from(e.querySelector(n)).map(fe.fromDom)}(t,n)},Lu=function(n,t,e){return Iu((function(n,t){return Fe(n,t)}),zu,n,t,e)},ju=function(){var n=qr("aria-owns");return{id:n,link:function(t){Pr(t,"aria-owns",n)},unlink:function(n){Lr(n,"aria-owns")}}},Uu=function(n,t){return function(n){return Pu(n,(function(n){if(!ur(n))return!1;var t=Hr(n,"id");return void 0!==t&&t.indexOf("aria-owns")>-1})).bind((function(n){var t=Hr(n,"id"),e=wr(n);return Nu(e,'[aria-owns="'+t+'"]')}))}(t).exists((function(t){return Wu(n,t)}))},Wu=function(n,t){return Hu(t,(function(t){return Re(t,n.element)}),c)||Uu(n,t)};!function(n){n[n.STOP=0]="STOP",n[n.NORMAL=1]="NORMAL",n[n.LOGGING=2]="LOGGING"}(Ru||(Ru={}));var Gu,Xu=ce({}),Yu=function(n,t,e){switch(En(Xu.get(),n).orThunk((function(){var t=yn(Xu.get());return en(t,(function(t){return n.indexOf(t)>-1?b.some(Xu.get()[t]):b.none()}))})).getOr(Ru.NORMAL)){case Ru.NORMAL:return e(Ku());case Ru.LOGGING:var o=function(n,t){var e=[],o=(new Date).getTime();return{logEventCut:function(n,t,o){e.push({outcome:"cut",target:t,purpose:o})},logEventStopped:function(n,t,o){e.push({outcome:"stopped",target:t,purpose:o})},logNoParent:function(n,t,o){e.push({outcome:"no-parent",target:t,purpose:o})},logEventNoHandlers:function(n,t){e.push({outcome:"no-handlers-left",target:t})},logEventResponse:function(n,t,o){e.push({outcome:"response",purpose:o,target:t})},write:function(){var r=(new Date).getTime();I(["mousemove","mouseover","mouseout",So()],n)||console.log(n,{event:n,time:r-o,target:t.dom,sequence:H(e,(function(n){return I(["cut","stopped","response"],n.outcome)?"{"+n.purpose+"} "+n.outcome+" at ("+Wr(n.target)+")":n.outcome}))})}}}(n,t),r=e(o);return o.write(),r;case Ru.STOP:return!0}},qu=["alloy/data/Fields","alloy/debugging/Debugging"],Ju=function(n,t,e){return Yu(n,t,e)},Ku=o({logEventCut:t,logEventStopped:t,logNoParent:t,logEventNoHandlers:t,logEventResponse:t,write:t}),$u=o([Pt("menu"),Pt("selectedMenu")]),Qu=o([Pt("item"),Pt("selectedItem")]),Zu=(o(at(Qu().concat($u()))),o(at(Qu()))),na=Ut("initSize",[Pt("numColumns"),Pt("numRows")]),ta=function(){return Ut("markers",[Pt("backgroundMenu")].concat($u()).concat(Qu()))},ea=function(n){return Ut("markers",H(n,Pt))},oa=function(n,t,e){!function(){var n=new Error;if(void 0!==n.stack){var t=n.stack.split("\n");return W(t,(function(n){return n.indexOf("alloy")>0&&!R(qu,(function(t){return n.indexOf(t)>-1}))})).getOr("unknown")}}();return gt(t,t,e,xt((function(n){return un.value((function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return n.apply(void 0,t)}))})))},ra=function(n){return oa(0,n,Hn(t))},ia=function(n){return oa(0,n,Hn(b.none))},ua=function(n){return oa(0,n,Nn())},aa=function(n){return oa(0,n,Nn())},ca=function(n,t){return ae(n,o(t))},sa=function(n){return ae(n,r)},fa=o(na),la=function(n,t,e,o,r,i){return{x:n,y:t,bubble:e,direction:o,boundsRestriction:r,label:i}},da=An([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),ma=da.southeast,ga=da.southwest,pa=da.northeast,ha=da.northwest,va=da.south,ba=da.north,ya=da.east,xa=da.west,wa=function(n,t){return function(n,t){for(var e={},o=0,r=n.length;o<r;o++){var i=n[o];e[String(i)]=t(i,o)}return e}(["left","right","top","bottom"],(function(e){return En(t,e).map((function(t){return function(n,t){switch(t){case 1:return n.x;case 0:return n.x+n.width;case 2:return n.y;case 3:return n.y+n.height}}(n,t)}))}))},Sa=function(n){return n.x},ka=function(n,t){return n.x+n.width/2-t.width/2},Ca=function(n,t){return n.x+n.width-t.width},Oa=function(n,t){return n.y-t.height},_a=function(n){return n.y+n.height},Ta=function(n,t){return n.y+n.height/2-t.height/2},Ea=function(n,t,e){return la(Sa(n),_a(n),e.southeast(),ma(),wa(n,{left:1,top:3}),"layout-se")},Da=function(n,t,e){return la(Ca(n,t),_a(n),e.southwest(),ga(),wa(n,{right:0,top:3}),"layout-sw")},Ba=function(n,t,e){return la(Sa(n),Oa(n,t),e.northeast(),pa(),wa(n,{left:1,bottom:2}),"layout-ne")},Aa=function(n,t,e){return la(Ca(n,t),Oa(n,t),e.northwest(),ha(),wa(n,{right:0,bottom:2}),"layout-nw")},Ma=function(n,t,e){return la(ka(n,t),Oa(n,t),e.north(),ba(),wa(n,{bottom:2}),"layout-n")},Fa=function(n,t,e){return la(ka(n,t),_a(n),e.south(),va(),wa(n,{top:3}),"layout-s")},Ia=function(n,t,e){return la(function(n){return n.x+n.width}(n),Ta(n,t),e.east(),ya(),wa(n,{left:0}),"layout-e")},Ra=function(n,t,e){return la(function(n,t){return n.x-t.width}(n,t),Ta(n,t),e.west(),xa(),wa(n,{right:1}),"layout-w")},Va=function(){return[Ea,Da,Ba,Aa,Fa,Ma,Ia,Ra]},Pa=function(){return[Da,Ea,Aa,Ba,Fa,Ma,Ia,Ra]},Ha=function(){return[Ba,Aa,Ea,Da,Ma,Fa]},za=function(){return[Aa,Ba,Da,Ea,Ma,Fa]},Na=function(){return[Ea,Da,Ba,Aa,Fa,Ma]},La=function(){return[Da,Ea,Aa,Ba,Fa,Ma]},ja=Object.freeze({__proto__:null,events:function(n){return Uo([Xo(po(),(function(t,e){var o=n.channels,r=yn(o),i=e,u=function(n,t){return t.universal?n:L(n,(function(n){return I(t.channels,n)}))}(r,i);z(u,(function(n){var e=o[n],r=e.schema,u=Ct("channel["+n+"] data\nReceiver: "+Wr(t.element),r,i.data);e.onReceive(t,u)}))}))])}}),Ua=[Ht("channels",wt(un.value,ut([ua("onReceive"),Qt("schema",Et())])))],Wa=function(n,t,e){return er((function(o,r){e(o,n,t)}))},Ga=function(n,t,e){return function(n,t,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return n.toFunctionAnnotation=function(){return{name:t,parameters:ii(u.slice(0,1).concat(u.slice(3)))}},n}((function(r){for(var i=[],u=1;u<arguments.length;u++)i[u-1]=arguments[u];var a=[r].concat(i);return r.config({name:o(n)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+n+". Using API: "+e)}),(function(n){var e=Array.prototype.slice.call(a,1);return t.apply(void 0,[r,n.config,n.state].concat(e))}))}),e,t)},Xa=function(n){return{key:n,value:void 0}},Ya=function(n,t,e,r,u,a,c){var s=function(n){return Bn(n,e)?n[e]():b.none()},f=Sn(u,(function(n,t){return Ga(e,n,t)})),d=Sn(a,(function(n,t){return ui(n,t)})),m=l(l(l({},d),f),{revoke:i(Xa,e),config:function(t){var o=Ct(e+"-config",n,t);return{key:e,value:{config:o,me:m,configAsRaw:Vn((function(){return Ct(e+"-config",n,t)})),initialConfig:t,state:c}}},schema:o(t),exhibit:function(n,t){return s(n).bind((function(n){return En(r,"exhibit").map((function(e){return e(t,n.config,n.state)}))})).getOr(mi({}))},name:o(e),handlers:function(n){return s(n).map((function(n){return En(r,"events").getOr((function(){return{}}))(n.config,n.state)})).getOr({})}});return m},qa=function(n){return Yn(n)},Ja=ut([Pt("fields"),Pt("name"),Qt("active",{}),Qt("apis",{}),Qt("state",fi),Qt("extra",{})]),Ka=function(n){var t=Ct("Creating behaviour: "+n.name,Ja,n);return function(n,t,e,o,r,i){var u,a,c=ut(n),s=$t(t,[(u="config",a=n,Yt(u,ut(a)))]);return Ya(c,s,t,e,o,r,i)}(t.fields,t.name,t.active,t.apis,t.extra,t.state)},$a=ut([Pt("branchKey"),Pt("branches"),Pt("name"),Qt("active",{}),Qt("apis",{}),Qt("state",fi),Qt("extra",{})]),Qa=function(n){var t=Ct("Creating behaviour: "+n.name,$a,n);return function(n,t,e,o,r,i){var u=n,a=$t(t,[Yt("config",n)]);return Ya(u,a,t,e,o,r,i)}(Tt(t.branchKey,t.branches),t.name,t.active,t.apis,t.extra,t.state)},Za=o(void 0),nc=Ka({fields:Ua,name:"receiving",active:ja}),tc=Object.freeze({__proto__:null,exhibit:function(n,t){return mi({classes:[],styles:t.useFixed()?{}:{position:"relative"}})}}),ec=function(n){return n.dom.focus()},oc=function(n){return void 0===n&&(n=fe.fromDom(document)),b.from(n.dom.activeElement).map(fe.fromDom)},rc=function(n){return oc(wr(n)).filter((function(t){return n.dom.contains(t.dom)}))},ic=function(n,e){var o=wr(e),r=oc(o).bind((function(n){var t,o,r=function(t){return Re(n,t)};return r(e)?b.some(e):(t=r,(o=function(n){for(var e=0;e<n.childNodes.length;e++){var r=fe.fromDom(n.childNodes[e]);if(t(r))return b.some(r);var i=o(n.childNodes[e]);if(i.isSome())return i}return b.none()})(e.dom))})),i=n(e);return r.each((function(n){oc(o).filter((function(t){return Re(t,n)})).fold((function(){ec(n)}),t)})),i},uc=function(n,t,e,o,r){return{position:n,left:t,top:e,right:o,bottom:r}},ac=function(n,t){var e=function(n){return n+"px"};Ni(n,{position:b.some(t.position),left:t.left.map(e),top:t.top.map(e),right:t.right.map(e),bottom:t.bottom.map(e)})},cc=An([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),sc=function(n,t,e,o,r,i){var u=t.x-e,a=t.y-o,c=r-(u+t.width),s=i-(a+t.height),f=b.some(u),l=b.some(a),d=b.some(c),m=b.some(s),g=b.none();return function(n,t,e,o,r,i,u,a,c){return n.fold(t,e,o,r,i,u,a,c)}(t.direction,(function(){return uc(n,f,l,g,g)}),(function(){return uc(n,g,l,d,g)}),(function(){return uc(n,f,g,g,m)}),(function(){return uc(n,g,g,d,m)}),(function(){return uc(n,f,l,g,g)}),(function(){return uc(n,f,g,g,m)}),(function(){return uc(n,f,l,g,g)}),(function(){return uc(n,g,l,d,g)}))},fc=function(n,t){var e=i(Du,t),o=n.fold(e,e,(function(){var n=ku();return Du(t).translate(-n.left,-n.top)})),r=yu(t),u=lu(t);return Bu(o.left,o.top,r,u)},lc=function(n,t){return t.fold((function(){return n.fold(Fu,Fu,Bu)}),(function(t){return n.fold(t,t,(function(){var e=t(),o=dc(n,e.x,e.y);return Bu(o.left,o.top,e.width,e.height)}))}))},dc=function(n,t,e){var r=mu(t,e);return n.fold(o(r),o(r),(function(){var n=ku();return r.translate(-n.left,-n.top)}))},mc=(cc.none,cc.relative),gc=cc.fixed,pc=function(n,t){return function(n,t){return{anchorBox:n,origin:t}}(n,t)},hc=function(n,t,e,o){var r=n+t;return r>o?e:r<e?o:r},vc=function(n,t,e){return Math.min(Math.max(n,t),e)},bc=An([{fit:["reposition"]},{nofit:["reposition","deltaW","deltaH"]}]),yc=function(n,t,e,i){var u=n.x,a=n.y,c=n.bubble.offset,s=c.left,f=c.top,l=function(n,t,e){var o=function(n,o){var i="top"===n||"bottom"===n?e.top:e.left;return En(t,n).bind(r).bind((function(t){return"left"===n||"top"===n?t>=o?b.some(t):b.none():t<=o?b.some(t):b.none()})).map((function(n){return n+i})).getOr(o)},i=o("left",n.x),u=o("top",n.y),a=o("right",n.right),c=o("bottom",n.bottom);return Bu(i,u,a-i,c-u)}(i,n.boundsRestriction,c),d=l.y,m=l.bottom,g=l.x,p=l.right,h=a+f,v=function(n,t,e,o,r){var i=r.x,u=r.y,a=r.width,c=r.height,s=n>=i,f=t>=u,l=s&&f,d=n+e<=i+a&&t+o<=u+c,m=Math.abs(Math.min(e,s?i+a-n:i-(n+e))),g=Math.abs(Math.min(o,f?u+c-t:u-(t+o))),p=Math.max(r.x,r.right-e),h=Math.max(r.y,r.bottom-o);return{originInBounds:l,sizeInBounds:d,limitX:vc(n,r.x,p),limitY:vc(t,r.y,h),deltaW:m,deltaH:g}}(u+s,h,t,e,l),y=v.originInBounds,x=v.sizeInBounds,w=v.limitX,S=v.limitY,k=v.deltaW,C=v.deltaH,O=o(S+C-d),_=o(m-S),T=function(n,t,e,o){return n.fold(t,t,o,o,t,o,e,e)}(n.direction,_,_,O),E=o(w+k-g),D=o(p-w),B={x:w,y:S,width:k,height:C,maxHeight:T,maxWidth:function(n,t,e,o){return n.fold(t,o,t,o,e,e,t,o)}(n.direction,D,D,E),direction:n.direction,classes:{on:n.bubble.classesOn,off:n.bubble.classesOff},label:n.label,candidateYforTest:h};return y&&x?bc.fit(B):bc.nofit(B,k,C)},xc=function(n,t,e,o){Xi(t,"max-height"),Xi(t,"max-width");var u,a={width:yu(u=t),height:lu(u)};return function(n,t,e,o,u){var a=e.width,c=e.height,s=function(n,r,i,s){var f=n(t,e,o);return yc(f,a,c,u).fold(bc.fit,(function(n,t,e){return e>s||t>i?bc.nofit(n,t,e):bc.nofit(r,i,s)}))};return U(n,(function(n,t){var e=i(s,t);return n.fold(bc.fit,e)}),bc.nofit({x:t.x,y:t.y,width:e.width,height:e.height,maxHeight:e.height,maxWidth:e.width,direction:ma(),classes:{on:[],off:[]},label:"none",candidateYforTest:t.y},-1,-1)).fold(r,r)}(o.preference,n,a,e,o.bounds)},wc=function(n,t,e){ac(n,function(n,t){return n.fold((function(){return uc("absolute",b.some(t.x),b.some(t.y),b.none(),b.none())}),(function(n,e,o,r){return sc("absolute",t,n,e,o,r)}),(function(n,e,o,r){return sc("fixed",t,n,e,o,r)}))}(e.origin,t))},Sc=function(n,t){!function(n,t){var e=su.max(n,t,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);Hi(n,"max-height",e+"px")}(n,Math.floor(t))},kc=o((function(n,t){Sc(n,t),zi(n,{"overflow-x":"hidden","overflow-y":"auto"})})),Cc=o((function(n,t){Sc(n,t)})),Oc=function(n,t,e){return void 0===n[t]?e:n[t]},_c=function(n,t,e,o){var r=xc(n,t,e,o);wc(t,r,o),function(n,t){var e=t.classes;Ai(n,e.off),Bi(n,e.on)}(t,r),function(n,t,e){(0,e.maxHeightFunction)(n,t.maxHeight)}(t,r,o),function(n,t,e){(0,e.maxWidthFunction)(n,t.maxWidth)}(t,r,o)},Tc=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right"],Ec=function(n,t,e){var o=function(n){return En(e,n).getOr([])},r=function(n,t,e){var r=K(Tc,e);return{offset:mu(n,t),classesOn:Y(e,o),classesOff:Y(r,o)}};return{southeast:function(){return r(-n,t,["top","alignLeft"])},southwest:function(){return r(n,t,["top","alignRight"])},south:function(){return r(-n/2,t,["top","alignCentre"])},northeast:function(){return r(-n,-t,["bottom","alignLeft"])},northwest:function(){return r(n,-t,["bottom","alignRight"])},north:function(){return r(-n/2,-t,["bottom","alignCentre"])},east:function(){return r(n,-t/2,["valignCentre","left"])},west:function(){return r(-n,-t/2,["valignCentre","right"])},innerNorthwest:function(){return r(-n,t,["top","alignRight"])},innerNortheast:function(){return r(n,t,["top","alignLeft"])},innerNorth:function(){return r(-n/2,t,["top","alignCentre"])},innerSouthwest:function(){return r(-n,-t,["bottom","alignRight"])},innerSoutheast:function(){return r(n,-t,["bottom","alignLeft"])},innerSouth:function(){return r(-n/2,-t,["bottom","alignCentre"])},innerWest:function(){return r(n,-t/2,["valignCentre","right"])},innerEast:function(){return r(-n,-t/2,["valignCentre","left"])}}},Dc=function(){return Ec(0,0,{})},Bc=function(n,t){return function(e){return"rtl"===Ac(e)?t:n}},Ac=function(n){return"rtl"===Li(n,"direction")?"rtl":"ltr"};!function(n){n.TopToBottom="toptobottom",n.BottomToTop="bottomtotop"}(Gu||(Gu={}));var Mc,Fc="data-alloy-vertical-dir",Ic=function(n){return Hu(n,(function(n){return ur(n)&&Hr(n,"data-alloy-vertical-dir")===Gu.BottomToTop}))},Rc=function(){return $t("layouts",[Pt("onLtr"),Pt("onRtl"),Xt("onBottomLtr"),Xt("onBottomRtl")])},Vc=function(n,t,e,o,r,i,u){var a=u.map(Ic).getOr(!1),c=t.layouts.map((function(t){return t.onLtr(n)})),s=t.layouts.map((function(t){return t.onRtl(n)})),f=a?t.layouts.bind((function(t){return t.onBottomLtr.map((function(t){return t(n)}))})).or(c).getOr(r):c.getOr(e),l=a?t.layouts.bind((function(t){return t.onBottomRtl.map((function(t){return t(n)}))})).or(s).getOr(i):s.getOr(o);return Bc(f,l)(n)},Pc=[Pt("hotspot"),Xt("bubble"),Qt("overrides",{}),Rc(),ca("placement",(function(n,t,e){var o=t.hotspot,r=fc(e,o.element),i=Vc(n.element,t,Na(),La(),Ha(),za(),b.some(t.hotspot.element));return b.some({anchorBox:r,bubble:t.bubble.getOr(Dc()),overrides:t.overrides,layouts:i,placer:b.none()})}))],Hc=[Pt("x"),Pt("y"),Qt("height",0),Qt("width",0),Qt("bubble",Dc()),Qt("overrides",{}),Rc(),ca("placement",(function(n,t,e){var o=dc(e,t.x,t.y),r=Bu(o.left,o.top,t.width,t.height),i=Vc(n.element,t,Va(),Pa(),Va(),Pa(),b.none());return b.some({anchorBox:r,bubble:t.bubble,overrides:t.overrides,layouts:i,placer:b.none()})}))],zc=An([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Nc=function(n){return n.fold(r,(function(n,t,e){return n.translate(-t,-e)}))},Lc=function(n){return n.fold(r,r)},jc=function(n){return U(n,(function(n,t){return n.translate(t.left,t.top)}),mu(0,0))},Uc=function(n){var t=H(n,Lc);return jc(t)},Wc=zc.screen,Gc=zc.absolute,Xc=function(n,t,e){var o=fr(n.element),r=ku(o),i=function(n,t,e){var o=mr(e.root).dom;return b.from(o.frameElement).map(fe.fromDom).filter((function(t){var e=fr(t),o=fr(n.element);return Re(e,o)})).map(pu)}(n,0,e).getOr(r);return Gc(i,r.left,r.top)},Yc=function(n,t,e,o){var r=n,i=t,u=e,a=o;n<0&&(r=0,u=e+n),t<0&&(i=0,a=o+t);var c=Wc(mu(r,i));return b.some(function(n,t,e){return{point:n,width:t,height:e}}(c,u,a))},qc=function(n,t,e,o,r){return n.map((function(n){var i,u,a,c=[t,n.point],s=(i=function(){return Uc(c)},u=function(){return Uc(c)},a=function(){return function(n){var t=H(n,Nc);return jc(t)}(c)},o.fold(i,u,a)),f=function(n,t,e,o){return{x:n,y:t,width:e,height:o}}(s.left,s.top,n.width,n.height),l=e.showAbove?Ha():Na(),d=e.showAbove?za():La(),m=Vc(r,e,l,d,l,d,b.none());return{anchorBox:f,bubble:e.bubble.getOr(Dc()),overrides:e.overrides,layouts:m,placer:b.none()}}))},Jc=[Pt("node"),Pt("root"),Xt("bubble"),Rc(),Qt("overrides",{}),Qt("showAbove",!1),ca("placement",(function(n,t,e){var o=Xc(n,0,t);return t.node.filter(Fi).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Yc(i.left,i.top,i.width,i.height),a=t.node.getOr(n.element);return qc(u,o,t,e,a)}))}))],Kc=function(n,t,e,o){return{start:n,soffset:t,finish:e,foffset:o}},$c=An([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Qc=($c.before,$c.on,$c.after,function(n){return n.fold(r,r,r)}),Zc=An([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),ns=Zc.domRange,ts=Zc.relative,es=Zc.exact,os=Kc,rs={domRange:ns,relative:ts,exact:es,exactFromRange:function(n){return Zc.exact(n.start,n.soffset,n.finish,n.foffset)},getWin:function(n){var t=function(n){return n.match({domRange:function(n){return fe.fromDom(n.startContainer)},relative:function(n,t){return Qc(n)},exact:function(n,t,e,o){return n}})}(n);return mr(t)},range:os},is=function(n,t,e){var o,r=n.document.createRange();return o=r,t.fold((function(n){o.setStartBefore(n.dom)}),(function(n,t){o.setStart(n.dom,t)}),(function(n){o.setStartAfter(n.dom)})),function(n,t){t.fold((function(t){n.setEndBefore(t.dom)}),(function(t,e){n.setEnd(t.dom,e)}),(function(t){n.setEndAfter(t.dom)}))}(r,e),r},us=function(n,t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},as=function(n){return{left:n.left,top:n.top,right:n.right,bottom:n.bottom,width:n.width,height:n.height}},cs=An([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),ss=function(n,t,e){return t(fe.fromDom(e.startContainer),e.startOffset,fe.fromDom(e.endContainer),e.endOffset)},fs=function(n,t){return function(n,t){var e=t.ltr();return e.collapsed?t.rtl().filter((function(n){return!1===n.collapsed})).map((function(n){return cs.rtl(fe.fromDom(n.endContainer),n.endOffset,fe.fromDom(n.startContainer),n.startOffset)})).getOrThunk((function(){return ss(0,cs.ltr,e)})):ss(0,cs.ltr,e)}(0,function(n,t){return t.match({domRange:function(n){return{ltr:o(n),rtl:b.none}},relative:function(t,e){return{ltr:Vn((function(){return is(n,t,e)})),rtl:Vn((function(){return b.some(is(n,e,t))}))}},exact:function(t,e,o,r){return{ltr:Vn((function(){return us(n,t,e,o,r)})),rtl:Vn((function(){return b.some(us(n,o,r,t,e))}))}}})}(n,t))},ls=(cs.ltr,cs.rtl,function(n,t){var e=function(t){return n(t)?b.from(t.dom.nodeValue):b.none()};return{get:function(o){if(!n(o))throw new Error("Can only get "+t+" value of a "+t+" node");return e(o).getOr("")},getOption:e,set:function(e,o){if(!n(e))throw new Error("Can only set raw "+t+" value of a "+t+" node");e.dom.nodeValue=o}}}(ar,"text")),ds=function(n){return ls.getOption(n)},ms=["img","br"],gs=function(n){return ds(n).filter((function(n){return 0!==n.trim().length||n.indexOf(" ")>-1})).isSome()||I(ms,rr(n))},ps=function(n,t){var e=function(n){for(var o=hr(n),r=o.length-1;r>=0;r--){var i=o[r];if(t(i))return b.some(i);var u=e(i);if(u.isSome())return u}return b.none()};return e(n)},hs=function(n,t){return function(n,t){var e=void 0===t?document:t.dom;return Ie(e)?[]:H(e.querySelectorAll(n),fe.fromDom)}(t,n)},vs=function(n,t,e,o){var r=function(n,t,e,o){var r=fr(n).dom.createRange();return r.setStart(n.dom,t),r.setEnd(e.dom,o),r}(n,t,e,o),i=Re(n,e)&&t===o;return r.collapsed&&!i},bs=function(n){if(n.rangeCount>0){var t=n.getRangeAt(0),e=n.getRangeAt(n.rangeCount-1);return b.some(Kc(fe.fromDom(t.startContainer),t.startOffset,fe.fromDom(e.endContainer),e.endOffset))}return b.none()},ys=function(n){if(null===n.anchorNode||null===n.focusNode)return bs(n);var t=fe.fromDom(n.anchorNode),e=fe.fromDom(n.focusNode);return vs(t,n.anchorOffset,e,n.focusOffset)?b.some(Kc(t,n.anchorOffset,e,n.focusOffset)):bs(n)},xs=function(n){return function(n){return b.from(n.getSelection())}(n).filter((function(n){return n.rangeCount>0})).bind(ys)},ws=function(n,t){return function(n){var t=n.getClientRects(),e=t.length>0?t[0]:n.getBoundingClientRect();return e.width>0||e.height>0?b.some(e).map(as):b.none()}(function(n,t){return fs(n,t).match({ltr:function(t,e,o,r){var i=n.document.createRange();return i.setStart(t.dom,e),i.setEnd(o.dom,r),i},rtl:function(t,e,o,r){var i=n.document.createRange();return i.setStart(o.dom,r),i.setEnd(t.dom,e),i}})}(n,t))},Ss=function(n,t){return{element:n,offset:t}},ks=function(n,t){var e=hr(n);if(0===e.length)return Ss(n,t);if(t<e.length)return Ss(e[t],0);var o=e[e.length-1],r=ar(o)?function(n){return ls.get(n)}(o).length:hr(o).length;return Ss(o,r)},Cs=function(n,t){return ar(n)?Ss(n,t):ks(n,t)},Os=function(n,t){return t.getSelection.getOrThunk((function(){return function(){return xs(n)}}))().map((function(n){var t=Cs(n.start,n.soffset),e=Cs(n.finish,n.foffset);return rs.range(t.element,t.offset,e.element,e.offset)}))},_s=[Xt("getSelection"),Pt("root"),Xt("bubble"),Rc(),Qt("overrides",{}),Qt("showAbove",!1),ca("placement",(function(n,t,e){var o=mr(t.root).dom,r=Xc(n,0,t),i=Os(o,t).bind((function(n){return ws(o,rs.exactFromRange(n)).orThunk((function(){var t=fe.fromText("\ufeff");return _r(n.start,t),ws(o,rs.exact(t,0,t,1)).map((function(n){return Mr(t),n}))})).bind((function(n){return Yc(n.left,n.top,n.width,n.height)}))})),u=Os(o,t).bind((function(n){return ur(n.start)?b.some(n.start):function(n){return gr(n)}(n.start)})).getOr(n.element);return qc(i,r,t,e,u)}))],Ts=function(n){return n.x+n.width},Es=function(n,t){return n.x-t.width},Ds=function(n,t){return n.y-t.height+n.height},Bs=function(n){return n.y},As=function(n,t,e){return la(Ts(n),Bs(n),e.southeast(),ma(),wa(n,{left:0,top:2}),"link-layout-se")},Ms=function(n,t,e){return la(Es(n,t),Bs(n),e.southwest(),ga(),wa(n,{right:1,top:2}),"link-layout-sw")},Fs=function(n,t,e){return la(Ts(n),Ds(n,t),e.northeast(),pa(),wa(n,{left:0,bottom:3}),"link-layout-ne")},Is=function(n,t,e){return la(Es(n,t),Ds(n,t),e.northwest(),ha(),wa(n,{right:1,bottom:3}),"link-layout-nw")},Rs=function(){return[As,Ms,Fs,Is]},Vs=function(){return[Ms,As,Is,Fs]},Ps=[Pt("item"),Rc(),Qt("overrides",{}),ca("placement",(function(n,t,e){var o=fc(e,t.item.element),r=Vc(n.element,t,Rs(),Vs(),Rs(),Vs(),b.none());return b.some({anchorBox:o,bubble:Dc(),overrides:t.overrides,layouts:r,placer:b.none()})}))],Hs=Tt("anchor",{selection:_s,node:Jc,hotspot:Pc,submenu:Ps,makeshift:Hc}),zs=function(n,e,o,r,i){!function(n,e,o,r,i,u){var a=Oc(u,"maxHeightFunction",kc()),c=Oc(u,"maxWidthFunction",t),s=n.anchorBox,f=n.origin,l={bounds:lc(f,i),origin:f,preference:r,maxHeightFunction:a,maxWidthFunction:c};_c(s,e,o,l)}(pc(o.anchorBox,e),i.element,o.bubble,o.layouts,r,o.overrides)},Ns=function(n,t,e,o,r,i){var u=i.map(Au);return Ls(n,t,e,o,r,u)},Ls=function(n,t,e,r,i,u){var a=Ct("positioning anchor.info",Hs,r);ic((function(){Hi(i.element,"position","fixed");var e=Ui(i.element,"visibility");Hi(i.element,"visibility","hidden");var r,c=t.useFixed()?(r=document.documentElement,gc(0,0,r.clientWidth,r.clientHeight)):function(n){var t=pu(n.element),e=n.element.dom.getBoundingClientRect();return mc(t.left,t.top,e.width,e.height)}(n),s=a.placement,f=u.map(o).or(t.getBounds);s(n,a,c).each((function(t){t.placer.getOr(zs)(n,c,t,f,i)})),e.fold((function(){Xi(i.element,"visibility")}),(function(n){Hi(i.element,"visibility",n)})),Ui(i.element,"left").isNone()&&Ui(i.element,"top").isNone()&&Ui(i.element,"right").isNone()&&Ui(i.element,"bottom").isNone()&&Ui(i.element,"position").is("fixed")&&Xi(i.element,"position")}),i.element)},js=Object.freeze({__proto__:null,position:function(n,t,e,o,r){Ns(n,t,e,o,r,b.none())},positionWithin:Ns,positionWithinBounds:Ls,getMode:function(n,t,e){return t.useFixed()?"fixed":"absolute"}}),Us=[Qt("useFixed",c),Xt("getBounds")],Ws=Ka({fields:Us,name:"positioning",active:tc,apis:js}),Gs=function(n){Po(n,Eo());var t=n.components();z(t,Gs)},Xs=function(n){var t=n.components();z(t,Xs),Po(n,To())},Ys=function(n,t){Dr(n.element,t.element)},qs=function(n,t){var e=n.components();!function(n){z(n.components(),(function(n){return Mr(n.element)})),Ar(n.element),n.syncComponents()}(n);var o=K(e,t);z(o,(function(t){Gs(t),n.getSystem().removeFromWorld(t)})),z(t,(function(t){t.getSystem().isConnected()?Ys(n,t):(n.getSystem().addToWorld(t),Ys(n,t),Fi(n.element)&&Xs(t)),n.syncComponents()}))},Js=function(n,t){Ks(n,t,Dr)},Ks=function(n,t,e){n.getSystem().addToWorld(t),e(n.element,t.element),Fi(n.element)&&Xs(t),n.syncComponents()},$s=function(n){Gs(n),Mr(n.element),n.getSystem().removeFromWorld(n)},Qs=function(n){var t=gr(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}));$s(n),t.each((function(n){n.syncComponents()}))},Zs=function(n){var t=n.components();z(t,$s),Ar(n.element),n.syncComponents()},nf=function(n,t){tf(n,t,Dr)},tf=function(n,t,e){e(n,t.element);var o=hr(t.element);z(o,(function(n){t.getByDom(n).each(Xs)}))},ef=function(n){var t=hr(n.element);z(t,(function(t){n.getByDom(t).each(Gs)})),Mr(n.element)},of=function(n,t,e,o){e.get().each((function(t){Zs(n)}));var r=t.getAttachPoint(n);Js(r,n);var i=n.getSystem().build(o);return Js(n,i),e.set(i),i},rf=function(n,t,e,o){var r=of(n,t,e,o);return t.onOpen(n,r),r},uf=function(n,t,e){e.get().each((function(o){Zs(n),Qs(n),t.onClose(n,o),e.clear()}))},af=function(n,t,e){return e.isOpen()},cf=function(n,t,e){var o=t.getAttachPoint(n);Hi(n.element,"position",Ws.getMode(o)),function(n,t,e,o){Ui(n.element,t).fold((function(){Lr(n.element,e)}),(function(t){Pr(n.element,e,t)})),Hi(n.element,t,o)}(n,"visibility",t.cloakVisibilityAttr,"hidden")},sf=function(n,t,e){(function(n){return R(["top","left","right","bottom"],(function(t){return Ui(n,t).isSome()}))})(n.element)||Xi(n.element,"position"),function(n,t,e){zr(n.element,e).fold((function(){return Xi(n.element,t)}),(function(e){return Hi(n.element,t,e)}))}(n,"visibility",t.cloakVisibilityAttr)},ff=Object.freeze({__proto__:null,cloak:cf,decloak:sf,open:rf,openWhileCloaked:function(n,t,e,o,r){cf(n,t),rf(n,t,e,o),r(),sf(n,t)},close:uf,isOpen:af,isPartOf:function(n,t,e,o){return af(0,0,e)&&e.get().exists((function(e){return t.isPartOf(n,e,o)}))},getState:function(n,t,e){return e.get()},setContent:function(n,t,e,o){return e.get().map((function(){return of(n,t,e,o)}))}}),lf=Object.freeze({__proto__:null,events:function(n,t){return Uo([Xo(xo(),(function(e,o){uf(e,n,t)}))])}}),df=[ra("onOpen"),ra("onClose"),Pt("isPartOf"),Pt("getAttachPoint"),Qt("cloakVisibilityAttr","data-precloak-visibility")],mf=Ka({fields:df,name:"sandboxing",active:lf,apis:ff,state:Object.freeze({__proto__:null,init:function(){var n=ce(b.none()),t=o("not-implemented");return li({readState:t,isOpen:function(){return n.get().isSome()},clear:function(){n.set(b.none())},set:function(t){n.set(b.some(t))},get:function(){return n.get()}})}})}),gf=o("dismiss.popups"),pf=o("reposition.popups"),hf=o("mouse.released"),vf=ut([Qt("isExtraPart",c),$t("fireEventInstead",[Qt("event",Do())])]),bf=function(n){var t,e=Ct("Dismissal",vf,n);return(t={})[gf()]={schema:ut([Pt("target")]),onReceive:function(n,t){mf.isOpen(n)&&(mf.isPartOf(n,t.target)||e.isExtraPart(n,t.target)||e.fireEventInstead.fold((function(){return mf.close(n)}),(function(t){return Po(n,t.event)})))}},t},yf=ut([$t("fireEventInstead",[Qt("event",Bo())]),jt("doReposition")]),xf=function(n){var t,e=Ct("Reposition",yf,n);return(t={})[pf()]={onReceive:function(n){mf.isOpen(n)&&e.fireEventInstead.fold((function(){return e.doReposition(n)}),(function(t){return Po(n,t.event)}))}},t},wf=function(n,t,e){t.store.manager.onLoad(n,t,e)},Sf=function(n,t,e){t.store.manager.onUnload(n,t,e)},kf=Object.freeze({__proto__:null,onLoad:wf,onUnload:Sf,setValue:function(n,t,e,o){t.store.manager.setValue(n,t,e,o)},getValue:function(n,t,e){return t.store.manager.getValue(n,t,e)},getState:function(n,t,e){return e}}),Cf=Object.freeze({__proto__:null,events:function(n,t){var e=n.resetOnDom?[nr((function(e,o){wf(e,n,t)})),tr((function(e,o){Sf(e,n,t)}))]:[Wa(n,t,wf)];return Uo(e)}}),Of=function(){var n=ce(null);return li({set:n.set,get:n.get,isNotSet:function(){return null===n.get()},clear:function(){n.set(null)},readState:function(){return{mode:"memory",value:n.get()}}})},_f=function(){var n=ce({}),t=ce({});return li({readState:function(){return{mode:"dataset",dataByValue:n.get(),dataByText:t.get()}},lookup:function(e){return En(n.get(),e).orThunk((function(){return En(t.get(),e)}))},update:function(e){var o=n.get(),r=t.get(),i={},u={};z(e,(function(n){i[n.value]=n,En(n,"meta").each((function(t){En(t,"text").each((function(t){u[t]=n}))}))})),n.set(l(l({},o),i)),t.set(l(l({},r),u))},clear:function(){n.set({}),t.set({})}})},Tf=Object.freeze({__proto__:null,memory:Of,dataset:_f,manual:function(){return li({readState:t})},init:function(n){return n.store.manager.state(n)}}),Ef=function(n,t,e,o){var r=t.store;e.update([o]),r.setValue(n,o),t.onSetValue(n,o)},Df=[Xt("initialValue"),Pt("getFallbackEntry"),Pt("getDataKey"),Pt("setValue"),ca("manager",{setValue:Ef,getValue:function(n,t,e){var o=t.store,r=o.getDataKey(n);return e.lookup(r).fold((function(){return o.getFallbackEntry(r)}),(function(n){return n}))},onLoad:function(n,t,e){t.store.initialValue.each((function(o){Ef(n,t,e,o)}))},onUnload:function(n,t,e){e.clear()},state:_f})],Bf=[Pt("getValue"),Qt("setValue",t),Xt("initialValue"),ca("manager",{setValue:function(n,t,e,o){t.store.setValue(n,o),t.onSetValue(n,o)},getValue:function(n,t,e){return t.store.getValue(n)},onLoad:function(n,t,e){t.store.initialValue.each((function(e){t.store.setValue(n,e)}))},onUnload:t,state:fi.init})],Af=[Xt("initialValue"),ca("manager",{setValue:function(n,t,e,o){e.set(o),t.onSetValue(n,o)},getValue:function(n,t,e){return e.get()},onLoad:function(n,t,e){t.store.initialValue.each((function(n){e.isNotSet()&&e.set(n)}))},onUnload:function(n,t,e){e.clear()},state:Of})],Mf=[Zt("store",{mode:"memory"},Tt("mode",{memory:Af,manual:Bf,dataset:Df})),ra("onSetValue"),Qt("resetOnDom",!1)],Ff=Ka({fields:Mf,name:"representing",active:Cf,apis:kf,extra:{setValueFrom:function(n,t){var e=Ff.getValue(t);Ff.setValue(n,e)}},state:Tf}),If=function(n,t){return ue(n,{},H(t,(function(t){return e=t.name(),o="Cannot configure "+t.name()+" for "+n,gt(e,e,Ln(),rt((function(n){return gn("The field: "+e+" is forbidden. "+o)})));var e,o})).concat([ae("dump",r)]))},Rf=function(n){return n.dump},Vf=function(n,t){return l(l({},n.dump),qa(t))},Pf=If,Hf=Vf,zf=An([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Nf=function(n){return Dn(n,"uiType")},Lf=function(n,t,e,r){return Nf(e)&&"placeholder"===e.uiType?function(n,t,e,r){return n.exists((function(n){return n!==e.owner}))?zf.single(!0,o(e)):En(r,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+yn(r)+"]\nNamespace: "+n.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(n){return n.replace()}))}(n,0,e,r):zf.single(!1,o(e))},jf=function(n,t,e,o){return Lf(n,0,e,o).fold((function(r,i){var u=Nf(e)?i(t,e.config,e.validated):i(t),a=En(u,"components").getOr([]),c=Y(a,(function(e){return jf(n,t,e,o)}));return[l(l({},u),{components:c})]}),(function(n,o){if(Nf(e)){var i=o(t,e.config,e.validated);return e.validated.preprocess.getOr(r)(i)}return o(t)}))},Uf=function(n,t,e,r){var i=Sn(r,(function(n,t){return r=n,i=!1,{name:o(e=t),required:function(){return r.fold((function(n,t){return n}),(function(n,t){return n}))},used:function(){return i},replace:function(){if(i)throw new Error("Trying to use the same placeholder more than once: "+e);return i=!0,r}};var e,r,i})),u=function(n,t,e,o){return Y(e,(function(e){return jf(n,t,e,o)}))}(n,t,e,i);return wn(i,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+n.getOr("none")+"\nComponents: "+JSON.stringify(t.components,null,2))})),u},Wf=zf.single,Gf=zf.multiple,Xf=o("placeholder"),Yf=An([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),qf=Qt("factory",{sketch:r}),Jf=Qt("schema",[]),Kf=Pt("name"),$f=gt("pname","pname",jn((function(n){return"<alloy."+qr(n.name)+">"})),Et()),Qf=ae("schema",(function(){return[Xt("preprocess")]})),Zf=Qt("defaults",o({})),nl=Qt("overrides",o({})),tl=at([qf,Jf,Kf,$f,Zf,nl]),el=at([qf,Jf,Kf,Zf,nl]),ol=at([qf,Jf,Kf,$f,Zf,nl]),rl=at([qf,Qf,Kf,Pt("unit"),$f,Zf,nl]),il=function(n){return n.fold(b.some,b.none,b.some,b.some)},ul=function(n){var t=function(n){return n.name};return n.fold(t,t,t,t)},al=function(n,t){return function(e){var o=Ct("Converting part type",t,e);return n(o)}},cl=al(Yf.required,tl),sl=al(Yf.external,el),fl=al(Yf.optional,ol),ll=al(Yf.group,rl),dl=o("entirety"),ml=Object.freeze({__proto__:null,required:cl,external:sl,optional:fl,group:ll,asNamedPart:il,name:ul,asCommon:function(n){return n.fold(r,r,r,r)},original:dl}),gl=function(n,t,e,o){return In(t.defaults(n,e,o),e,{uid:n.partUids[t.name]},t.overrides(n,e,o))},pl=function(n,t){var e={};return z(t,(function(t){il(t).each((function(t){var o=hl(n,t.pname);e[t.name]=function(e){var r=Ct("Part: "+t.name+" in "+n,at(t.schema),e);return l(l({},o),{config:e,validated:r})}}))})),e},hl=function(n,t){return{uiType:Xf(),owner:n,name:t}},vl=function(n,t,e){return{uiType:Xf(),owner:n,name:t,config:e,validated:{}}},bl=function(n){return Y(n,(function(n){return n.fold(b.none,b.some,b.none,b.none).map((function(n){return Ut(n.name,n.schema.concat([sa(dl())]))})).toArray()}))},yl=function(n){return H(n,ul)},xl=function(n,t,e){return function(n,t,e){var r={},i={};return z(e,(function(n){n.fold((function(n){r[n.pname]=Wf(!0,(function(t,e,o){return n.factory.sketch(gl(t,n,e,o))}))}),(function(n){var e=t.parts[n.name];i[n.name]=o(n.factory.sketch(gl(t,n,e[dl()]),e))}),(function(n){r[n.pname]=Wf(!1,(function(t,e,o){return n.factory.sketch(gl(t,n,e,o))}))}),(function(n){r[n.pname]=Gf(!0,(function(t,e,o){var r=t[n.name];return H(r,(function(e){return n.factory.sketch(In(n.defaults(t,e,o),e,n.overrides(t,e)))}))}))}))})),{internals:o(r),externals:o(i)}}(0,t,e)},wl=function(n,t,e){return Uf(b.some(n),t,t.components,e)},Sl=function(n,t,e){var o=t.partUids[e];return n.getSystem().getByUid(o).toOptional()},kl=function(n,t,e){return Sl(n,t,e).getOrDie("Could not find part: "+e)},Cl=function(n,t,e){var r={},i=t.partUids,u=n.getSystem();return z(e,(function(n){r[n]=o(u.getByUid(i[n]))})),r},Ol=function(n,t){var e=n.getSystem();return Sn(t.partUids,(function(n,t){return o(e.getByUid(n))}))},_l=function(n){return yn(n.partUids)},Tl=function(n,t,e){var r={},i=t.partUids,u=n.getSystem();return z(e,(function(n){r[n]=o(u.getByUid(i[n]).getOrDie())})),r},El=function(n,t){var e=yl(t);return Yn(H(e,(function(t){return{key:t,value:n+"-"+t}})))},Dl=function(n){return gt("partUids","partUids",Un((function(t){return El(t.uid,n)})),Et())},Bl=Object.freeze({__proto__:null,generate:pl,generateOne:vl,schemas:bl,names:yl,substitutes:xl,components:wl,defaultUids:El,defaultUidsSchema:Dl,getAllParts:Ol,getAllPartNames:_l,getPart:Sl,getPartOrDie:kl,getParts:Cl,getPartsOrDie:Tl}),Al=function(n,t,e,o,r){var i=function(n,t){return(n.length>0?[Ut("parts",n)]:[]).concat([Pt("uid"),Qt("dom",{}),Qt("components",[]),sa("originalSpec"),Qt("debug.sketcher",{})]).concat(t)}(o,r);return Ct(n+" [SpecSchema]",ut(i.concat(t)),e)},Ml=function(n,t,e,o,r){var i=Fl(r),u=bl(e),a=Dl(e),c=Al(n,t,i,u,[a]),s=xl(0,c,e);return o(c,wl(n,c,s.internals()),i,s.externals())},Fl=function(n){return function(n){return Dn(n,"uid")}(n)?n:l(l({},n),{uid:ti("uid")})},Il=ut([Pt("name"),Pt("factory"),Pt("configFields"),Qt("apis",{}),Qt("extraApis",{})]),Rl=ut([Pt("name"),Pt("factory"),Pt("configFields"),Pt("partFields"),Qt("apis",{}),Qt("extraApis",{})]),Vl=function(n){var t=Ct("Sketcher for "+n.name,Il,n),e=Sn(t.apis,si),o=Sn(t.extraApis,(function(n,t){return ui(n,t)}));return l(l({name:t.name,configFields:t.configFields,sketch:function(n){return function(n,t,e,o){var r=Fl(o);return e(Al(n,t,r,[],[]),r)}(t.name,t.configFields,t.factory,n)}},e),o)},Pl=function(n){var t=Ct("Sketcher for "+n.name,Rl,n),e=pl(t.name,t.partFields),o=Sn(t.apis,si),r=Sn(t.extraApis,(function(n,t){return ui(n,t)}));return l(l({name:t.name,partFields:t.partFields,configFields:t.configFields,sketch:function(n){return Ml(t.name,t.configFields,t.partFields,t.factory,n)},parts:e},o),r)},Hl=function(n){for(var t=[],e=function(n){t.push(n)},o=0;o<n.length;o++)n[o].each(e);return t},zl=function(n,t){return n?b.some(t):b.none()},Nl=function(n){return"input"===rr(n)&&"radio"!==Hr(n,"type")||"textarea"===rr(n)},Ll=Object.freeze({__proto__:null,getCurrent:function(n,t,e){return t.find(n)}}),jl=[Pt("find")],Ul=Ka({fields:jl,name:"composing",apis:Ll}),Wl=function(n,t,e,o){var r=hs(n.element,"."+t.highlightClass);z(r,(function(e){R(o,(function(n){return n.element===e}))||(Ei(e,t.highlightClass),n.getSystem().getByDom(e).each((function(e){t.onDehighlight(n,e),Po(e,Vo())})))}))},Gl=function(n,t,e,o){Wl(n,t,0,[o]),Xl(n,t,e,o)||(_i(o.element,t.highlightClass),t.onHighlight(n,o),Po(o,Ro()))},Xl=function(n,t,e,o){return Di(o.element,t.highlightClass)},Yl=function(n,t,e,o){var r=hs(n.element,"."+t.itemClass);return b.from(r[o]).fold((function(){return un.error(new Error("No element found with index "+o))}),n.getSystem().getByDom)},ql=function(n,t,e){return Nu(n.element,"."+t.itemClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Jl=function(n,t,e){var o=hs(n.element,"."+t.itemClass);return(o.length>0?b.some(o[o.length-1]):b.none()).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},Kl=function(n,t,e,o){var r=hs(n.element,"."+t.itemClass);return G(r,(function(n){return Di(n,t.highlightClass)})).bind((function(t){var e=hc(t,o,0,r.length-1);return n.getSystem().getByDom(r[e]).toOptional()}))},$l=function(n,t,e){var o=hs(n.element,"."+t.itemClass);return Hl(H(o,(function(t){return n.getSystem().getByDom(t).toOptional()})))},Ql=Object.freeze({__proto__:null,dehighlightAll:function(n,t,e){return Wl(n,t,0,[])},dehighlight:function(n,t,e,o){Xl(n,t,e,o)&&(Ei(o.element,t.highlightClass),t.onDehighlight(n,o),Po(o,Vo()))},highlight:Gl,highlightFirst:function(n,t,e){ql(n,t).each((function(o){Gl(n,t,e,o)}))},highlightLast:function(n,t,e){Jl(n,t).each((function(o){Gl(n,t,e,o)}))},highlightAt:function(n,t,e,o){Yl(n,t,e,o).fold((function(n){throw n}),(function(o){Gl(n,t,e,o)}))},highlightBy:function(n,t,e,o){var r=$l(n,t);W(r,o).each((function(o){Gl(n,t,e,o)}))},isHighlighted:Xl,getHighlighted:function(n,t,e){return Nu(n.element,"."+t.highlightClass).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))},getFirst:ql,getLast:Jl,getPrevious:function(n,t,e){return Kl(n,t,0,-1)},getNext:function(n,t,e){return Kl(n,t,0,1)},getCandidates:$l}),Zl=[Pt("highlightClass"),Pt("itemClass"),ra("onHighlight"),ra("onDehighlight")],nd=Ka({fields:Zl,name:"highlighting",apis:Ql}),td=[8],ed=[9],od=[13],rd=[27],id=[32],ud=[37],ad=[38],cd=[39],sd=[40],fd=function(n,t,e){var o=J(n.slice(0,t)),r=J(n.slice(t+1));return W(o.concat(r),e)},ld=function(n,t,e){var o=J(n.slice(0,t));return W(o,e)},dd=function(n,t,e){var o=n.slice(0,t),r=n.slice(t+1);return W(r.concat(o),e)},md=function(n,t,e){var o=n.slice(t+1);return W(o,e)},gd=function(n){return function(t){var e=t.raw;return I(n,e.which)}},pd=function(n){return function(t){return q(n,(function(n){return n(t)}))}},hd=function(n){return!0===n.raw.shiftKey},vd=function(n){return!0===n.raw.ctrlKey},bd=u(hd),yd=function(n,t){return{matches:n,classification:t}},xd=function(n,t,e){t.exists((function(n){return e.exists((function(t){return Re(t,n)}))}))||Ho(n,Ao(),{prevFocus:t,newFocus:e})},wd=function(){var n=function(n){return rc(n.element)};return{get:n,set:function(t,e){var o=n(t);t.getSystem().triggerFocus(e,t.element);var r=n(t);xd(t,o,r)}}},Sd=function(){var n=function(n){return nd.getHighlighted(n).map((function(n){return n.element}))};return{get:n,set:function(e,o){var r=n(e);e.getSystem().getByDom(o).fold(t,(function(n){nd.highlight(e,n)}));var i=n(e);xd(e,r,i)}}};!function(n){n.OnFocusMode="onFocus",n.OnEnterOrSpaceMode="onEnterOrSpace",n.OnApiMode="onApi"}(Mc||(Mc={}));var kd,Cd=function(n,t,e,o,r){var i=function(n,t,e,o,r){var i,u,a=e(n,t,o,r);return(i=a,u=t.event,W(i,(function(n){return n.matches(u)})).map((function(n){return n.classification}))).bind((function(e){return e(n,t,o,r)}))},u={schema:function(){return n.concat([Qt("focusManager",wd()),Zt("focusInside","onFocus",xt((function(n){return I(["onFocus","onEnterOrSpace","onApi"],n)?un.value(n):un.error("Invalid value for focusInside")}))),ca("handler",u),ca("state",t),ca("sendFocusIn",r)])},processKey:i,toEvents:function(n,t){var u=n.focusInside!==Mc.OnFocusMode?b.none():r(n).map((function(e){return Xo(lo(),(function(o,r){e(o,n,t),r.stop()}))})),a=[Xo(eo(),(function(o,u){i(o,u,e,n,t).fold((function(){!function(e,o){var i=gd(id.concat(od))(o.event);n.focusInside===Mc.OnEnterOrSpaceMode&&i&&Le(e,o)&&r(n).each((function(r){r(e,n,t),o.stop()}))}(o,u)}),(function(n){u.stop()}))})),Xo(oo(),(function(e,r){i(e,r,o,n,t).each((function(n){r.stop()}))}))];return Uo(u.toArray().concat(a))}};return u},Od=function(n){var t=[Xt("onEscape"),Xt("onEnter"),Qt("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),Qt("firstTabstop",0),Qt("useTabstopAt",s),Xt("visibilitySelector")].concat([n]),e=function(n,t){var e=n.visibilitySelector.bind((function(n){return Lu(t,n)})).getOr(t);return fu(e)>0},r=function(n,t,o){(function(n,t){var o=hs(n.element,t.selector),r=L(o,(function(n){return e(t,n)}));return b.from(r[t.firstTabstop])})(n,t).each((function(e){t.focusManager.set(n,e)}))},u=function(n,t,o,r,i){return i(t,o,(function(n){return function(n,t){return e(n,t)&&n.useTabstopAt(t)}(r,n)})).fold((function(){return r.cyclic?b.some(!0):b.none()}),(function(t){return r.focusManager.set(n,t),b.some(!0)}))},a=function(n,t,e,o){var r=hs(n.element,e.selector);return function(n,t){return t.focusManager.get(n).bind((function(n){return Lu(n,t.selector)}))}(n,e).bind((function(t){return G(r,i(Re,t)).bind((function(t){return u(n,r,t,e,o)}))}))},c=o([yd(pd([hd,gd(ed)]),(function(n,t,e){var o=e.cyclic?fd:ld;return a(n,0,e,o)})),yd(gd(ed),(function(n,t,e){var o=e.cyclic?dd:md;return a(n,0,e,o)})),yd(gd(rd),(function(n,t,e){return e.onEscape.bind((function(e){return e(n,t)}))})),yd(pd([bd,gd(od)]),(function(n,t,e){return e.onEnter.bind((function(e){return e(n,t)}))}))]),f=o([]);return Cd(t,fi.init,c,f,(function(){return b.some(r)}))},_d=Od(ae("cyclic",c)),Td=Od(ae("cyclic",s)),Ed=function(n,t,e){return Nl(e)&&gd(id)(t.event)?b.none():function(n,t,e){return No(n,e,ho()),b.some(!0)}(n,0,e)},Dd=function(n,t){return b.some(!0)},Bd=[Qt("execute",Ed),Qt("useSpace",!1),Qt("useEnter",!0),Qt("useControlEnter",!1),Qt("useDown",!1)],Ad=function(n,t,e){return e.execute(n,t,n.element)},Md=Cd(Bd,fi.init,(function(n,t,e,o){var r=e.useSpace&&!Nl(n.element)?id:[],i=e.useEnter?od:[],u=e.useDown?sd:[],a=r.concat(i).concat(u);return[yd(gd(a),Ad)].concat(e.useControlEnter?[yd(pd([vd,gd(od)]),Ad)]:[])}),(function(n,t,e,o){return e.useSpace&&!Nl(n.element)?[yd(gd(id),Dd)]:[]}),(function(){return b.none()})),Fd=function(){var n=ce(b.none());return li({readState:function(){return n.get().map((function(n){return{numRows:String(n.numRows),numColumns:String(n.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(t,e){n.set(b.some({numRows:t,numColumns:e}))},getNumRows:function(){return n.get().map((function(n){return n.numRows}))},getNumColumns:function(){return n.get().map((function(n){return n.numColumns}))}})},Id=Object.freeze({__proto__:null,flatgrid:Fd,init:function(n){return n.state(n)}}),Rd=function(n){return function(t,e,o,r){var i=n(t.element);return zd(i,t,e,o,r)}},Vd=function(n,t){var e=Bc(n,t);return Rd(e)},Pd=function(n,t){var e=Bc(t,n);return Rd(e)},Hd=function(n){return function(t,e,o,r){return zd(n,t,e,o,r)}},zd=function(n,t,e,o,r){return o.focusManager.get(t).bind((function(e){return n(t.element,e,o,r)})).map((function(n){return o.focusManager.set(t,n),!0}))},Nd=Hd,Ld=Hd,jd=Hd,Ud=function(n){return!function(n){return n.offsetWidth<=0&&n.offsetHeight<=0}(n.dom)},Wd=function(n,t,e){var o=hs(n,e);return function(n,t){return G(n,t).map((function(t){return{index:t,candidates:n}}))}(L(o,Ud),(function(n){return Re(n,t)}))},Gd=function(n,t){return G(n,(function(n){return Re(t,n)}))},Xd=function(n,t,e,o){return o(Math.floor(t/e),t%e).bind((function(t){var o=t.row*e+t.column;return o>=0&&o<n.length?b.some(n[o]):b.none()}))},Yd=function(n,t,e,o,r){return Xd(n,t,o,(function(t,i){var u=t===e-1?n.length-t*o:o,a=hc(i,r,0,u-1);return b.some({row:t,column:a})}))},qd=function(n,t,e,o,r){return Xd(n,t,o,(function(t,i){var u=hc(t,r,0,e-1),a=u===e-1?n.length-u*o:o,c=vc(i,0,a-1);return b.some({row:u,column:c})}))},Jd=[Pt("selector"),Qt("execute",Ed),ia("onEscape"),Qt("captureTab",!1),fa()],Kd=function(n,t,e){Nu(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},$d=function(n){return function(t,e,o,r){return Wd(t,e,o.selector).bind((function(t){return n(t.candidates,t.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Qd=function(n,t,e){return e.captureTab?b.some(!0):b.none()},Zd=$d((function(n,t,e,o){return Yd(n,t,e,o,-1)})),nm=$d((function(n,t,e,o){return Yd(n,t,e,o,1)})),tm=$d((function(n,t,e,o){return qd(n,t,e,o,-1)})),em=$d((function(n,t,e,o){return qd(n,t,e,o,1)})),om=o([yd(gd(ud),Vd(Zd,nm)),yd(gd(cd),Pd(Zd,nm)),yd(gd(ad),Nd(tm)),yd(gd(sd),Ld(em)),yd(pd([hd,gd(ed)]),Qd),yd(pd([bd,gd(ed)]),Qd),yd(gd(rd),(function(n,t,e){return e.onEscape(n,t)})),yd(gd(id.concat(od)),(function(n,t,e,o){return function(n,t){return t.focusManager.get(n).bind((function(n){return Lu(n,t.selector)}))}(n,e).bind((function(o){return e.execute(n,t,o)}))}))]),rm=o([yd(gd(id),Dd)]),im=Cd(Jd,Fd,om,rm,(function(){return b.some(Kd)})),um=function(n,t,e,o){var r=function(n,t,e){var i,u=hc(t,o,0,e.length-1);return u===n?b.none():(i=e[u],"button"===rr(i)&&"disabled"===Hr(i,"disabled")?r(n,u,e):b.from(e[u]))};return Wd(n,e,t).bind((function(n){var t=n.index,e=n.candidates;return r(t,t,e)}))},am=[Pt("selector"),Qt("getInitial",b.none),Qt("execute",Ed),ia("onEscape"),Qt("executeOnMove",!1),Qt("allowVertical",!0)],cm=function(n,t,e){return function(n,t){return t.focusManager.get(n).bind((function(n){return Lu(n,t.selector)}))}(n,e).bind((function(o){return e.execute(n,t,o)}))},sm=function(n,t,e){t.getInitial(n).orThunk((function(){return Nu(n.element,t.selector)})).each((function(e){t.focusManager.set(n,e)}))},fm=function(n,t,e){return um(n,e.selector,t,-1)},lm=function(n,t,e){return um(n,e.selector,t,1)},dm=function(n){return function(t,e,o,r){return n(t,e,o,r).bind((function(){return o.executeOnMove?cm(t,e,o):b.some(!0)}))}},mm=function(n,t,e){return e.onEscape(n,t)},gm=o([yd(gd(id),Dd)]),pm=Cd(am,fi.init,(function(n,t,e,o){var r=ud.concat(e.allowVertical?ad:[]),i=cd.concat(e.allowVertical?sd:[]);return[yd(gd(r),dm(Vd(fm,lm))),yd(gd(i),dm(Pd(fm,lm))),yd(gd(od),cm),yd(gd(id),cm),yd(gd(rd),mm)]}),gm,(function(){return b.some(sm)})),hm=function(n,t,e){return b.from(n[t]).bind((function(n){return b.from(n[e]).map((function(n){return{rowIndex:t,columnIndex:e,cell:n}}))}))},vm=function(n,t,e,o){var r=n[t].length,i=hc(e,o,0,r-1);return hm(n,t,i)},bm=function(n,t,e,o){var r=hc(e,o,0,n.length-1),i=n[r].length,u=vc(t,0,i-1);return hm(n,r,u)},ym=function(n,t,e,o){var r=n[t].length,i=vc(e+o,0,r-1);return hm(n,t,i)},xm=function(n,t,e,o){var r=vc(e+o,0,n.length-1),i=n[r].length,u=vc(t,0,i-1);return hm(n,r,u)},wm=[Ut("selectors",[Pt("row"),Pt("cell")]),Qt("cycles",!0),Qt("previousSelector",b.none),Qt("execute",Ed)],Sm=function(n,t,e){t.previousSelector(n).orThunk((function(){var e=t.selectors;return Nu(n.element,e.cell)})).each((function(e){t.focusManager.set(n,e)}))},km=function(n,t){return function(e,o,r){var i=r.cycles?n:t;return Lu(o,r.selectors.row).bind((function(n){var t=hs(n,r.selectors.cell);return Gd(t,o).bind((function(t){var o=hs(e,r.selectors.row);return Gd(o,n).bind((function(n){var e=function(n,t){return H(n,(function(n){return hs(n,t.selectors.cell)}))}(o,r);return i(e,n,t).map((function(n){return n.cell}))}))}))}))}},Cm=km((function(n,t,e){return vm(n,t,e,-1)}),(function(n,t,e){return ym(n,t,e,-1)})),Om=km((function(n,t,e){return vm(n,t,e,1)}),(function(n,t,e){return ym(n,t,e,1)})),_m=km((function(n,t,e){return bm(n,e,t,-1)}),(function(n,t,e){return xm(n,e,t,-1)})),Tm=km((function(n,t,e){return bm(n,e,t,1)}),(function(n,t,e){return xm(n,e,t,1)})),Em=o([yd(gd(ud),Vd(Cm,Om)),yd(gd(cd),Pd(Cm,Om)),yd(gd(ad),Nd(_m)),yd(gd(sd),Ld(Tm)),yd(gd(id.concat(od)),(function(n,t,e){return rc(n.element).bind((function(o){return e.execute(n,t,o)}))}))]),Dm=o([yd(gd(id),Dd)]),Bm=Cd(wm,fi.init,Em,Dm,(function(){return b.some(Sm)})),Am=[Pt("selector"),Qt("execute",Ed),Qt("moveOnTab",!1)],Mm=function(n,t,e){return e.focusManager.get(n).bind((function(o){return e.execute(n,t,o)}))},Fm=function(n,t,e){Nu(n.element,t.selector).each((function(e){t.focusManager.set(n,e)}))},Im=function(n,t,e){return um(n,e.selector,t,-1)},Rm=function(n,t,e){return um(n,e.selector,t,1)},Vm=o([yd(gd(ad),jd(Im)),yd(gd(sd),jd(Rm)),yd(pd([hd,gd(ed)]),(function(n,t,e,o){return e.moveOnTab?jd(Im)(n,t,e,o):b.none()})),yd(pd([bd,gd(ed)]),(function(n,t,e,o){return e.moveOnTab?jd(Rm)(n,t,e,o):b.none()})),yd(gd(od),Mm),yd(gd(id),Mm)]),Pm=o([yd(gd(id),Dd)]),Hm=Cd(Am,fi.init,Vm,Pm,(function(){return b.some(Fm)})),zm=[ia("onSpace"),ia("onEnter"),ia("onShiftEnter"),ia("onLeft"),ia("onRight"),ia("onTab"),ia("onShiftTab"),ia("onUp"),ia("onDown"),ia("onEscape"),Qt("stopSpaceKeyup",!1),Xt("focusIn")],Nm=Cd(zm,fi.init,(function(n,t,e){return[yd(gd(id),e.onSpace),yd(pd([bd,gd(od)]),e.onEnter),yd(pd([hd,gd(od)]),e.onShiftEnter),yd(pd([hd,gd(ed)]),e.onShiftTab),yd(pd([bd,gd(ed)]),e.onTab),yd(gd(ad),e.onUp),yd(gd(sd),e.onDown),yd(gd(ud),e.onLeft),yd(gd(cd),e.onRight),yd(gd(id),e.onSpace),yd(gd(rd),e.onEscape)]}),(function(n,t,e){return e.stopSpaceKeyup?[yd(gd(id),Dd)]:[]}),(function(n){return n.focusIn})),Lm=_d.schema(),jm=Td.schema(),Um=pm.schema(),Wm=im.schema(),Gm=Bm.schema(),Xm=Md.schema(),Ym=Hm.schema(),qm=Nm.schema(),Jm=Qa({branchKey:"mode",branches:Object.freeze({__proto__:null,acyclic:Lm,cyclic:jm,flow:Um,flatgrid:Wm,matrix:Gm,execution:Xm,menu:Ym,special:qm}),name:"keying",active:{events:function(n,t){return n.handler.toEvents(n,t)}},apis:{focusIn:function(n,t,e){t.sendFocusIn(t).fold((function(){n.getSystem().triggerFocus(n.element,n.element)}),(function(o){o(n,t,e)}))},setGridSize:function(n,t,e,o,r){!function(n){return Bn(n,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:Id}),Km=function(n,t,e,o){var r=n.getSystem().build(o);Ks(n,r,e)},$m=function(n,t,e,o){var r=Qm(n);W(r,(function(n){return Re(o.element,n.element)})).each(Qs)},Qm=function(n,t){return n.components()},Zm=function(n,t,e,o,r){var i=Qm(n);return b.from(i[o]).map((function(t){return $m(n,0,0,t),r.each((function(t){Km(n,0,(function(n,t){!function(n,t,e){vr(n,e).fold((function(){Dr(n,t)}),(function(n){_r(n,t)}))}(n,t,o)}),t)})),t}))},ng=Ka({fields:[],name:"replacing",apis:Object.freeze({__proto__:null,append:function(n,t,e,o){Km(n,0,Dr,o)},prepend:function(n,t,e,o){Km(n,0,Er,o)},remove:$m,replaceAt:Zm,replaceBy:function(n,t,e,o,r){var i=Qm(n);return G(i,o).bind((function(t){return Zm(n,0,0,t,r)}))},set:function(n,t,e,o){ic((function(){var t=H(o,n.getSystem().build);qs(n,t)}),n.element)},contents:Qm})}),tg=function(n,t){return{key:n,value:{config:{},me:function(n,t){var e=Uo(t);return Ka({fields:[Pt("enabled")],name:n,active:{events:o(e)}})}(n,t),configAsRaw:o({}),initialConfig:{},state:fi}}},eg=function(n,t){t.ignore||(ec(n.element),t.onFocus(n))},og=Object.freeze({__proto__:null,focus:eg,blur:function(n,t){t.ignore||function(n){n.dom.blur()}(n.element)},isFocused:function(n){return function(n){var t=wr(n).dom;return n.dom===t.activeElement}(n.element)}}),rg=Object.freeze({__proto__:null,exhibit:function(n,t){var e=t.ignore?{}:{attributes:{tabindex:"-1"}};return mi(e)},events:function(n){return Uo([Xo(lo(),(function(t,e){eg(t,n),e.stop()}))].concat(n.stopMousedown?[Xo(Je(),(function(n,t){t.event.prevent()}))]:[]))}}),ig=[ra("onFocus"),Qt("stopMousedown",!1),Qt("ignore",!1)],ug=Ka({fields:ig,name:"focusing",active:rg,apis:og}),ag=function(n,t,e){var o=t.aria;o.update(n,o,e.get())},cg=function(n,t,e){t.toggleClass.each((function(t){e.get()?_i(n.element,t):Ei(n.element,t)}))},sg=function(n,t,e){dg(n,t,e,!e.get())},fg=function(n,t,e){e.set(!0),cg(n,t,e),ag(n,t,e)},lg=function(n,t,e){e.set(!1),cg(n,t,e),ag(n,t,e)},dg=function(n,t,e,o){(o?fg:lg)(n,t,e)},mg=function(n,t,e){dg(n,t,e,t.selected)},gg=Object.freeze({__proto__:null,onLoad:mg,toggle:sg,isOn:function(n,t,e){return e.get()},on:fg,off:lg,set:dg}),pg=Object.freeze({__proto__:null,exhibit:function(){return mi({})},events:function(n,t){var e,o,r,i=(e=n,o=t,r=sg,or((function(n){r(n,e,o)}))),u=Wa(n,t,mg);return Uo(X([n.toggleOnExecute?[i]:[],[u]]))}}),hg=function(n,t,e){Pr(n.element,"aria-expanded",e)},vg=[Qt("selected",!1),Xt("toggleClass"),Qt("toggleOnExecute",!0),Zt("aria",{mode:"none"},Tt("mode",{pressed:[Qt("syncWithExpanded",!1),ca("update",(function(n,t,e){Pr(n.element,"aria-pressed",e),t.syncWithExpanded&&hg(n,t,e)}))],checked:[ca("update",(function(n,t,e){Pr(n.element,"aria-checked",e)}))],expanded:[ca("update",hg)],selected:[ca("update",(function(n,t,e){Pr(n.element,"aria-selected",e)}))],none:[ca("update",t)]}))],bg=Ka({fields:vg,name:"toggling",active:pg,apis:gg,state:(kd=!1,{init:function(){var n=ce(kd);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(kd)},readState:function(){return n.get()}}}})}),yg=function(){var n=function(n,t){t.stop(),zo(n)};return[Xo(uo(),n),Xo(bo(),n),$o(Ge()),$o(Je())]},xg=function(n){return Uo(X([n.map((function(n){return or((function(t,e){n(t),e.stop()}))})).toArray(),yg()]))},wg=function(n){(rc(n.element).isNone()||ug.isFocused(n))&&(ug.isFocused(n)||ug.focus(n),Ho(n,"alloy.item-hover",{item:n}))},Sg=function(n){Ho(n,"alloy.item-focus",{item:n})},kg=o("alloy.item-hover"),Cg=o("alloy.item-focus"),Og=[Pt("data"),Pt("components"),Pt("dom"),Qt("hasSubmenu",!1),Xt("toggling"),Pf("itemBehaviours",[bg,ug,Jm,Ff]),Qt("ignoreFocus",!1),Qt("domModification",{}),ca("builder",(function(n){return{dom:n.dom,domModification:l(l({},n.domModification),{attributes:l(l(l({role:n.toggling.isSome()?"menuitemcheckbox":"menuitem"},n.domModification.attributes),{"aria-haspopup":n.hasSubmenu}),n.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Hf(n.itemBehaviours,[n.toggling.fold(bg.revoke,(function(n){return bg.config(l({aria:{mode:"checked"}},n))})),ug.config({ignore:n.ignoreFocus,stopMousedown:n.ignoreFocus,onFocus:function(n){Sg(n)}}),Jm.config({mode:"execution"}),Ff.config({store:{mode:"memory",initialValue:n.data}}),tg("item-type-events",m(yg(),[Xo(Ze(),wg),Xo(vo(),ug.focus)]))]),components:n.components,eventOrder:n.eventOrder}})),Qt("eventOrder",{})],_g=[Pt("dom"),Pt("components"),ca("builder",(function(n){return{dom:n.dom,components:n.components,events:Uo([Qo(vo())])}}))],Tg=o("item-widget"),Eg=o([cl({name:"widget",overrides:function(n){return{behaviours:qa([Ff.config({store:{mode:"manual",getValue:function(t){return n.data},setValue:t}})])}}})]),Dg=[Pt("uid"),Pt("data"),Pt("components"),Pt("dom"),Qt("autofocus",!1),Qt("ignoreFocus",!1),Pf("widgetBehaviours",[Ff,ug,Jm]),Qt("domModification",{}),Dl(Eg()),ca("builder",(function(n){var t=xl(Tg(),n,Eg()),e=wl(Tg(),n,t.internals()),o=function(t){return Sl(t,n,"widget").map((function(n){return Jm.focusIn(n),n}))},r=function(t,e){return Nl(e.event.target)?b.none():n.autofocus?(e.setSource(t.element),b.none()):b.none()};return{dom:n.dom,components:e,domModification:n.domModification,events:Uo([or((function(n,t){o(n).each((function(n){t.stop()}))})),Xo(Ze(),wg),Xo(vo(),(function(t,e){n.autofocus?o(t):ug.focus(t)}))]),behaviours:Hf(n.widgetBehaviours,[Ff.config({store:{mode:"memory",initialValue:n.data}}),ug.config({ignore:n.ignoreFocus,onFocus:function(n){Sg(n)}}),Jm.config({mode:"special",focusIn:n.autofocus?function(n){o(n)}:Za(),onLeft:r,onRight:r,onEscape:function(t,e){return ug.isFocused(t)||n.autofocus?n.autofocus?(e.setSource(t.element),b.none()):b.none():(ug.focus(t),b.some(!0))}})])}}))],Bg=Tt("type",{widget:Dg,item:Og,separator:_g}),Ag=o([ll({factory:{sketch:function(n){var t=Ct("menu.spec item",Bg,n);return t.builder(t)}},name:"items",unit:"item",defaults:function(n,t){return t.hasOwnProperty("uid")?t:l(l({},t),{uid:ti("item")})},overrides:function(n,t){return{type:t.type,ignoreFocus:n.fakeFocus,domModification:{classes:[n.markers.item]}}}})]),Mg=o([Pt("value"),Pt("items"),Pt("dom"),Pt("components"),Qt("eventOrder",{}),If("menuBehaviours",[nd,Ff,Ul,Jm]),Zt("movement",{mode:"menu",moveOnTab:!0},Tt("mode",{grid:[fa(),ca("config",(function(n,t){return{mode:"flatgrid",selector:"."+n.markers.item,initSize:{numColumns:t.initSize.numColumns,numRows:t.initSize.numRows},focusManager:n.focusManager}}))],matrix:[ca("config",(function(n,t){return{mode:"matrix",selectors:{row:t.rowSelector,cell:"."+n.markers.item},focusManager:n.focusManager}})),Pt("rowSelector")],menu:[Qt("moveOnTab",!0),ca("config",(function(n,t){return{mode:"menu",selector:"."+n.markers.item,moveOnTab:t.moveOnTab,focusManager:n.focusManager}}))]})),Ht("markers",Zu()),Qt("fakeFocus",!1),Qt("focusManager",wd()),ra("onHighlight")]),Fg=o("alloy.menu-focus"),Ig=Pl({name:"Menu",configFields:Mg(),partFields:Ag(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Vf(n.menuBehaviours,[nd.config({highlightClass:n.markers.selectedItem,itemClass:n.markers.item,onHighlight:n.onHighlight}),Ff.config({store:{mode:"memory",initialValue:n.value}}),Ul.config({find:b.some}),Jm.config(n.movement.config(n,n.movement))]),events:Uo([Xo(Cg(),(function(n,t){var e=t.event;n.getSystem().getByDom(e.target).each((function(e){nd.highlight(n,e),t.stop(),Ho(n,Fg(),{menu:n,item:e})}))})),Xo(kg(),(function(n,t){var e=t.event.item;nd.highlight(n,e)}))]),components:t,eventOrder:n.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Rg=function(n,t,e,o){return En(e,o).bind((function(o){return En(n,o).bind((function(o){var r=Rg(n,t,e,o);return b.some([o].concat(r))}))})).getOr([])},Vg=function(n,t){var e={};wn(n,(function(n,t){z(n,(function(n){e[n]=t}))}));var o=t,r=kn(t,(function(n,t){return{k:n,v:t}})),i=Sn(r,(function(n,t){return[t].concat(Rg(e,o,r,t))}));return Sn(e,(function(n){return En(i,n).getOr([n])}))},Pg=function(n){return"prepared"===n.type?b.some(n.menu):b.none()},Hg={init:function(){var n=ce({}),t=ce({}),e=ce({}),o=ce(b.none()),r=ce({}),i=function(t,e,o){return u(t).bind((function(r){return function(t){return _n(n.get(),(function(n,e){return n===t}))}(t).bind((function(n){return e(n).map((function(n){return{triggeredMenu:r,triggeringItem:n,triggeringPath:o}}))}))}))},u=function(n){return a(n).bind(Pg)},a=function(n){return En(t.get(),n)},c=function(t){return En(n.get(),t)};return{setMenuBuilt:function(n,e){var o;t.set(l(l({},t.get()),((o={})[n]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(b.some(i)),n.set(a),t.set(u),r.set(c);var s=Vg(c,a);e.set(s)},expand:function(t){return En(n.get(),t).map((function(n){var o=En(e.get(),t).getOr([]);return[n].concat(o)}))},refresh:function(n){return En(e.get(),n)},collapse:function(n){return En(e.get(),n).bind((function(n){return n.length>1?b.some(n.slice(1)):b.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(n){var t=r.get();return K(yn(t),n)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return t.get()},clear:function(){n.set({}),t.set({}),e.set({}),o.set(b.none())},isClear:function(){return o.get().isNone()},getTriggeringPath:function(n,t){var r=L(c(n).toArray(),(function(n){return u(n).isSome()}));return En(e.get(),n).bind((function(n){var e=J(r.concat(n));return function(n){for(var t=[],e=0;e<n.length;e++){var o=n[e];if(!o.isSome())return b.none();t.push(o.getOrDie())}return b.some(t)}(Y(e,(function(n,r){return i(n,t,e.slice(0,r+1)).fold((function(){return o.get().is(n)?[]:[b.none()]}),(function(n){return[b.some(n)]}))})))}))}}},extractPreparedMenu:Pg},zg=o("collapse-item"),Ng=Vl({name:"TieredMenu",configFields:[aa("onExecute"),aa("onEscape"),ua("onOpenMenu"),ua("onOpenSubmenu"),ra("onRepositionMenu"),ra("onCollapseMenu"),Qt("highlightImmediately",!0),Ut("data",[Pt("primary"),Pt("menus"),Pt("expansions")]),Qt("fakeFocus",!1),ra("onHighlight"),ra("onHover"),ta(),Pt("dom"),Qt("navigateOnHover",!0),Qt("stayInDom",!1),If("tmenuBehaviours",[Jm,nd,Ul,ng]),Qt("eventOrder",{})],apis:{collapseMenu:function(n,t){n.collapseMenu(t)},highlightPrimary:function(n,t){n.highlightPrimary(t)},repositionMenus:function(n,t){n.repositionMenus(t)}},factory:function(n,e){var o,r=ce(b.none()),i=Hg.init(),u=function(t){var e=function(t,e,o){return Sn(o,(function(o,r){var i=function(){return Ig.sketch(l(l({},o),{value:r,markers:n.markers,fakeFocus:n.fakeFocus,onHighlight:n.onHighlight,focusManager:n.fakeFocus?Sd():wd()}))};return r===e?{type:"prepared",menu:t.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(t,n.data.primary,n.data.menus),o=c();return i.setContents(n.data.primary,e,n.data.expansions,o),i.getPrimary()},a=function(n){return Ff.getValue(n).value},c=function(t){return Sn(n.data.menus,(function(n,t){return Y(n.items,(function(n){return"separator"===n.type?[]:[n.data.value]}))}))},f=function(n,t){nd.highlight(n,t),nd.getHighlighted(t).orThunk((function(){return nd.getFirst(t)})).each((function(t){No(n,t.element,vo())}))},d=function(n,t){return Hl(H(t,(function(t){return n.lookupMenu(t).bind((function(n){return"prepared"===n.type?b.some(n.menu):b.none()}))})))},m=function(t,e,o){var r=d(e,e.otherMenus(o));z(r,(function(e){Ai(e.element,[n.markers.backgroundMenu]),n.stayInDom||ng.remove(t,e)}))},g=function(t,e){var o=function(t){return r.get().getOrThunk((function(){var e={},o=hs(t.element,"."+n.markers.item),i=L(o,(function(n){return"true"===Hr(n,"aria-haspopup")}));return z(i,(function(n){t.getSystem().getByDom(n).each((function(n){var t=a(n);e[t]=n}))})),r.set(b.some(e)),e}))}(t);wn(o,(function(n,t){var o=I(e,t);Pr(n.element,"aria-expanded",o)}))},p=function(t,e,o){return b.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return b.none();var i=r.menu,u=d(e,o.slice(1));return z(u,(function(t){_i(t.element,n.markers.backgroundMenu)})),Fi(i.element)||ng.append(t,au(i)),Ai(i.element,[n.markers.backgroundMenu]),f(t,i),m(t,e,o),b.some(i)}))}))};!function(n){n[n.HighlightSubmenu=0]="HighlightSubmenu",n[n.HighlightParent=1]="HighlightParent"}(o||(o={}));var h=function(t,e,r){void 0===r&&(r=o.HighlightSubmenu);var u=a(e);return i.expand(u).bind((function(u){return g(t,u),b.from(u[0]).bind((function(a){return i.lookupMenu(a).bind((function(c){var s=function(n,t,e){if("notbuilt"===e.type){var o=n.getSystem().build(e.nbMenu());return i.setMenuBuilt(t,o),o}return e.menu}(t,a,c);return Fi(s.element)||ng.append(t,au(s)),n.onOpenSubmenu(t,e,s,J(u)),r===o.HighlightSubmenu?(nd.highlightFirst(s),p(t,i,u)):(nd.dehighlightAll(s),b.some(e))}))}))}))},v=function(t,e){var o=a(e);return i.collapse(o).bind((function(o){return g(t,o),p(t,i,o).map((function(o){return n.onCollapseMenu(t,e,o),o}))}))},y=function(t){return function(e,o){return Lu(o.getSource(),"."+n.markers.item).bind((function(n){return e.getSystem().getByDom(n).toOptional().bind((function(n){return t(e,n).map(s)}))}))}},x=Uo([Xo(Fg(),(function(n,t){var e=t.event.item;i.lookupItem(a(e)).each((function(){var e=t.event.menu;nd.highlight(n,e);var o=a(t.event.item);i.refresh(o).each((function(t){return m(n,i,t)}))}))})),or((function(e,r){var i=r.event.target;e.getSystem().getByDom(i).each((function(r){0===a(r).indexOf("collapse-item")&&v(e,r),h(e,r,o.HighlightSubmenu).fold((function(){n.onExecute(e,r)}),t)}))})),nr((function(t,e){u(t).each((function(e){ng.append(t,au(e)),n.onOpenMenu(t,e),n.highlightImmediately&&f(t,e)}))}))].concat(n.navigateOnHover?[Xo(kg(),(function(t,e){var r=e.event.item;!function(n,t){var e=a(t);i.refresh(e).bind((function(t){return g(n,t),p(n,i,t)}))}(t,r),h(t,r,o.HighlightParent),n.onHover(t,r)}))]:[])),w=function(n){return nd.getHighlighted(n).bind(nd.getHighlighted)},S={collapseMenu:function(n){w(n).each((function(t){v(n,t)}))},highlightPrimary:function(n){i.getPrimary().each((function(t){f(n,t)}))},repositionMenus:function(t){i.getPrimary().bind((function(n){return w(t).bind((function(n){var t=a(n),e=Tn(i.getMenus()),o=Hl(H(e,Hg.extractPreparedMenu));return i.getTriggeringPath(t,(function(n){return function(n,t,e){return en(t,(function(n){if(!n.getSystem().isConnected())return b.none();var t=nd.getCandidates(n);return W(t,(function(n){return a(n)===e}))}))}(0,o,n)}))})).map((function(t){return{primary:n,triggeringPath:t}}))})).fold((function(){(function(n){return b.from(n.components()[0]).filter((function(n){return"menu"===Hr(n.element,"role")}))})(t).each((function(e){n.onRepositionMenu(t,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;n.onRepositionMenu(t,o,r)}))}};return{uid:n.uid,dom:n.dom,markers:n.markers,behaviours:Vf(n.tmenuBehaviours,[Jm.config({mode:"special",onRight:y((function(n,t){return Nl(t.element)?b.none():h(n,t,o.HighlightSubmenu)})),onLeft:y((function(n,t){return Nl(t.element)?b.none():v(n,t)})),onEscape:y((function(t,e){return v(t,e).orThunk((function(){return n.onEscape(t,e).map((function(){return t}))}))})),focusIn:function(n,t){i.getPrimary().each((function(t){No(n,t.element,vo())}))}}),nd.config({highlightClass:n.markers.selectedMenu,itemClass:n.markers.menu}),Ul.config({find:function(n){return nd.getHighlighted(n)}}),ng.config({})]),eventOrder:n.eventOrder,apis:S,events:x}},extraApis:{tieredData:function(n,t,e){return{primary:n,menus:t,expansions:e}},singleData:function(n,t){return{primary:n,menus:Xn(n,t),expansions:{}}},collapseItem:function(n){return{value:qr(zg()),meta:{text:n}}}}}),Lg=Vl({name:"InlineView",configFields:[Pt("lazySink"),ra("onShow"),ra("onHide"),Kt("onEscape"),If("inlineBehaviours",[mf,Ff,nc]),$t("fireDismissalEventInstead",[Qt("event",Do())]),$t("fireRepositionEventInstead",[Qt("event",Bo())]),Qt("getRelated",b.none),Qt("isExtraPart",c),Qt("eventOrder",b.none)],factory:function(n,t){var e=function(n,t,e,r){o(n,t,e,(function(){return r.map((function(n){return Au(n)}))}))},o=function(t,e,o,r){var i=n.lazySink(t).getOrDie();mf.openWhileCloaked(t,o,(function(){return Ws.positionWithinBounds(i,e,t,r())})),Ff.setValue(t,b.some({mode:"position",anchor:e,getBounds:r}))},r=function(t,e,o,r){var i=function(n,t,e,o,r){var i=function(){return n.lazySink(t)},u="horizontal"===o.type?{layouts:{onLtr:function(){return Na()},onRtl:function(){return La()}}}:{},a=function(n){return function(n){return 2===n.length}(n)?u:{}};return Ng.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return mf.close(t),n.onEscape.map((function(n){return n(t)})),b.some(!0)},onExecute:function(){return b.some(!0)},onOpenMenu:function(n,t){Ws.positionWithinBounds(i().getOrDie(),e,t,r())},onOpenSubmenu:function(n,t,e,o){var r=i().getOrDie();Ws.position(r,l({anchor:"submenu",item:t},a(o)),e)},onRepositionMenu:function(n,t,o){var u=i().getOrDie();Ws.positionWithinBounds(u,e,t,r()),z(o,(function(n){var t=a(n.triggeringPath);Ws.position(u,l({anchor:"submenu",item:n.triggeringItem},t),n.triggeredMenu)}))}})}(n,t,e,o,r);mf.open(t,i),Ff.setValue(t,b.some({mode:"menu",menu:i}))},i=function(t){mf.isOpen(t)&&Ff.getValue(t).each((function(e){switch(e.mode){case"menu":mf.getState(t).each((function(n){Ng.repositionMenus(n)}));break;case"position":var o=n.lazySink(t).getOrDie();Ws.positionWithinBounds(o,e.anchor,t,e.getBounds())}}))},u={setContent:function(n,t){mf.setContent(n,t)},showAt:function(n,t,o){e(n,t,o,b.none())},showWithin:e,showWithinBounds:o,showMenuAt:function(n,t,e){r(n,t,e,(function(){return b.none()}))},showMenuWithinBounds:r,hide:function(n){mf.isOpen(n)&&(Ff.setValue(n,b.none()),mf.close(n))},getContent:function(n){return mf.getState(n)},reposition:i,isOpen:mf.isOpen};return{uid:n.uid,dom:n.dom,behaviours:Vf(n.inlineBehaviours,[mf.config({isPartOf:function(t,e,o){return Wu(e,o)||function(t,e){return n.getRelated(t).exists((function(n){return Wu(n,e)}))}(t,o)},getAttachPoint:function(t){return n.lazySink(t).getOrDie()},onOpen:function(t){n.onShow(t)},onClose:function(t){n.onHide(t)}}),Ff.config({store:{mode:"memory",initialValue:b.none()}}),nc.config({channels:l(l({},bf(l({isExtraPart:t.isExtraPart},n.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),xf(l(l({},n.fireRepositionEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})),{doReposition:i})))})]),eventOrder:n.eventOrder,apis:u}},apis:{showAt:function(n,t,e,o){n.showAt(t,e,o)},showWithin:function(n,t,e,o,r){n.showWithin(t,e,o,r)},showWithinBounds:function(n,t,e,o,r){n.showWithinBounds(t,e,o,r)},showMenuAt:function(n,t,e,o){n.showMenuAt(t,e,o)},showMenuWithinBounds:function(n,t,e,o,r){n.showMenuWithinBounds(t,e,o,r)},hide:function(n,t){n.hide(t)},isOpen:function(n,t){return n.isOpen(t)},getContent:function(n,t){return n.getContent(t)},setContent:function(n,t,e){n.setContent(t,e)},reposition:function(n,t){n.reposition(t)}}}),jg=function(n){return n.x},Ug=function(n,t){return n.x+n.width/2-t.width/2},Wg=function(n,t){return n.x+n.width-t.width},Gg=function(n){return n.y},Xg=function(n,t){return n.y+n.height-t.height},Yg=function(n,t,e){return la(Wg(n,t),Xg(n,t),e.innerSoutheast(),ha(),wa(n,{right:0,bottom:3}),"layout-inner-se")},qg=function(n,t,e){return la(jg(n),Xg(n,t),e.innerSouthwest(),pa(),wa(n,{left:1,bottom:3}),"layout-inner-sw")},Jg=function(n,t,e){return la(Wg(n,t),Gg(n),e.innerNortheast(),ga(),wa(n,{right:0,top:2}),"layout-inner-ne")},Kg=function(n,t,e){return la(jg(n),Gg(n),e.innerNorthwest(),ma(),wa(n,{left:1,top:2}),"layout-inner-nw")},$g=function(n,t,e){return la(Ug(n,t),Gg(n),e.innerNorth(),va(),wa(n,{top:2}),"layout-inner-n")},Qg=function(n,t,e){return la(Ug(n,t),Xg(n,t),e.innerSouth(),ba(),wa(n,{bottom:3}),"layout-inner-s")},Zg=tinymce.util.Tools.resolve("tinymce.util.Delay"),np=Vl({name:"Button",factory:function(n){var t=xg(n.action),e=n.dom.tag,o=function(t){return En(n.dom,"attributes").bind((function(n){return En(n,t)}))};return{uid:n.uid,dom:n.dom,components:n.components,events:t,behaviours:Hf(n.buttonBehaviours,[ug.config({}),Jm.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var n=o("type").getOr("button"),t=o("role").map((function(n){return{role:n}})).getOr({});return l({type:n},t)}return{role:o("role").getOr("button")}}()},eventOrder:n.eventOrder}},configFields:[Qt("uid",void 0),Pt("dom"),Qt("components",[]),Pf("buttonBehaviours",[ug,Jm]),Xt("action"),Xt("role"),Qt("eventOrder",{})]}),tp=function(n){var t=function(n){return void 0!==n.uid}(n)&&Bn(n,"uid")?n.uid:ti("memento");return{get:function(n){return n.getSystem().getByUid(t).getOrDie()},getOpt:function(n){return n.getSystem().getByUid(t).toOptional()},asSpec:function(){return l(l({},n),{uid:t})}}},ep=function(n){return b.from(n()["temporary-placeholder"]).getOr("!not found!")},op=function(n,t){return b.from(t()[n.toLowerCase()]).getOrThunk((function(){return ep(t)}))},rp=function(n,t){return en(n,(function(n){return b.from(t()[n.toLowerCase()])})).getOrThunk((function(){return ep(t)}))},ip={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},up=Vl({name:"Notification",factory:function(n){var t=tp({dom:{tag:"p",innerHtml:n.translationProvider(n.text)},behaviours:qa([ng.config({})])}),e=function(n){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+n+"%"}}}},o=function(n){return{dom:{tag:"div",classes:["tox-text"],innerHtml:n+"%"}}},r=tp({dom:{tag:"div",classes:n.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:qa([ng.config({})])}),i={updateProgress:function(n,t){n.getSystem().isConnected()&&r.getOpt(n).each((function(n){ng.set(n,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(t)]},o(t)])}))},updateText:function(n,e){if(n.getSystem().isConnected()){var o=t.get(n);ng.set(o,[ou(e)])}}},u=X([n.icon.toArray(),n.level.toArray(),n.level.bind((function(n){return b.from(ip[n])})).toArray()]),a=tp(np.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:op("close",n.iconProvider),attributes:{"aria-label":n.translationProvider("Close")}}}],action:function(t){n.onAction(t)}})),c=[{dom:{tag:"div",classes:["tox-notification__icon"],innerHtml:rp(u,n.iconProvider)}},{dom:{tag:"div",classes:["tox-notification__body"]},components:[t.asSpec()],behaviours:qa([ng.config({})])}];return{uid:n.uid,dom:{tag:"div",attributes:{role:"alert"},classes:n.level.map((function(n){return["tox-notification","tox-notification--in","tox-notification--"+n]})).getOr(["tox-notification","tox-notification--in"])},behaviours:qa([ug.config({}),tg("notification-events",[Xo(no(),(function(n){a.getOpt(n).each(ug.focus)}))])]),components:c.concat(n.progress?[r.asSpec()]:[]).concat(n.closeButton?[a.asSpec()]:[]),apis:i}},configFields:[Xt("level"),Pt("progress"),Pt("icon"),Pt("onAction"),Pt("text"),Pt("iconProvider"),Pt("translationProvider"),oe("closeButton",!0)],apis:{updateProgress:function(n,t,e){n.updateProgress(t,e)},updateText:function(n,t,e){n.updateText(t,e)}}});function ap(n,t,e){var o=t.backstage;return{open:function(n,r){var i=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),u=function(){r(),Lg.hide(c)},a=uu(up.sketch({text:n.text,level:I(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:b.from(n.icon),closeButton:!i,onAction:u,iconProvider:o.shared.providers.icons,translationProvider:o.shared.providers.translate})),c=uu(Lg.sketch(l({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:t.backstage.shared.getSink,fireDismissalEventInstead:{}},o.shared.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));return e.add(c),n.timeout>0&&Zg.setTimeout((function(){u()}),n.timeout),{close:u,moveTo:function(n,t){Lg.showAt(c,{anchor:"makeshift",x:n,y:t},au(a))},moveRel:function(n,e){if("banner"!==e){var o=function(n){switch(n){case"bc-bc":return Qg;case"tc-tc":return $g;case"tc-bc":return Ma;case"bc-tc":default:return Fa}}(e),r={anchor:"node",root:Ii(),node:b.some(fe.fromDom(n)),layouts:{onRtl:function(){return[o]},onLtr:function(){return[o]}}};Lg.showAt(c,r,au(a))}else Lg.showAt(c,t.backstage.shared.anchors.banner(),au(a))},text:function(n){up.updateText(a,n)},settings:n,getEl:function(){return a.element.dom},progressBar:{value:function(n){up.updateProgress(a,n)}}}},close:function(n){n.close()},reposition:function(n){!function(n){z(n,(function(n){return n.moveTo(0,0)}))}(n),function(n){n.length>0&&(Z(n).each((function(n){return n.moveRel(null,"banner")})),z(n,(function(t,e){e>0&&t.moveRel(n[e-1].getEl(),"bc-tc")})))}(n)},getArgs:function(n){return n.settings}}}var cp,sp=function(n,t){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];null!==e&&clearTimeout(e),e=setTimeout((function(){n.apply(null,o),e=null}),t)}}},fp=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),lp=function(n,t,e,o,r){var i=fp(n,(function(t){return function(n,t){return n.isBlock(t)||I(["BR","IMG","HR","INPUT"],t.nodeName)||"false"===n.getContentEditable(t)}(n,t)}));return b.from(i.backwards(t,e,o,r))},dp=function(n,t){return mp(fe.fromDom(n.selection.getNode())).getOrThunk((function(){var e=fe.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',n.getDoc());return Dr(e,fe.fromDom(t.extractContents())),t.insertNode(e.dom),gr(e).each((function(n){return n.dom.normalize()})),function(n){return ps(n,gs)}(e).map((function(t){n.selection.setCursorLocation(t.dom,function(n){return"img"===rr(n)?1:ds(n).fold((function(){return hr(n).length}),(function(n){return n.length}))}(t))})),e}))},mp=function(n){return Lu(n,"[data-mce-autocompleter]")},gp=function(n){return n.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},pp=function(n){return""!==n&&-1!=="  \f\n\r\t\v".indexOf(n)},hp=function(n,t){return n.substring(t.length)},vp=function(n,t,e,o){if(void 0===o&&(o=0),!(r=t).collapsed||3!==r.startContainer.nodeType)return b.none();var r,i=n.getParent(t.startContainer,n.isBlock)||n.getRoot();return lp(n,t.startContainer,t.startOffset,(function(n,t,o){return function(n,t,e){var o;for(o=t-1;o>=0;o--){var r=n.charAt(o);if(pp(r))return b.none();if(r===e)break}return b.some(o)}(o,t,e).getOr(t)}),i).bind((function(n){var r=t.cloneRange();if(r.setStart(n.container,n.offset),r.setEnd(t.endContainer,t.endOffset),r.collapsed)return b.none();var i=gp(r);return 0!==i.lastIndexOf(e)||hp(i,e).length<o?b.none():b.some({text:hp(i,e),range:r,triggerChar:e})}))},bp=function(n,t,e,o){return void 0===o&&(o=0),mp(fe.fromDom(t.startContainer)).fold((function(){return vp(n,t,e,o)}),(function(t){var o=n.createRng();o.selectNode(t.dom);var r=gp(o);return b.some({range:o,text:hp(r,e),triggerChar:e})}))},yp=function(n,t){t.on("keypress compositionend",n.onKeypress.throttle),t.on("remove",n.onKeypress.cancel);var e=function(n,t){Ho(n,eo(),{raw:t})};t.on("keydown",(function(t){var o=function(){return n.getView().bind(nd.getHighlighted)};8===t.which&&n.onKeypress.throttle(t),n.isActive()&&(27===t.which&&n.cancelIfNecessary(),n.isMenuOpen()?13===t.which?(o().each(zo),t.preventDefault()):40===t.which?(o().fold((function(){n.getView().each(nd.highlightFirst)}),(function(n){e(n,t)})),t.preventDefault(),t.stopImmediatePropagation()):37!==t.which&&38!==t.which&&39!==t.which||o().each((function(n){e(n,t),t.preventDefault(),t.stopImmediatePropagation()})):13!==t.which&&38!==t.which&&40!==t.which||n.cancelIfNecessary())})),t.on("NodeChange",(function(t){n.isActive()&&!n.isProcessingAction()&&mp(fe.fromDom(t.element)).isNone()&&n.cancelIfNecessary()}))},xp=tinymce.util.Tools.resolve("tinymce.util.Promise"),wp=function(n,t){return{container:n,offset:t}},Sp=function(n){if(function(n){return 3===n.nodeType}(n))return wp(n,n.data.length);var t=n.childNodes;return t.length>0?Sp(t[t.length-1]):wp(n,t.length)},kp=function(n,t){var e=n.childNodes;return e.length>0&&t<e.length?kp(e[t],0):e.length>0&&function(n){return 1===n.nodeType}(n)&&e.length===t?Sp(e[e.length-1]):wp(n,t)},Cp=function(n){return function(t){var e=kp(t.startContainer,t.startOffset);return!function(n,t){return lp(n,t.container,t.offset,(function(n,t){return 0===t?-1:t}),n.getRoot()).filter((function(n){var t=n.container.data.charAt(n.offset-1);return!pp(t)})).isSome()}(n,e)}},Op=function(n,t){var e=t(),o=n.selection.getRng();return function(n,t,e){return en(e.triggerChars,(function(e){return bp(n,t,e)}))}(n.dom,o,e).bind((function(e){return _p(n,t,e)}))},_p=function(n,t,e,o){void 0===o&&(o={});var r=t(),i=n.selection.getRng().startContainer.nodeValue,u=L(r.lookupByChar(e.triggerChar),(function(t){return e.text.length>=t.minChars&&t.matches.getOrThunk((function(){return Cp(n.dom)}))(e.range,i,e.text)}));if(0===u.length)return b.none();var a=xp.all(H(u,(function(n){return n.fetch(e.text,n.maxResults,o).then((function(t){return{matchText:e.text,items:t,columns:n.columns,onAction:n.onAction,highlightOn:n.highlightOn}}))})));return b.some({lookupData:a,context:e})},Tp=at([Nt("type"),Jt("text")]),Ep=at([Qt("type","autocompleteitem"),Qt("active",!1),Qt("disabled",!1),Qt("meta",{}),Nt("value"),Jt("text"),Jt("icon")]),Dp=at([Nt("type"),Nt("ch"),ne("minChars",1),Qt("columns",1),ne("maxResults",10),Kt("matches"),jt("fetch"),jt("onAction"),ie("highlightOn",[],At)]),Bp=[oe("disabled",!1),Jt("tooltip"),Jt("icon"),Jt("text"),re("onSetup",(function(){return t}))],Ap=at([Nt("type"),jt("onAction")].concat(Bp)),Mp=function(n){return St("toolbarbutton",Ap,n)},Fp=[oe("active",!1)].concat(Bp),Ip=at(Fp.concat([Nt("type"),jt("onAction")])),Rp=function(n){return St("ToggleButton",Ip,n)},Vp=[re("predicate",c),ee("scope","node",["node","editor"]),ee("position","selection",["node","selection","line"])],Pp=Bp.concat([Qt("type","contextformbutton"),Qt("primary",!1),jt("onAction"),ae("original",r)]),Hp=Fp.concat([Qt("type","contextformbutton"),Qt("primary",!1),jt("onAction"),ae("original",r)]),zp=Bp.concat([Qt("type","contextformbutton")]),Np=Fp.concat([Qt("type","contextformtogglebutton")]),Lp=Tt("type",{contextformbutton:Pp,contextformtogglebutton:Hp}),jp=at([Qt("type","contextform"),re("initValue",(function(){return""})),Jt("label"),Gt("commands",Lp),Yt("launch",Tt("type",{contextformbutton:zp,contextformtogglebutton:Np}))].concat(Vp)),Up=at([Qt("type","contexttoolbar"),Nt("items")].concat(Vp)),Wp=function(n){var t=n.ui.registry.getAll().popups,e=Sn(t,(function(n){return(t=n,St("Autocompleter",Dp,t)).fold((function(n){throw new Error(Ot(n))}),(function(n){return n}));var t})),o=function(n){var t={};return z(n,(function(n){t[n]={}})),yn(t)}(On(e,(function(n){return n.ch}))),r=Tn(e);return{dataset:e,triggerChars:o,lookupByChar:function(n){return L(r,(function(t){return t.ch===n}))}}};!function(n){n[n.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",n[n.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(cp||(cp={}));var Gp,Xp=cp,Yp="tox-menu-nav__js",qp="tox-collection__item",Jp={normal:Yp,color:"tox-swatch"},Kp="tox-collection__item-label",$p="tox-collection__item--active",Qp=function(n){return En(Jp,n).getOr(Yp)},Zp=function(n){return"color"===n?"tox-swatches":"tox-menu"},nh=function(n){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Zp(n),tieredMenu:"tox-tiered-menu"}},th=function(n){var t=nh(n);return{backgroundMenu:t.backgroundMenu,selectedMenu:t.selectedMenu,menu:t.menu,selectedItem:t.selectedItem,item:Qp(n)}},eh=function(n,t,e){var o=nh(e);return{tag:"div",classes:X([[o.menu,"tox-menu-"+t+"-column"],n?[o.hasIcons]:[]])}},oh=[Ig.parts.items({})],rh=function(n,t,e){var o=nh(e);return{dom:{tag:"div",classes:X([[o.tieredMenu]])},markers:th(e)}},ih=function(n,t){return function(e){var o=P(e,t);return H(o,(function(t){return{dom:n,components:t}}))}},uh=function(n,t){var e=[],o=[];return z(n,(function(n,r){t(n,r)?(o.length>0&&e.push(o),o=[],Dn(n.dom,"innerHtml")&&o.push(n)):o.push(n)})),o.length>0&&e.push(o),H(e,(function(n){return{dom:{tag:"div",classes:["tox-collection__group"]},components:n}}))},ah=function(n,t,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===n?["tox-collection--list"]:["tox-collection--grid"])},components:[Ig.parts.items({preprocess:function(e){return"auto"!==n&&n>1?ih({tag:"div",classes:["tox-collection__group"]},n)(e):uh(e,(function(n,e){return"separator"===t[e].type}))}})]}},ch=function(n){return R(n,(function(n){return"icon"in n&&void 0!==n.icon}))},sh=function(n){return console.error(Ot(n)),console.log(n),b.none()},fh=function(n,t,e,o,r){var i,u=(i=e,{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Ig.parts.items({preprocess:function(n){return uh(n,(function(n,t){return"separator"===i[t].type}))}})]});return{value:n,dom:u.dom,components:u.components,items:e}},lh=function(n,t,e,o,i){var u;return"color"===i?{value:n,dom:(u=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Ig.parts.items({preprocess:"auto"!==n?ih({tag:"div",classes:["tox-swatches__row"]},n):r})]}]}}(o)).dom,components:u.components,items:e}:"normal"===i&&"auto"===o?{value:n,dom:(u=ah(o,e)).dom,components:u.components,items:e}:"normal"===i&&1===o?{value:n,dom:(u=ah(1,e)).dom,components:u.components,items:e}:"normal"===i?{value:n,dom:(u=ah(o,e)).dom,components:u.components,items:e}:"listpreview"===i&&"auto"!==o?{value:n,dom:(u=function(n){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Ig.parts.items({preprocess:ih({tag:"div",classes:["tox-collection__group"]},n)})]}}(o)).dom,components:u.components,items:e}:{value:n,dom:eh(t,o,i),components:oh,items:e}},dh=[Nt("type"),Nt("src"),Jt("alt"),ie("classes",[],At)],mh=at(dh),gh=[Nt("type"),Nt("text"),Jt("name"),ie("classes",["tox-collection__item-label"],At)],ph=at(gh),hh=yt((function(){return _t("type",{cardimage:mh,cardtext:ph,cardcontainer:vh})})),vh=at([Nt("type"),te("direction","horizontal"),te("align","left"),te("valign","middle"),Gt("items",hh)]),bh=[oe("disabled",!1),Jt("text"),Jt("shortcut"),gt("value","value",jn((function(){return qr("menuitem-value")})),Et()),Qt("meta",{})],yh=at([Nt("type"),Jt("label"),Gt("items",hh),re("onSetup",(function(){return t})),re("onAction",t)].concat(bh)),xh=at([Nt("type"),oe("active",!1),Jt("icon")].concat(bh)),wh=at([Nt("type"),Lt("fancytype",["inserttable","colorswatch"]),re("onAction",t)]),Sh=at([Nt("type"),re("onSetup",(function(){return t})),re("onAction",t),Jt("icon")].concat(bh)),kh=at([Nt("type"),jt("getSubmenuItems"),re("onSetup",(function(){return t})),Jt("icon")].concat(bh)),Ch=at([Nt("type"),Jt("icon"),oe("active",!1),re("onSetup",(function(){return t})),jt("onAction")].concat(bh)),Oh=function(n,t,e){var o=hs(n.element,"."+e);if(o.length>0){var r=G(o,(function(n){var e=n.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>t})).getOr(o.length);return b.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return b.none()},_h=function(n,t){return qa([tg(n,t)])},Th=function(n){return _h(qr("unnamed-events"),n)},Eh=qr("tooltip.exclusive"),Dh=qr("tooltip.show"),Bh=qr("tooltip.hide"),Ah=function(n,t,e){n.getSystem().broadcastOn([Eh],{})},Mh=Object.freeze({__proto__:null,hideAllExclusive:Ah,setComponents:function(n,t,e,o){e.getTooltip().each((function(n){n.getSystem().isConnected()&&ng.set(n,o)}))}}),Fh=Object.freeze({__proto__:null,events:function(n,t){var e=function(e){t.getTooltip().each((function(o){Qs(o),n.onHide(e,o),t.clearTooltip()})),t.clearTimer()};return Uo(X([[Xo(Dh,(function(e){t.resetTimer((function(){!function(e){if(!t.isShowing()){Ah(e);var o=n.lazySink(e).getOrDie(),r=e.getSystem().build({dom:n.tooltipDom,components:n.tooltipComponents,events:Uo("normal"===n.mode?[Xo(Ze(),(function(n){Po(e,Dh)})),Xo($e(),(function(n){Po(e,Bh)}))]:[]),behaviours:qa([ng.config({})])});t.setTooltip(r),Js(o,r),n.onShow(e,r),Ws.position(o,n.anchor(e),r)}}(e)}),n.delay)})),Xo(Bh,(function(o){t.resetTimer((function(){e(o)}),n.delay)})),Xo(po(),(function(n,t){var o=t;o.universal||I(o.channels,Eh)&&e(n)})),tr((function(n){e(n)}))],"normal"===n.mode?[Xo(no(),(function(n){Po(n,Dh)})),Xo(mo(),(function(n){Po(n,Bh)})),Xo(Ze(),(function(n){Po(n,Dh)})),Xo($e(),(function(n){Po(n,Bh)}))]:[Xo(Ro(),(function(n,t){Po(n,Dh)})),Xo(Vo(),(function(n){Po(n,Bh)}))]]))}}),Ih=[Pt("lazySink"),Pt("tooltipDom"),Qt("exclusive",!0),Qt("tooltipComponents",[]),Qt("delay",300),ee("mode","normal",["normal","follow-highlight"]),Qt("anchor",(function(n){return{anchor:"hotspot",hotspot:n,layouts:{onLtr:o([Fa,Ma,Ea,Ba,Da,Aa]),onRtl:o([Fa,Ma,Ea,Ba,Da,Aa])}}})),ra("onHide"),ra("onShow")],Rh=Ka({fields:Ih,name:"tooltipping",active:Fh,state:Object.freeze({__proto__:null,init:function(){var n=ce(b.none()),t=ce(b.none()),e=function(){n.get().each((function(n){clearTimeout(n)}))},r=o("not-implemented");return li({getTooltip:function(){return t.get()},isShowing:function(){return t.get().isSome()},setTooltip:function(n){t.set(b.some(n))},clearTooltip:function(){t.set(b.none())},clearTimer:e,resetTimer:function(t,o){e(),n.set(b.some(setTimeout((function(){t()}),o)))},readState:r})}}),apis:Mh}),Vh=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),Ph=tinymce.util.Tools.resolve("tinymce.util.I18n"),Hh=["input","button","textarea","select"],zh=function(n,t,e){(t.disabled()?Gh:Xh)(n,t)},Nh=function(n,t){return!0===t.useNative&&I(Hh,rr(n.element))},Lh=function(n){Pr(n.element,"disabled","disabled")},jh=function(n){Lr(n.element,"disabled")},Uh=function(n){Pr(n.element,"aria-disabled","true")},Wh=function(n){Pr(n.element,"aria-disabled","false")},Gh=function(n,t,e){t.disableClass.each((function(t){_i(n.element,t)})),(Nh(n,t)?Lh:Uh)(n),t.onDisabled(n)},Xh=function(n,t,e){t.disableClass.each((function(t){Ei(n.element,t)})),(Nh(n,t)?jh:Wh)(n),t.onEnabled(n)},Yh=function(n,t){return Nh(n,t)?function(n){return Nr(n.element,"disabled")}(n):function(n){return"true"===Hr(n.element,"aria-disabled")}(n)},qh=Object.freeze({__proto__:null,enable:Xh,disable:Gh,isDisabled:Yh,onLoad:zh,set:function(n,t,e,o){(o?Gh:Xh)(n,t)}}),Jh=Object.freeze({__proto__:null,exhibit:function(n,t){return mi({classes:t.disabled()?t.disableClass.toArray():[]})},events:function(n,t){return Uo([Wo(ho(),(function(t,e){return Yh(t,n)})),Wa(n,t,zh)])}}),Kh=[re("disabled",c),Qt("useNative",!0),Xt("disableClass"),ra("onDisabled"),ra("onEnabled")],$h=Ka({fields:Kh,name:"disabling",active:Jh,apis:qh}),Qh=tinymce.util.Tools.resolve("tinymce.EditorManager"),Zh=function(n){return n.getParam("height",Math.max(n.getElement().offsetHeight,200))},nv=function(n){return n.getParam("width",Vh.DOM.getStyle(n.getElement(),"width"))},tv=function(n){return b.from(n.getParam("min_width")).filter(E)},ev=function(n){return b.from(n.getParam("min_height")).filter(E)},ov=function(n){return b.from(n.getParam("max_width")).filter(E)},rv=function(n){return b.from(n.getParam("max_height")).filter(E)},iv=function(n){return!1!==n.getParam("menubar",!0,"boolean")},uv=function(n){var t=n.getParam("toolbar",!0),e=!0===t,o=w(t),r=k(t)&&t.length>0;return!cv(n)&&(r||o||e)},av=function(n){var t=V(9,(function(t){return n.getParam("toolbar"+(t+1),!1,"string")})),e=L(t,(function(n){return"string"==typeof n}));return e.length>0?b.some(e):b.none()},cv=function(n){return av(n).fold((function(){return n.getParam("toolbar",[],"string[]").length>0}),s)};!function(n){n.default="wrap",n.floating="floating",n.sliding="sliding",n.scrolling="scrolling"}(Gp||(Gp={}));var sv,fv=function(n){return n.getParam("toolbar_mode","","string")};!function(n){n.auto="auto",n.top="top",n.bottom="bottom"}(sv||(sv={}));var lv,dv,mv=function(n){return n.getParam("toolbar_location",sv.auto,"string")},gv=function(n){return mv(n)===sv.bottom},pv=function(n){var t=function(n){return n.getParam("fixed_toolbar_container","","string")}(n);return t.length>0&&n.inline?Nu(Ii(),t):b.none()},hv=function(n){return n.inline&&pv(n).isSome()},vv=function(n){return pv(n).getOrThunk((function(){return Sr(wr(fe.fromDom(n.getElement())))}))},bv=function(n){return n.inline&&!iv(n)&&!uv(n)&&!cv(n)},yv=function(n){return(n.getParam("toolbar_sticky",!1,"boolean")||n.inline)&&!hv(n)&&!bv(n)},xv=function(n){var t=n.getParam("menu");return t?Sn(t,(function(n){return l(l({},n),{items:n.items})})):{}},wv=function(n){return n.getParam("menubar")},Sv=function(n){return n.getParam("anchor_top","#top")},kv=function(n){return n.getParam("anchor_bottom","#bottom")},Cv=at([(lv="readonly",Ht(lv,Mt))]),Ov=function(n,t){var e=n.outerContainer.element;t&&(n.mothership.broadcastOn([gf()],{target:e}),n.uiMothership.broadcastOn([gf()],{target:e})),n.mothership.broadcastOn(["silver.readonly"],{readonly:t}),n.uiMothership.broadcastOn(["silver.readonly"],{readonly:t})},_v=function(n,t){n.on("init",(function(){n.mode.isReadOnly()&&Ov(t,!0)})),n.on("SwitchMode",(function(){return Ov(t,n.mode.isReadOnly())})),function(n){return n.getParam("readonly",!1,"boolean")}(n)&&n.setMode("readonly")},Tv=function(){var n;return nc.config({channels:(n={},n["silver.readonly"]={schema:Cv,onReceive:function(n,t){$h.set(n,t.readonly)}},n)})},Ev=function(n){return $h.config({disabled:n,disableClass:"tox-collection__item--state-disabled"})},Dv=function(n){return $h.config({disabled:n})},Bv=function(n){return $h.config({disabled:n,disableClass:"tox-tbtn--disabled"})},Av=function(n){return $h.config({disabled:n,disableClass:"tox-tbtn--disabled",useNative:!1})},Mv=function(n,t){var e=n.getApi(t);return function(n){n(e)}},Fv=function(n,t){return nr((function(e){Mv(n,e)((function(e){var o=n.onSetup(e);T(o)&&t.set(o)}))}))},Iv=function(n,t){return tr((function(e){return Mv(n,e)(t.get())}))},Rv=function(n,t){return or((function(e,o){Mv(n,e)(n.onAction),n.triggersSubmenu||t!==Xp.CLOSE_ON_EXECUTE||(e.getSystem().isConnected()&&Po(e,xo()),o.stop())}))},Vv=((dv={})[ho()]=["disabling","alloy.base.behaviour","toggling","item-events"],dv),Pv=function(n){return Y(n,(function(n){return n.toArray()}))},Hv=function(n,e,o,r){var i=ce(t);return{type:"item",dom:e.dom,components:Pv(e.optComponents),data:n.data,eventOrder:Vv,hasSubmenu:n.triggersSubmenu,itemBehaviours:qa([tg("item-events",[Rv(n,o),Fv(n,i),Iv(n,i)]),Ev((function(){return n.disabled||r.isDisabled()})),Tv(),ng.config({})].concat(n.itemBehaviours))}},zv=function(n){return{value:n.value,meta:l({text:n.text.getOr("")},n.meta)}},Nv=tinymce.util.Tools.resolve("tinymce.Env"),Lv=function(n){var t=Nv.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=n.split("+"),o=H(e,(function(n){var e=n.toLowerCase().trim();return Dn(t,e)?t[e]:n}));return Nv.mac?o.join(""):o.join("+")},jv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-icon"],innerHtml:n}}},Uv=function(n){return{dom:{tag:"div",classes:[Kp]},components:[ou(Ph.translate(n))]}},Wv=function(n,t){return{dom:{tag:"div",classes:t,innerHtml:n}}},Gv=function(n,t){return{dom:{tag:"div",classes:[Kp]},components:[{dom:{tag:n.tag,styles:n.styles},components:[ou(Ph.translate(t))]}]}},Xv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:Lv(n)}}},Yv=function(n){return{dom:{tag:"div",classes:["tox-collection__item-checkmark"],innerHtml:op("checkmark",n)}}},qv=function(n,t){var e=t.map((function(n){return{attributes:{title:Ph.translate(n)}}})).getOr({});return l({tag:"div",classes:[Yp,qp].concat(n?["tox-collection__item-icon-rtl"]:[])},e)},Jv=["list-num-default","list-num-lower-alpha","list-num-lower-greek","list-num-lower-roman","list-num-upper-alpha","list-num-upper-roman"],Kv=["list-bull-circle","list-bull-default","list-bull-square"],$v=function(n,t,e,o){void 0===o&&(o=b.none());var r,u=Ph.isRtl()&&n.iconContent.exists((function(n){return I(Kv,n)})),a=(r=n.iconContent,r.map((function(n){return Ph.isRtl()&&I(Jv,n)?n+"-rtl":n}))).map((function(n){return function(n,t,e){return b.from(t()[n.toLowerCase()]).or(e).getOrThunk((function(){return ep(t)}))}(n,t.icons,o)})),c=b.from(n.meta).fold((function(){return Uv}),(function(n){return Dn(n,"style")?i(Gv,n.style):Uv}));return"color"===n.presets?function(n,t,e,o){var r,i;return{dom:(r=e.getOr(""),i={tag:"div",attributes:n.map((function(n){return{title:o.translate(n)}})).getOr({}),classes:["tox-swatch"]},l(l({},i),"custom"===t?{tag:"button",classes:m(i.classes,["tox-swatches__picker-btn"]),innerHtml:r}:"remove"===t?{classes:m(i.classes,["tox-swatch--remove"]),innerHtml:r}:{attributes:l(l({},i.attributes),{"data-mce-color":t}),styles:{"background-color":t}})),optComponents:[]}}(n.ariaLabel,n.value,a,t):function(n,t,e,o,r){var i=e?t.or(b.some("")).map(jv):b.none(),u=n.checkMark,a=n.htmlContent.fold((function(){return n.textContent.map(o)}),(function(n){return b.some(Wv(n,[Kp]))}));return{dom:qv(r,n.ariaLabel),optComponents:[i,a,n.shortcutContent.map(Xv),u,n.caret]}}(n,a,e,c,u)},Qv=function(n,t){return En(n,"tooltipWorker").map((function(n){return[Rh.config({lazySink:t.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(n){return{anchor:"submenu",item:n,overrides:{maxHeightFunction:Cc}}},mode:"follow-highlight",onShow:function(t,e){n((function(n){Rh.setComponents(t,[ru({element:fe.fromDom(n)})])}))}})]})).getOr([])},Zv=function(n,t){var e=function(n){return Vh.DOM.encode(n)}(Ph.translate(n));if(t.length>0){var o=new RegExp(function(n){return n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(t),"gi");return e.replace(o,(function(n){return'<span class="tox-autocompleter-highlight">'+n+"</span>"}))}return e},nb=function(n,t){return H(n,(function(n){switch(n.type){case"cardcontainer":return function(n,t){return{dom:{tag:"div",classes:["tox-collection__item-container","vertical"===n.direction?"tox-collection__item-container--column":"tox-collection__item-container--row","left"===n.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right",function(){switch(n.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:t}}(n,nb(n.items,t));case"cardimage":return function(n,t,e){return{dom:{tag:"img",classes:t,attributes:{src:n,alt:e.getOr("")}}}}(n.src,n.classes,n.alt);case"cardtext":var e=n.name.exists((function(n){return I(t.cardText.highlightOn,n)}))?b.from(t.cardText.matchText).getOr(""):"";return Wv(Zv(n.text,e),n.classes)}}))},tb=pl(Tg(),Eg()),eb=function(n){return{value:n}},ob=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,rb=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,ib=function(n){return ob.test(n)||rb.test(n)},ub=function(n){var t=function(n){return{value:n.value.replace(ob,(function(n,t,e,o){return t+t+e+e+o+o}))}}(n),e=rb.exec(t.value);return null===e?["FFFFFF","FF","FF","FF"]:e},ab=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},cb=function(n){var t=ab(n.red)+ab(n.green)+ab(n.blue);return eb(t)},sb=Math.min,fb=Math.max,lb=Math.round,db=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,mb=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,gb=function(n,t,e,o){return{red:n,green:t,blue:e,alpha:o}},pb=function(n){var t=parseInt(n,10);return t.toString()===n&&t>=0&&t<=255},hb=function(n){var t,e,o,r=(n.hue||0)%360,i=n.saturation/100,u=n.value/100;if(i=fb(0,sb(i,1)),u=fb(0,sb(u,1)),0===i)return t=e=o=lb(255*u),gb(t,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:t=c,e=s,o=0;break;case 1:t=s,e=c,o=0;break;case 2:t=0,e=c,o=s;break;case 3:t=0,e=s,o=c;break;case 4:t=s,e=0,o=c;break;case 5:t=c,e=0,o=s;break;default:t=e=o=0}return t=lb(255*(t+f)),e=lb(255*(e+f)),o=lb(255*(o+f)),gb(t,e,o,1)},vb=function(n){var t=ub(n),e=parseInt(t[1],16),o=parseInt(t[2],16),r=parseInt(t[3],16);return gb(e,o,r,1)},bb=function(n,t,e,o){var r=parseInt(n,10),i=parseInt(t,10),u=parseInt(e,10),a=parseFloat(o);return gb(r,i,u,a)},yb=function(n){return"rgba("+n.red+","+n.green+","+n.blue+","+n.alpha+")"},xb=gb(255,0,0,1),wb=function(n,t){return n.fire("ResizeContent",t)},Sb=tinymce.util.Tools.resolve("tinymce.util.LocalStorage");var kb,Cb="choiceitem",Ob=[{type:Cb,text:"Light Green",value:"#BFEDD2"},{type:Cb,text:"Light Yellow",value:"#FBEEB8"},{type:Cb,text:"Light Red",value:"#F8CAC6"},{type:Cb,text:"Light Purple",value:"#ECCAFA"},{type:Cb,text:"Light Blue",value:"#C2E0F4"},{type:Cb,text:"Green",value:"#2DC26B"},{type:Cb,text:"Yellow",value:"#F1C40F"},{type:Cb,text:"Red",value:"#E03E2D"},{type:Cb,text:"Purple",value:"#B96AD9"},{type:Cb,text:"Blue",value:"#3598DB"},{type:Cb,text:"Dark Turquoise",value:"#169179"},{type:Cb,text:"Orange",value:"#E67E23"},{type:Cb,text:"Dark Red",value:"#BA372A"},{type:Cb,text:"Dark Purple",value:"#843FA1"},{type:Cb,text:"Dark Blue",value:"#236FA1"},{type:Cb,text:"Light Gray",value:"#ECF0F1"},{type:Cb,text:"Medium Gray",value:"#CED4D9"},{type:Cb,text:"Gray",value:"#95A5A6"},{type:Cb,text:"Dark Gray",value:"#7E8C8D"},{type:Cb,text:"Navy Blue",value:"#34495E"},{type:Cb,text:"Black",value:"#000000"},{type:Cb,text:"White",value:"#ffffff"}],_b=function(n){void 0===n&&(n=10);var t,e=Sb.getItem("tinymce-custom-colors"),o=w(e)?JSON.parse(e):[],r=n-(t=o).length<0?t.slice(0,n):t,i=function(n){r.splice(n,1)};return{add:function(t){(function(n,t){var e=F(n,t);return-1===e?b.none():b.some(e)})(r,t).each(i),r.unshift(t),r.length>n&&r.pop(),Sb.setItem("tinymce-custom-colors",JSON.stringify(r))},state:function(){return r.slice(0)}}}(10),Tb=function(n){return!1!==n.getParam("custom_colors")},Eb=function(n){var t=function(n){return n.getParam("color_map")}(n);return void 0!==t?function(n){var t=[],e=document.createElement("canvas");e.height=1,e.width=1;for(var o=e.getContext("2d"),r=function(n,t){var e=t/255;return("0"+Math.round(n*e+255*(1-e)).toString(16)).slice(-2).toUpperCase()},i=function(n){if(/^[0-9A-Fa-f]{6}$/.test(n))return"#"+n.toUpperCase();o.clearRect(0,0,e.width,e.height),o.fillStyle="#FFFFFF",o.fillStyle=n,o.fillRect(0,0,1,1);var t=o.getImageData(0,0,1,1).data,i=t[0],u=t[1],a=t[2],c=t[3];return"#"+r(i,c)+r(u,c)+r(a,c)},u=0;u<n.length;u+=2)t.push({text:n[u+1],value:i(n[u]),type:"choiceitem"});return t}(t):Ob},Db=function(n){_b.add(n)},Bb=function(n){return function(n,t){return n.getParam("color_cols",t,"number")}(n,function(n){return Math.max(5,Math.ceil(Math.sqrt(n)))}(Eb(n).length))},Ab=function(n,t,e,o){"custom"===e?Pb(n)((function(e){e.each((function(e){Db(e),n.execCommand("mceApplyTextcolor",t,e),o(e)}))}),"#000000"):"remove"===e?(o(""),n.execCommand("mceRemoveTextcolor",t)):(o(e),n.execCommand("mceApplyTextcolor",t,e))},Mb=function(n,t){return n.concat(H(_b.state(),(function(n){return{type:Cb,text:n,value:n}})).concat(function(n){var t={type:"choiceitem",text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return n?[t,{type:"choiceitem",text:"Custom color",icon:"color-picker",value:"custom"}]:[t]}(t)))},Fb=function(n,t){return function(e){e(Mb(n,t))}},Ib=function(n,t,e){var o,r;o="forecolor"===t?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color",r=e,n.setIconFill(o,r),n.setIconStroke(o,r)},Rb=function(n,e,o,r,i){n.ui.registry.addSplitButton(e,{tooltip:r,presets:"color",icon:"forecolor"===e?"text-color":"highlight-bg-color",select:function(t){return b.from(function(n,t){var e;return n.dom.getParents(n.selection.getStart(),(function(n){var o;(o=n.style["forecolor"===t?"color":"background-color"])&&(e=e||o)})),e}(n,o)).bind((function(n){return function(n){if("transparent"===n)return b.some(gb(0,0,0,0));var t=db.exec(n);if(null!==t)return b.some(bb(t[1],t[2],t[3],"1"));var e=mb.exec(n);return null!==e?b.some(bb(e[1],e[2],e[3],e[4])):b.none()}(n).map((function(n){var e=cb(n).value;return ve(t.toLowerCase(),e)}))})).getOr(!1)},columns:Bb(n),fetch:Fb(Eb(n),Tb(n)),onAction:function(e){null!==i.get()&&Ab(n,o,i.get(),t)},onItemAction:function(t,r){Ab(n,o,r,(function(t){i.set(t),function(n,t){n.fire("TextColorChange",t)}(n,{name:e,color:t})}))},onSetup:function(t){null!==i.get()&&Ib(t,e,i.get());var o=function(n){n.name===e&&Ib(t,n.name,n.color)};return n.on("TextColorChange",o),function(){n.off("TextColorChange",o)}}})},Vb=function(n,e,o,r){n.ui.registry.addNestedMenuItem(e,{text:r,icon:"forecolor"===e?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(e){Ab(n,o,e.value,t)}}]}})},Pb=function(n){return function(e,o){var r={colorpicker:o},i=function(n){return function(t){var e=t.getData();n(b.from(e.colorpicker)),t.close()}}(e);n.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(n,t){"hex-valid"===t.name&&(t.value?n.enable("ok"):n.disable("ok"))},onSubmit:i,onClose:t,onCancel:function(){e(b.none())}})}},Hb=function(n,t,e,o,r,i,u,a){var c=ch(t),s=zb(t,e,o,"color"!==r?"normal":"color",i,u,a);return lh(n,c,s,o,r)},zb=function(n,e,o,r,i,u,a){return Hl(H(n,(function(c){return"choiceitem"===c.type?(s=c,St("choicemenuitem",xh,s)).fold(sh,(function(s){return b.some(function(n,e,o,r,i,u,a,c){void 0===c&&(c=!0);var s=$v({presets:o,textContent:e?n.text:b.none(),htmlContent:b.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:e?n.shortcut:b.none(),checkMark:e?b.some(Yv(a.icons)):b.none(),caret:b.none(),value:n.value},a,c);return In(Hv({data:zv(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){bg.set(n,t)},isActive:function(){return bg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},onAction:function(t){return r(n.value)},onSetup:function(n){return n.setActive(i),t},triggersSubmenu:!1,itemBehaviours:[]},s,u,a),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:n.active}})}(s,1===o,r,e,u(c.value),i,a,ch(n)))})):b.none();var s})))},Nb=function(n,t){var e=th(t);return 1===n?{mode:"menu",moveOnTab:!0}:"auto"===n?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===t?"tox-swatches__row":"tox-collection__group")}},Lb=qr("cell-over"),jb=qr("cell-execute"),Ub=function(n,t,e){var o,r=function(e){return Ho(e,jb,{row:n,col:t})},i=function(n,t){t.stop(),r(n)};return uu({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:qa([tg("insert-table-picker-cell",[Xo(Ze(),ug.focus),Xo(ho(),r),Xo(uo(),i),Xo(bo(),i)]),bg.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),ug.config({onFocus:function(e){return Ho(e,Lb,{row:n,col:t})}})])})},Wb=function(n){return Y(n,(function(n){return H(n,au)}))},Gb=function(n,t){return ou(t+1+"x"+(n+1))},Xb={inserttable:function(n){var t=qr("size-label"),e=function(n,t,e){for(var o=[],r=0;r<t;r++){for(var i=[],u=0;u<e;u++)i.push(Ub(r,u,n));o.push(i)}return o}(t,10,10),o=tp({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:t}},components:[ou("0x0")],behaviours:qa([ng.config({})])});return{type:"widget",data:{value:qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[tb.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:Wb(e).concat(o.asSpec()),behaviours:qa([tg("insert-table-picker",[Ko(Lb,(function(n,t,r){var i=r.event.row,u=r.event.col;!function(n,t,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)bg.set(n[i][u],i<=t&&u<=e)}(e,i,u,10,10),ng.set(o.get(n),[Gb(i,u)])})),Ko(jb,(function(t,e,o){n.onAction({numRows:o.event.row+1,numColumns:o.event.col+1}),Po(t,xo())}))]),Jm.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(n,t){var e=Mb(t.colorinput.getColors(),t.colorinput.hasCustomColors()),o=t.colorinput.getColorCols(),r=Hb(qr("menu-value"),e,(function(t){n.onAction({value:t})}),o,"color",Xp.CLOSE_ON_EXECUTE,c,t.shared.providers),i=l(l({},r),{markers:th("color"),movement:Nb(o,"color")});return{type:"widget",data:{value:qr("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[tb.widget(Ig.sketch(i))]}}},Yb=function(n,e,r,i,u,a,c,s){void 0===s&&(s=!0);var f=$v({presets:i,textContent:b.none(),htmlContent:r?n.text.map((function(n){return Zv(n,e)})):b.none(),ariaLabel:n.text,iconContent:n.icon,shortcutContent:b.none(),checkMark:b.none(),caret:b.none(),value:n.value},c.providers,s,n.icon);return Hv({data:zv(n),disabled:n.disabled,getApi:o({}),onAction:function(t){return u(n.value,n.meta)},onSetup:o(t),triggersSubmenu:!1,itemBehaviours:Qv(n.meta,c)},f,a,c.providers)},qb=function(n){var t=n.text.fold((function(){return{}}),(function(n){return{innerHtml:n}}));return{type:"separator",dom:l({tag:"div",classes:[qp,"tox-collection__group-heading"]},t),components:[]}},Jb=function(n,t,e,o){void 0===o&&(o=!0);var r=$v({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:b.none(),ariaLabel:n.text,caret:b.none(),checkMark:b.none(),shortcutContent:n.shortcut},e,o);return Hv({data:zv(n),getApi:function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},disabled:n.disabled,onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e)},Kb=function(n,e,o,r,i){void 0===r&&(r=!0),void 0===i&&(i=!1);var u,a=i?(u=o.icons,{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:op("chevron-down",u)}}):function(n){return{dom:{tag:"div",classes:["tox-collection__item-caret"],innerHtml:op("chevron-right",n)}}}(o.icons),c=$v({presets:"normal",iconContent:n.icon,textContent:n.text,htmlContent:b.none(),ariaLabel:n.text,caret:b.some(a),checkMark:b.none(),shortcutContent:n.shortcut},o,r);return Hv({data:zv(n),getApi:function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},disabled:n.disabled,onAction:t,onSetup:n.onSetup,triggersSubmenu:!0,itemBehaviours:[]},c,e,o)},$b=function(n,t,e,o){void 0===o&&(o=!0);var r=$v({iconContent:n.icon,textContent:n.text,htmlContent:b.none(),ariaLabel:n.text,checkMark:b.some(Yv(e.icons)),caret:b.none(),shortcutContent:n.shortcut,presets:"normal",meta:n.meta},e,o);return In(Hv({data:zv(n),disabled:n.disabled,getApi:function(n){return{setActive:function(t){bg.set(n,t)},isActive:function(){return bg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,t,e),{toggling:{toggleClass:"tox-collection__item--enabled",toggleOnExecute:!1,selected:n.active}})},Qb=function(n,t){return function(n,t){return Object.prototype.hasOwnProperty.call(n,t)?b.some(n[t]):b.none()}(Xb,n.fancytype).map((function(e){return e(n,t)}))},Zb=function(n,t,e,o){var r={dom:qv(!1,n.label),optComponents:[b.some({dom:{tag:"div",classes:["tox-collection__item-container","tox-collection__item-container--row"]},components:nb(n.items,o)})]};return Hv({data:zv(l({text:b.none()},n)),disabled:n.disabled,getApi:function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){$h.set(n,t),z(hs(n.element,"*"),(function(e){n.getSystem().getByDom(e).each((function(n){n.hasConfigured($h)&&$h.set(n,t)}))}))}}},onAction:n.onAction,onSetup:n.onSetup,triggersSubmenu:!1,itemBehaviours:b.from(o.itemBehaviours).getOr([])},r,t,e.providers)};!function(n){n[n.ContentFocus=0]="ContentFocus",n[n.UiFocus=1]="UiFocus"}(kb||(kb={}));var ny=function(n,t,e,o,r){var i,u=e.shared.providers,a=function(n){return r?l(l({},n),{shortcut:b.none(),icon:n.text.isSome()?b.none():n.icon}):n};switch(n.type){case"menuitem":return(i=n,St("menuitem",Sh,i)).fold(sh,(function(n){return b.some(Jb(a(n),t,u,o))}));case"nestedmenuitem":return function(n){return St("nestedmenuitem",kh,n)}(n).fold(sh,(function(n){return b.some(Kb(a(n),t,u,o,r))}));case"togglemenuitem":return function(n){return St("togglemenuitem",Ch,n)}(n).fold(sh,(function(n){return b.some($b(a(n),t,u,o))}));case"separator":return function(n){return St("separatormenuitem",Tp,n)}(n).fold(sh,(function(n){return b.some(qb(n))}));case"fancymenuitem":return function(n){return St("fancymenuitem",wh,n)}(n).fold(sh,(function(n){return Qb(a(n),e)}));default:return console.error("Unknown item in general menu",n),b.none()}},ty=function(n,t,e,o,r,i,u){var a=1===o,c=!a||ch(n);return Hl(H(n,(function(n){switch(n.type){case"separator":return(o=n,St("Autocompleter.Separator",Tp,o)).fold(sh,(function(n){return b.some(qb(n))}));case"cardmenuitem":return function(n){return St("cardmenuitem",yh,n)}(n).fold(sh,(function(n){return b.some(Zb(l(l({},n),{onAction:function(t){n.onAction(t),e(n.value,n.meta)}}),r,i,{itemBehaviours:Qv(n.meta,i),cardText:{matchText:t,highlightOn:u}}))}));case"autocompleteitem":default:return function(n){return St("Autocompleter.Item",Ep,n)}(n).fold(sh,(function(n){return b.some(Yb(n,t,a,"normal",e,r,i,c))}))}var o})))},ey=function(n,t,e,o,r){var i=ch(t),u=Hl(H(t,(function(n){var t=function(n){return ny(n,e,o,function(n){return r?!n.hasOwnProperty("text"):i}(n),r)};return"nestedmenuitem"===n.type&&n.getSubmenuItems().length<=0?t(l(l({},n),{disabled:!0})):t(n)})));return(r?fh:lh)(n,i,u,1,"normal")},oy=function(n){return Ng.singleData(n.value,n)},ry=function(n,t){var e=ce(b.none()),o=ce(!1),r=uu(Lg.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:qa([tg("dismissAutocompleter",[Xo(Do(),(function(){return a()}))])]),lazySink:t.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Lg.hide(r)},a=function(){if(i()){var t=e.get().map((function(n){return n.element}));mp(t.getOr(fe.fromDom(n.selection.getNode()))).each(Fr),u(),e.set(b.none()),o.set(!1)}},c=Vn((function(){return Wp(n)})),s=function(t,e,o,i){t.matchLength=e.text.length;var u=en(o,(function(n){return b.from(n.columns)})).getOr(1);Lg.showAt(r,{anchor:"node",root:fe.fromDom(n.getBody()),node:b.from(t.element)},Ig.sketch(function(n,t,e,o){var r=e===kb.ContentFocus?Sd():wd(),i=Nb(t,o),u=th(o);return{dom:n.dom,components:n.components,items:n.items,value:n.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===kb.ContentFocus,focusManager:r,menuBehaviours:Th("auto"!==t?[]:[nr((function(n,t){Oh(n,4,u.item).each((function(t){var e=t.numColumns,o=t.numRows;Jm.setGridSize(n,o,e)}))}))])}}(lh("autocompleter-value",!0,i,u,"normal"),u,kb.ContentFocus,"normal"))),Lg.getContent(r).each(nd.highlightFirst)},f=function(r){(function(t){return e.get().map((function(e){return bp(n.dom,n.selection.getRng(),e.triggerChar).bind((function(e){return _p(n,c,e,t)}))})).getOrThunk((function(){return Op(n,c)}))})(r).fold(a,(function(r){!function(t){if(!i()){var r=dp(n,t.range);e.set(b.some({triggerChar:t.triggerChar,element:r,matchLength:t.text.length})),o.set(!1)}}(r.context),r.lookupData.then((function(i){e.get().map((function(e){var c,l,d,m=r.context;if(e.triggerChar===m.triggerChar){var g=(c=m.triggerChar,d=en(l=i,(function(n){return b.from(n.columns)})).getOr(1),Y(l,(function(e){var r=e.items;return ty(r,e.matchText,(function(t,r){var i=n.selection.getRng();bp(n.dom,i,c).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(n){var i=n.range,c={hide:function(){a()},reload:function(n){u(),f(n)}};o.set(!0),e.onAction(c,i,t,r),o.set(!1)}))}),d,Xp.BUBBLE_TO_SANDBOX,t,e.highlightOn)})));g.length>0?s(e,m,i,g):m.text.length-e.matchLength>=10?a():u()}}))}))}))},l={onKeypress:sp((function(n){27!==n.which&&f()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Lg.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Lg.getContent(r)}};!1===n.hasPlugin("rtc")&&yp(l,n)},iy=s,uy=function(n,t,e){return function(n,t,e,o){return wu(n,t,e,o,!1)}(n,t,iy,e)},ay=function(n,t,e){return function(n,t,e,o){return wu(n,t,e,o,!0)}(n,t,iy,e)},cy=xu,sy=function(n,t,e){return Lu(n,t,e).isSome()},fy=function(n,t){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){n.apply(null,o),e=null}),t)}}},ly=function(n){var t=n.raw;return void 0===t.touches||1!==t.touches.length?b.none():b.some(t.touches[0])},dy=function(n){var t=ce(b.none()),e=ce(!1),o=fy((function(t){n.triggerEvent(yo(),t),e.set(!0)}),400),r=Yn([{key:Ge(),value:function(n){return ly(n).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:n.target};o.schedule(n),e.set(!1),t.set(b.some(i))})),b.none()}},{key:Xe(),value:function(n){return o.cancel(),ly(n).each((function(n){t.get().each((function(e){(function(n,t){var e=Math.abs(n.clientX-t.x),o=Math.abs(n.clientY-t.y);return e>5||o>5})(n,e)&&t.set(b.none())}))})),b.none()}},{key:Ye(),value:function(r){o.cancel();return t.get().filter((function(n){return Re(n.target,r.target)})).map((function(t){return e.get()?(r.prevent(),!1):n.triggerEvent(bo(),r)}))}}]);return{fireIfReady:function(n,t){return En(r,t).bind((function(t){return t(n)}))}}},my=function(){return Me().browser.isFirefox()},gy=ut([jt("triggerEvent"),Qt("stopBackspace",!0)]),py=function(n,t){var e=Ct("Getting GUI events settings",gy,t),o=dy(e),r=H(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(t){return uy(n,t,(function(n){o.fireIfReady(n,t).each((function(t){t&&n.kill()})),e.triggerEvent(t,n)&&n.kill()}))})),i=ce(b.none()),u=uy(n,"paste",(function(n){o.fireIfReady(n,"paste").each((function(t){t&&n.kill()})),e.triggerEvent("paste",n)&&n.kill(),i.set(b.some(setTimeout((function(){e.triggerEvent(go(),n)}),0)))})),a=uy(n,"keydown",(function(n){e.triggerEvent("keydown",n)?n.kill():!0===e.stopBackspace&&function(n){return n.raw.which===td[0]&&!I(["input","textarea"],rr(n.target))&&!sy(n.target,'[contenteditable="true"]')}(n)&&n.prevent()})),c=function(n,t){return my()?ay(n,"focus",t):uy(n,"focusin",t)}(n,(function(n){e.triggerEvent("focusin",n)&&n.kill()})),s=ce(b.none()),f=function(n,t){return my()?ay(n,"blur",t):uy(n,"focusout",t)}(n,(function(n){e.triggerEvent("focusout",n)&&n.kill(),s.set(b.some(setTimeout((function(){e.triggerEvent(mo(),n)}),0)))}));return{unbind:function(){z(r,(function(n){n.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.get().each(clearTimeout),s.get().each(clearTimeout)}}},hy=function(n,t){var e=En(n,"target").getOr(t);return ce(e)},vy=An([{stopped:[]},{resume:["element"]},{complete:[]}]),by=function(n,t,e,o,r,i){var u=n(t,o),a=function(n,t){var e=ce(!1),o=ce(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:n,setSource:t.set,getSource:t.get}}(e,r);return u.fold((function(){return i.logEventNoHandlers(t,o),vy.complete()}),(function(n){var e=n.descHandler;return gi(e)(a),a.isStopped()?(i.logEventStopped(t,n.element,e.purpose),vy.stopped()):a.isCut()?(i.logEventCut(t,n.element,e.purpose),vy.complete()):gr(n.element).fold((function(){return i.logNoParent(t,n.element,e.purpose),vy.complete()}),(function(o){return i.logEventResponse(t,n.element,e.purpose),vy.resume(o)}))}))},yy=function(n,t,e,o,r,i){return by(n,t,e,o,r,i).fold(s,(function(o){return yy(n,t,e,o,r,i)}),c)},xy=function(n,e,o){var r=function(n){var e=ce(!1);return{stop:function(){e.set(!0)},cut:t,isStopped:e.get,isCut:c,event:n,setSource:a("Cannot set source of a broadcasted event"),getSource:a("Cannot get source of a broadcasted event")}}(e);return z(n,(function(n){var t=n.descHandler;gi(t)(r)})),r.isStopped()},wy=function(n,t,e,o,r){var i=hy(e,o);return yy(n,t,e,o,i,r)},Sy=function(){var n={};return{registerId:function(t,e,o){wn(o,(function(o,r){var u=void 0!==n[r]?n[r]:{};u[e]=function(n,t){return e=i.apply(void 0,[n.handler].concat(t)),o=n.purpose,{cHandler:e,purpose:o};var e,o}(o,t),n[r]=u}))},unregisterId:function(t){wn(n,(function(n,e){n.hasOwnProperty(t)&&delete n[t]}))},filterByType:function(t){return En(n,t).map((function(n){return On(n,(function(n,t){return function(n,t){return{id:n,descHandler:t}}(t,n)}))})).getOr([])},find:function(t,e,o){var r=En(n,e);return Ne(o,(function(n){return function(n,t){return ni(t).fold((function(){return b.none()}),(function(e){return n.bind((function(n){return En(n,e)})).map((function(n){return function(n,t){return{element:n,descHandler:t}}(t,n)}))}))}(r,n)}),t)}}},ky=function(){var n=Sy(),t={},e=function(n){var t=n.element;return ni(t).fold((function(){return function(n,t){var e=qr($r+n);return Zr(t,e),e}("uid-",n.element)}),(function(n){return n}))},o=function(e){ni(e.element).each((function(e){delete t[e],n.unregisterId(e)}))};return{find:function(t,e,o){return n.find(t,e,o)},filter:function(t){return n.filterByType(t)},register:function(r){var i=e(r);Bn(t,i)&&function(n,e){var r=t[e];if(r!==n)throw new Error('The tagId "'+e+'" is already used by: '+Wr(r.element)+"\nCannot use it for: "+Wr(n.element)+"\nThe conflicting element is"+(Fi(r.element)?" ":" not ")+"already in the DOM");o(n)}(r,i);var u=[r];n.registerId(u,i,r.events),t[i]=r},unregister:o,getById:function(n){return En(t,n)}}},Cy=Vl({name:"Container",factory:function(n){var t=n.dom,e=t.attributes,o=d(t,["attributes"]);return{uid:n.uid,dom:l({tag:"div",attributes:l({role:"presentation"},e)},o),components:n.components,behaviours:Rf(n.containerBehaviours),events:n.events,domModification:n.domModification,eventOrder:n.eventOrder}},configFields:[Qt("components",[]),If("containerBehaviours",[]),Qt("events",{}),Qt("domModification",{}),Qt("eventOrder",{})]}),Oy=function(n){var e=function(t){return gr(n.element).fold(s,(function(n){return Re(t,n)}))},r=ky(),i=function(n,t){return r.find(e,n,t)},u=py(n.element,{triggerEvent:function(n,t){return Ju(n,t.target,(function(e){return function(n,t,e,o){return wy(n,t,e,e.target,o)}(i,n,t,e)}))}}),a={debugInfo:o("real"),triggerEvent:function(n,t,e){Ju(n,t,(function(o){return wy(i,n,e,t,o)}))},triggerFocus:function(n,e){ni(n).fold((function(){ec(n)}),(function(o){Ju(lo(),n,(function(o){return function(n,t,e,o,r){var i=hy(e,o);by(n,t,e,o,i,r)}(i,lo(),{originator:e,kill:t,prevent:t,target:n},n,o),!1}))}))},triggerEscape:function(n,t){a.triggerEvent("keydown",n.element,t.event)},getByUid:function(n){return v(n)},getByDom:function(n){return b(n)},build:uu,addToGui:function(n){l(n)},removeFromGui:function(n){d(n)},addToWorld:function(n){c(n)},removeFromWorld:function(n){f(n)},broadcast:function(n){g(n)},broadcastOn:function(n,t){p(n,t)},broadcastEvent:function(n,t){h(n,t)},isConnected:s},c=function(n){n.connect(a),ar(n.element)||(r.register(n),z(n.components(),c),a.triggerEvent(So(),n.element,{target:n.element}))},f=function(n){ar(n.element)||(z(n.components(),f),r.unregister(n)),n.disconnect()},l=function(t){Js(n,t)},d=function(n){Qs(n)},m=function(n){var t=r.filter(po());z(t,(function(t){var e=t.descHandler;gi(e)(n)}))},g=function(n){m({universal:!0,data:n})},p=function(n,t){m({universal:!1,channels:n,data:t})},h=function(n,t){var e=r.filter(n);return xy(e,t)},v=function(n){return r.getById(n).fold((function(){return un.error(new Error('Could not find component with uid: "'+n+'" in system.'))}),un.value)},b=function(n){var t=ni(n).getOr("not found");return v(t)};return c(n),{root:n,element:n.element,destroy:function(){u.unbind(),Mr(n.element)},add:l,remove:d,getByUid:v,getByDom:b,addToWorld:c,removeFromWorld:f,broadcast:g,broadcastOn:p,broadcastEvent:h}},_y=o([Qt("prefix","form-field"),If("fieldBehaviours",[Ul,Ff])]),Ty=o([fl({schema:[Pt("dom")],name:"label"}),fl({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Pt("text")],name:"aria-descriptor"}),cl({factory:{sketch:function(n){var t=Gn(n,["factory"]);return n.factory.sketch(t)}},schema:[Pt("factory")],name:"field"})]),Ey=Pl({name:"FormField",configFields:_y(),partFields:Ty(),factory:function(n,t,e,o){var r=Vf(n.fieldBehaviours,[Ul.config({find:function(t){return Sl(t,n,"field")}}),Ff.config({store:{mode:"manual",getValue:function(n){return Ul.getCurrent(n).bind(Ff.getValue)},setValue:function(n,t){Ul.getCurrent(n).each((function(n){Ff.setValue(n,t)}))}}})]),i=Uo([nr((function(t,e){var o=Cl(t,n,["label","field","aria-descriptor"]);o.field().each((function(t){var e=qr(n.prefix);o.label().each((function(n){Pr(n.element,"for",e),Pr(t.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=qr(n.prefix);Pr(e.element,"id",o),Pr(t.element,"aria-describedby",o)}))}))}))]),u={getField:function(t){return Sl(t,n,"field")},getLabel:function(t){return Sl(t,n,"label")}};return{uid:n.uid,dom:n.dom,components:t,behaviours:r,events:i,apis:u}},apis:{getField:function(n,t){return n.getField(t)},getLabel:function(n,t){return n.getLabel(t)}}}),Dy=Object.freeze({__proto__:null,exhibit:function(n,t){return mi({attributes:Yn([{key:t.tabAttr,value:"true"}])})}}),By=[Qt("tabAttr","data-alloy-tabstop")],Ay=Ka({fields:By,name:"tabstopping",active:Dy}),My=tinymce.util.Tools.resolve("tinymce.html.Entities"),Fy=function(n,t,e,o){var r=Iy(n,t,e,o);return Ey.sketch(r)},Iy=function(n,t,e,o){return{dom:Ry(e),components:n.toArray().concat([t]),fieldBehaviours:qa(o)}},Ry=function(n){return{tag:"div",classes:["tox-form__group"].concat(n)}},Vy=function(n,t){return Ey.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}})},Py=qr("form-component-change"),Hy=qr("form-close"),zy=qr("form-cancel"),Ny=qr("form-action"),Ly=qr("form-submit"),jy=qr("form-block"),Uy=qr("form-unblock"),Wy=qr("form-tabchange"),Gy=qr("form-resize"),Xy=function(n,t){var e,o,i,u=n.label.map((function(n){return Vy(n,t)})),a=function(n){return function(t,e){Lu(e.event.target,"[data-collection-item-value]").each((function(o){n(t,e,o,Hr(o,"data-collection-item-value"))}))}},c=a((function(e,o,r,i){o.stop(),t.isDisabled()||Ho(e,Ny,{name:n.name,value:i})})),s=[Xo(Ze(),a((function(n,t,e){ec(e)}))),Xo(uo(),c),Xo(bo(),c),Xo(no(),a((function(n,t,e){Nu(n.element,"."+$p).each((function(n){Ei(n,$p)})),_i(e,$p)}))),Xo(to(),a((function(n){Nu(n.element,"."+$p).each((function(n){Ei(n,$p)}))}))),or(a((function(t,e,o,r){Ho(t,Ny,{name:n.name,value:r})})))],f=function(n,t){return H(hs(n.element,".tox-collection__item"),t)},l=Ey.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==n.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:r},behaviours:qa([$h.config({disabled:t.isDisabled,onDisabled:function(n){f(n,(function(n){_i(n,"tox-collection__item--state-disabled"),Pr(n,"aria-disabled",!0)}))},onEnabled:function(n){f(n,(function(n){Ei(n,"tox-collection__item--state-disabled"),Lr(n,"aria-disabled")}))}}),Tv(),ng.config({}),Ff.config({store:{mode:"memory",initialValue:[]},onSetValue:function(e,o){!function(e,o){var r=H(o,(function(e){var o=Ph.translate(e.text),r=1===n.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(n){return u[n]}));return'<div class="tox-collection__item'+(t.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+My.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==n.columns&&n.columns>1?P(r,n.columns):[r],u=H(i,(function(n){return'<div class="tox-collection__group">'+n.join("")+"</div>"}));Rr(e.element,u.join(""))}(e,o),"auto"===n.columns&&Oh(e,5,"tox-collection__item").each((function(n){var t=n.numRows,o=n.numColumns;Jm.setGridSize(e,t,o)})),Po(e,Gy)}}),Ay.config({}),Jm.config((o=n.columns,i="normal",1===o?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===o?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===i?".tox-swatches__row":".tox-collection__group",cell:"color"===i?".tox-swatch":"."+qp}})),tg("collection-events",s)]),eventOrder:(e={},e[ho()]=["disabling","alloy.base.behaviour","collection-events"],e)});return Fy(u,l,["tox-form__group--collection"],[])},Yy=o([Xt("data"),Qt("inputAttributes",{}),Qt("inputStyles",{}),Qt("tag","input"),Qt("inputClasses",[]),ra("onSetValue"),Qt("styles",{}),Qt("eventOrder",{}),If("inputBehaviours",[Ff,ug]),Qt("selectOnFocus",!0)]),qy=function(n){return qa([ug.config({onFocus:n.selectOnFocus?function(n){var t=n.element,e=qi(t);t.dom.setSelectionRange(0,e.length)}:t})])},Jy=function(n){return l(l({},qy(n)),Vf(n.inputBehaviours,[Ff.config({store:l(l({mode:"manual"},n.data.map((function(n){return{initialValue:n}})).getOr({})),{getValue:function(n){return qi(n.element)},setValue:function(n,t){qi(n.element)!==t&&Ji(n.element,t)}}),onSetValue:n.onSetValue})]))},Ky=function(n){return{tag:n.tag,attributes:l({type:"text"},n.inputAttributes),styles:n.inputStyles,classes:n.inputClasses}},$y=Vl({name:"Input",configFields:Yy(),factory:function(n,t){return{uid:n.uid,dom:Ky(n),components:[],behaviours:Jy(n),eventOrder:n.eventOrder}}}),Qy={},Zy={exports:Qy};!function(t,e,o,r){!function(r){if("object"==typeof e&&void 0!==o)o.exports=r();else if("function"==typeof t&&t.amd)t([],r);else{("undefined"!=typeof window?window:void 0!==n?n:"undefined"!=typeof self?self:this).EphoxContactWrapper=r()}}((function(){return function n(t,e,o){function i(a,c){if(!e[a]){if(!t[a]){var s="function"==typeof r&&r;if(!c&&s)return s(a,!0);if(u)return u(a,!0);var f=new Error("Cannot find module '"+a+"'");throw f.code="MODULE_NOT_FOUND",f}var l=e[a]={exports:{}};t[a][0].call(l.exports,(function(n){return i(t[a][1][n]||n)}),l,l.exports,n,t,e,o)}return e[a].exports}for(var u="function"==typeof r&&r,a=0;a<o.length;a++)i(o[a]);return i}({1:[function(n,t,e){var o,r,i=t.exports={};function u(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function c(n){if(o===setTimeout)return setTimeout(n,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(n,0);try{return o(n,0)}catch(t){try{return o.call(null,n,0)}catch(t){return o.call(this,n,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(n){r=a}}();var s,f=[],l=!1,d=-1;function m(){l&&s&&(l=!1,s.length?f=s.concat(f):d=-1,f.length&&g())}function g(){if(!l){var n=c(m);l=!0;for(var t=f.length;t;){for(s=f,f=[];++d<t;)s&&s[d].run();d=-1,t=f.length}s=null,l=!1,function(n){if(r===clearTimeout)return clearTimeout(n);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(n);try{r(n)}catch(t){try{return r.call(null,n)}catch(t){return r.call(this,n)}}}(n)}}function p(n,t){this.fun=n,this.array=t}function h(){}i.nextTick=function(n){var t=new Array(arguments.length-1);if(arguments.length>1)for(var e=1;e<arguments.length;e++)t[e-1]=arguments[e];f.push(new p(n,t)),1!==f.length||l||c(g)},p.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=h,i.addListener=h,i.once=h,i.off=h,i.removeListener=h,i.removeAllListeners=h,i.emit=h,i.prependListener=h,i.prependOnceListener=h,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,t,e){(function(n){!function(e){var o=setTimeout;function r(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(n,this)}function u(n,t){for(;3===n._state;)n=n._value;0!==n._state?(n._handled=!0,i._immediateFn((function(){var e=1===n._state?t.onFulfilled:t.onRejected;if(null!==e){var o;try{o=e(n._value)}catch(n){return void c(t.promise,n)}a(t.promise,o)}else(1===n._state?a:c)(t.promise,n._value)}))):n._deferreds.push(t)}function a(n,t){try{if(t===n)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==typeof t||"function"==typeof t)){var e=t.then;if(t instanceof i)return n._state=3,n._value=t,void s(n);if("function"==typeof e)return void l((o=e,r=t,function(){o.apply(r,arguments)}),n)}n._state=1,n._value=t,s(n)}catch(t){c(n,t)}var o,r}function c(n,t){n._state=2,n._value=t,s(n)}function s(n){2===n._state&&0===n._deferreds.length&&i._immediateFn((function(){n._handled||i._unhandledRejectionFn(n._value)}));for(var t=0,e=n._deferreds.length;t<e;t++)u(n,n._deferreds[t]);n._deferreds=null}function f(n,t,e){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.promise=e}function l(n,t){var e=!1;try{n((function(n){e||(e=!0,a(t,n))}),(function(n){e||(e=!0,c(t,n))}))}catch(n){if(e)return;e=!0,c(t,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,t){var e=new this.constructor(r);return u(this,new f(n,t,e)),e},i.all=function(n){var t=Array.prototype.slice.call(n);return new i((function(n,e){if(0===t.length)return n([]);var o=t.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(n){r(i,n)}),e)}t[i]=u,0==--o&&n(t)}catch(n){e(n)}}for(var i=0;i<t.length;i++)r(i,t[i])}))},i.resolve=function(n){return n&&"object"==typeof n&&n.constructor===i?n:new i((function(t){t(n)}))},i.reject=function(n){return new i((function(t,e){e(n)}))},i.race=function(n){return new i((function(t,e){for(var o=0,r=n.length;o<r;o++)n[o].then(t,e)}))},i._immediateFn="function"==typeof n?function(t){n(t)}:function(n){o(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==t&&t.exports?t.exports=i:e.Promise||(e.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(n,t,e){(function(t,o){var r=n("process/browser.js").nextTick,i=Function.prototype.apply,u=Array.prototype.slice,a={},c=0;function s(n,t){this._id=n,this._clearFn=t}e.setTimeout=function(){return new s(i.call(setTimeout,window,arguments),clearTimeout)},e.setInterval=function(){return new s(i.call(setInterval,window,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(n){n.close()},s.prototype.unref=s.prototype.ref=function(){},s.prototype.close=function(){this._clearFn.call(window,this._id)},e.enroll=function(n,t){clearTimeout(n._idleTimeoutId),n._idleTimeout=t},e.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},e._unrefActive=e.active=function(n){clearTimeout(n._idleTimeoutId);var t=n._idleTimeout;t>=0&&(n._idleTimeoutId=setTimeout((function(){n._onTimeout&&n._onTimeout()}),t))},e.setImmediate="function"==typeof t?t:function(n){var t=c++,o=!(arguments.length<2)&&u.call(arguments,1);return a[t]=!0,r((function(){a[t]&&(o?n.apply(null,o):n.call(null),e.clearImmediate(t))})),t},e.clearImmediate="function"==typeof o?o:function(n){delete a[n]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,t,e){var o=n("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();t.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)}))}(void 0,Qy,Zy,void 0);var nx,tx=Zy.exports.boltExport,ex=function(n){var t=b.none(),e=[],o=function(n){r()?u(n):e.push(n)},r=function(){return t.isSome()},i=function(n){z(n,u)},u=function(n){t.each((function(t){setTimeout((function(){n(t)}),0)}))};return n((function(n){r()||(t=b.some(n),i(e),e=[])})),{get:o,map:function(n){return ex((function(t){o((function(e){t(n(e))}))}))},isReady:r}},ox={nu:ex,pure:function(n){return ex((function(t){t(n)}))}},rx=function(n){setTimeout((function(){throw n}),0)},ix=function(n){var t=function(t){n().then(t,rx)};return{map:function(t){return ix((function(){return n().then(t)}))},bind:function(t){return ix((function(){return n().then((function(n){return t(n).toPromise()}))}))},anonBind:function(t){return ix((function(){return n().then((function(){return t.toPromise()}))}))},toLazy:function(){return ox.nu(t)},toCached:function(){var t=null;return ix((function(){return null===t&&(t=n()),t}))},toPromise:n,get:t}},ux=function(n){return ix((function(){return new tx(n)}))},ax=function(n){return ix((function(){return tx.resolve(n)}))},cx=["input","textarea"],sx=function(n){var t=rr(n);return I(cx,t)},fx=function(n,t){var e=t.getRoot(n).getOr(n.element);Ei(e,t.invalidClass),t.notify.each((function(t){sx(n.element)&&Pr(n.element,"aria-invalid",!1),t.getContainer(n).each((function(n){Rr(n,t.validHtml)})),t.onValid(n)}))},lx=function(n,t,e,o){var r=t.getRoot(n).getOr(n.element);_i(r,t.invalidClass),t.notify.each((function(t){sx(n.element)&&Pr(n.element,"aria-invalid",!0),t.getContainer(n).each((function(n){Rr(n,o)})),t.onInvalid(n,o)}))},dx=function(n,t,e){return t.validator.fold((function(){return ax(un.value(!0))}),(function(t){return t.validate(n)}))},mx=function(n,t,e){return t.notify.each((function(t){t.onValidate(n)})),dx(n,t).map((function(e){return n.getSystem().isConnected()?e.fold((function(e){return lx(n,t,0,e),un.error(e)}),(function(e){return fx(n,t),un.value(e)})):un.error("No longer in system")}))},gx=Object.freeze({__proto__:null,markValid:fx,markInvalid:lx,query:dx,run:mx,isInvalid:function(n,t){var e=t.getRoot(n).getOr(n.element);return Di(e,t.invalidClass)}}),px=Object.freeze({__proto__:null,events:function(n,e){return n.validator.map((function(e){return Uo([Xo(e.onEvent,(function(t){mx(t,n).get(r)}))].concat(e.validateOnLoad?[nr((function(e){mx(e,n).get(t)}))]:[]))})).getOr({})}}),hx=[Pt("invalidClass"),Qt("getRoot",b.none),$t("notify",[Qt("aria","alert"),Qt("getContainer",b.none),Qt("validHtml",""),ra("onValid"),ra("onInvalid"),ra("onValidate")]),$t("validator",[Pt("validate"),Qt("onEvent","input"),Qt("validateOnLoad",!0)])],vx=Ka({fields:hx,name:"invalidating",active:px,apis:gx,extra:{validation:function(n){return function(t){var e=Ff.getValue(t);return ax(n(e))}}}}),bx=Object.freeze({__proto__:null,getCoupled:function(n,t,e,o){return e.getOrCreate(n,t,o)}}),yx=[Ht("others",wt(un.value,Et()))],xx=Ka({fields:yx,name:"coupling",apis:bx,state:Object.freeze({__proto__:null,init:function(){var n={},t=o({});return li({readState:t,getOrCreate:function(t,e,o){var r=yn(e.others);if(r)return En(n,o).getOrThunk((function(){var r=En(e.others,o).getOrDie("No information found for coupled component: "+o)(t),i=t.getSystem().build(r);return n[o]=i,i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}})}),wx=o("sink"),Sx=o(fl({name:wx(),overrides:o({dom:{tag:"div"},behaviours:qa([Ws.config({useFixed:s})]),events:Uo([$o(eo()),$o(Je()),$o(uo())])})}));!function(n){n[n.HighlightFirst=0]="HighlightFirst",n[n.HighlightNone=1]="HighlightNone"}(nx||(nx={}));var kx,Cx,Ox,_x=function(n,t){var e=n.getHotspot(t).getOr(t),o=n.getAnchorOverrides();return n.layouts.fold((function(){return{anchor:"hotspot",hotspot:e,overrides:o}}),(function(n){return{anchor:"hotspot",hotspot:e,overrides:o,layouts:n}}))},Tx=function(n,t,e,o,r,i,u){return function(n,t,e,o,r,i,u){var a=function(n,t,e){return(0,n.fetch)(e).map(t)}(n,t,o),c=Ax(o,n);return a.map((function(n){return n.bind((function(n){return b.from(Ng.sketch(l(l({},i.menu()),{uid:ti(""),data:n,highlightImmediately:u===nx.HighlightFirst,onOpenMenu:function(n,t){var o=c().getOrDie();Ws.position(o,e,t),mf.decloak(r)},onOpenSubmenu:function(n,t,e){var o=c().getOrDie();Ws.position(o,{anchor:"submenu",item:t},e),mf.decloak(r)},onRepositionMenu:function(n,t,o){var r=c().getOrDie();Ws.position(r,e,t),z(o,(function(n){Ws.position(r,{anchor:"submenu",item:n.triggeringItem},n.triggeredMenu)}))},onEscape:function(){return ug.focus(o),mf.close(r),b.some(!0)}})))}))}))}(n,t,_x(n,e),e,o,r,u).map((function(n){return n.fold((function(){mf.isOpen(o)&&mf.close(o)}),(function(n){mf.cloak(o),mf.open(o,n),i(o)})),o}))},Ex=function(n,t,e,o,r,i,u){return mf.close(o),ax(o)},Dx=function(n,t,e,o,r,i){var u=xx.getCoupled(e,"sandbox");return(mf.isOpen(u)?Ex:Tx)(n,t,e,u,o,r,i)},Bx=function(n,t,e){var o=Ul.getCurrent(t).getOr(t),r=bu(n.element);e?Hi(o.element,"min-width",r+"px"):function(n,t){vu.set(n,t)}(o.element,r)},Ax=function(n,t){return n.getSystem().getByUid(t.uid+"-"+wx()).map((function(n){return function(){return un.value(n)}})).getOrThunk((function(){return t.lazySink.fold((function(){return function(){return un.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(t){return function(){return t(n)}}))}))},Mx=function(n){mf.getState(n).each((function(n){Ng.repositionMenus(n)}))},Fx=function(n,t,e){var o=ju(),r=Ax(t,n);return{dom:{tag:"div",classes:n.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Hf(n.sandboxBehaviours,[Ff.config({store:{mode:"memory",initialValue:t}}),mf.config({onOpen:function(r,i){var u=_x(n,t);o.link(t.element),n.matchWidth&&Bx(u.hotspot,i,n.useMinWidth),n.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(n,r){o.unlink(t.element),void 0!==e&&void 0!==e.onClose&&e.onClose(n,r)},isPartOf:function(n,e,o){return Wu(e,o)||Wu(t,o)},getAttachPoint:function(){return r().getOrDie()}}),Ul.config({find:function(n){return mf.getState(n).bind((function(n){return Ul.getCurrent(n)}))}}),nc.config({channels:l(l({},bf({isExtraPart:c})),xf({doReposition:Mx}))})])}},Ix=function(n){var t=xx.getCoupled(n,"sandbox");Mx(t)},Rx=function(){return[Qt("sandboxClasses",[]),Pf("sandboxBehaviours",[Ul,nc,mf,Ff])]},Vx=o([Pt("dom"),Pt("fetch"),ra("onOpen"),ia("onExecute"),Qt("getHotspot",b.some),Qt("getAnchorOverrides",o({})),Rc(),If("dropdownBehaviours",[bg,xx,Jm,ug]),Pt("toggleClass"),Qt("eventOrder",{}),Xt("lazySink"),Qt("matchWidth",!1),Qt("useMinWidth",!1),Xt("role")].concat(Rx())),Px=o([sl({schema:[ta()],name:"menu",defaults:function(n){return{onExecute:n.onExecute}}}),Sx()]),Hx=Pl({name:"Dropdown",configFields:Vx(),partFields:Px(),factory:function(n,e,o,r){var i,u,a=function(n){mf.getState(n).each((function(n){Ng.highlightPrimary(n)}))},c={expand:function(e){bg.isOn(e)||Dx(n,(function(n){return n}),e,r,t,nx.HighlightNone).get(t)},open:function(e){bg.isOn(e)||Dx(n,(function(n){return n}),e,r,t,nx.HighlightFirst).get(t)},isOpen:bg.isOn,close:function(e){bg.isOn(e)&&Dx(n,(function(n){return n}),e,r,t,nx.HighlightFirst).get(t)},repositionMenus:function(n){bg.isOn(n)&&Ix(n)}},s=function(n,t){return zo(n),b.some(!0)};return{uid:n.uid,dom:n.dom,components:e,behaviours:Vf(n.dropdownBehaviours,[bg.config({toggleClass:n.toggleClass,aria:{mode:"expanded"}}),xx.config({others:{sandbox:function(t){return Fx(n,t,{onOpen:function(){return bg.on(t)},onClose:function(){return bg.off(t)}})}}}),Jm.config({mode:"special",onSpace:s,onEnter:s,onDown:function(n,t){if(Hx.isOpen(n)){var e=xx.getCoupled(n,"sandbox");a(e)}else Hx.open(n);return b.some(!0)},onEscape:function(n,t){return Hx.isOpen(n)?(Hx.close(n),b.some(!0)):b.none()}}),ug.config({})]),events:xg(b.some((function(e){Dx(n,(function(n){return n}),e,r,a,nx.HighlightFirst).get(t)}))),eventOrder:l(l({},n.eventOrder),(i={},i[ho()]=["disabling","toggling","alloy.base.behaviour"],i)),apis:c,domModification:{attributes:l(l({"aria-haspopup":"true"},n.role.fold((function(){return{}}),(function(n){return{role:n}}))),"button"===n.dom.tag?{type:(u="type",En(n.dom,"attributes").bind((function(n){return En(n,u)}))).getOr("button")}:{})}}},apis:{open:function(n,t){return n.open(t)},expand:function(n,t){return n.expand(t)},close:function(n,t){return n.close(t)},isOpen:function(n,t){return n.isOpen(t)},repositionMenus:function(n,t){return n.repositionMenus(t)}}}),zx=Object.freeze({__proto__:null,events:function(){return Uo([Wo(co(),s)])},exhibit:function(){return mi({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),Nx=Ka({fields:[],name:"unselecting",active:zx}),Lx=qr("color-input-change"),jx=qr("color-swatch-change"),Ux=qr("color-picker-cancel"),Wx=function(n,e,o){var r=Ey.parts.field({factory:$y,inputClasses:["tox-textfield"],onSetValue:function(n){return vx.run(n).get(t)},inputBehaviours:qa([$h.config({disabled:e.providers.isDisabled}),Tv(),Ay.config({}),vx.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(n){return gr(n.element)},notify:{onValid:function(n){var t=Ff.getValue(n);Ho(n,Lx,{color:t})}},validator:{validateOnLoad:!1,validate:function(n){var t=Ff.getValue(n);if(0===t.length)return ax(un.value(!0));var e=fe.fromTag("span");Hi(e,"background-color",t);var o=Ui(e,"background-color").fold((function(){return un.error("blah")}),(function(n){return un.value(t)}));return ax(o)}}})]),selectOnFocus:!1}),i=n.label.map((function(n){return Vy(n,e.providers)})),u=function(n,t){Ho(n,jx,{value:t})},a=tp(function(n,t){return Hx.sketch({dom:n.dom,components:n.components,toggleClass:"mce-active",dropdownBehaviours:qa([Dv(t.providers.isDisabled),Tv(),Nx.config({}),Ay.config({})]),layouts:n.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:t.getSink,fetch:function(e){return ux((function(t){return n.fetch(t)})).map((function(o){return b.from(oy(In(Hb(qr("menu-value"),o,(function(t){n.onItemAction(e,t)}),n.columns,n.presets,Xp.CLOSE_ON_EXECUTE,c,t.providers),{movement:Nb(n.columns,n.presets)})))}))},parts:{menu:rh(0,0,n.presets)}})}({dom:{tag:"span",attributes:{"aria-label":e.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Da,Ea,Fa]},onLtr:function(){return[Ea,Da,Fa]}},components:[],fetch:Fb(o.getColors(),o.hasCustomColors()),columns:o.getColorCols(),presets:"color",onItemAction:function(n,t){a.getOpt(n).each((function(n){"custom"===t?o.colorPicker((function(t){t.fold((function(){return Po(n,Ux)}),(function(t){u(n,t),Db(t)}))}),"#ffffff"):u(n,"remove"===t?"":t)}))}},e));return Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:i.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[r,a.asSpec()]}]),fieldBehaviours:qa([tg("form-field-events",[Xo(Lx,(function(t,e){a.getOpt(t).each((function(n){Hi(n.element,"background-color",e.event.color)})),Ho(t,Py,{name:n.name})})),Xo(jx,(function(n,t){Ey.getField(n).each((function(e){Ff.setValue(e,t.event.value),Ul.getCurrent(n).each(ug.focus)}))})),Xo(Ux,(function(n,t){Ey.getField(n).each((function(t){Ul.getCurrent(n).each(ug.focus)}))}))])])})},Gx=function(n,t,e){return{hue:n,saturation:t,value:e}},Xx=qr("rgb-hex-update"),Yx=qr("slider-update"),qx=qr("palette-update"),Jx=fl({schema:[Pt("dom")],name:"label"}),Kx=function(n){return fl({name:n+"-edge",overrides:function(t){return t.model.manager.edgeActions[n].fold((function(){return{}}),(function(n){return{events:Uo([Yo(Ge(),(function(t,e,o){return n(t,o)}),[t]),Yo(Je(),(function(t,e,o){return n(t,o)}),[t]),Yo(Ke(),(function(t,e,o){o.mouseIsDown.get()&&n(t,o)}),[t])])}}))}})},$x=Kx("top-left"),Qx=Kx("top"),Zx=Kx("top-right"),nw=Kx("right"),tw=Kx("bottom-right"),ew=Kx("bottom"),ow=Kx("bottom-left"),rw=Kx("left"),iw=cl({name:"thumb",defaults:o({dom:{styles:{position:"absolute"}}}),overrides:function(n){return{events:Uo([Jo(Ge(),n,"spectrum"),Jo(Xe(),n,"spectrum"),Jo(Ye(),n,"spectrum"),Jo(Je(),n,"spectrum"),Jo(Ke(),n,"spectrum"),Jo(Qe(),n,"spectrum")])}}}),uw=cl({schema:[ae("mouseIsDown",(function(){return ce(!1)}))],name:"spectrum",overrides:function(n){var t=n.model.manager,e=function(e,o){return t.getValueFromEvent(o).map((function(o){return t.setValueFrom(e,n,o)}))};return{behaviours:qa([Jm.config({mode:"special",onLeft:function(e){return t.onLeft(e,n)},onRight:function(e){return t.onRight(e,n)},onUp:function(e){return t.onUp(e,n)},onDown:function(e){return t.onDown(e,n)}}),ug.config({})]),events:Uo([Xo(Ge(),e),Xo(Xe(),e),Xo(Je(),e),Xo(Ke(),(function(t,o){n.mouseIsDown.get()&&e(t,o)}))])}}}),aw=[Jx,rw,nw,Qx,ew,$x,Zx,ow,tw,iw,uw],cw=o("slider.change.value"),sw=function(n){var t=n.event.raw;if(function(n){return-1!==n.type.indexOf("touch")}(t)){var e=t;return void 0!==e.touches&&1===e.touches.length?b.some(e.touches[0]).map((function(n){return mu(n.clientX,n.clientY)})):b.none()}var o=t;return void 0!==o.clientX?b.some(o).map((function(n){return mu(n.clientX,n.clientY)})):b.none()},fw=function(n){return n.model.minX},lw=function(n){return n.model.minY},dw=function(n){return n.model.minX-1},mw=function(n){return n.model.minY-1},gw=function(n){return n.model.maxX},pw=function(n){return n.model.maxY},hw=function(n){return n.model.maxX+1},vw=function(n){return n.model.maxY+1},bw=function(n,t,e){return t(n)-e(n)},yw=function(n){return bw(n,gw,fw)},xw=function(n){return bw(n,pw,lw)},ww=function(n){return yw(n)/2},Sw=function(n){return xw(n)/2},kw=function(n){return n.stepSize},Cw=function(n){return n.snapToGrid},Ow=function(n){return n.snapStart},_w=function(n){return n.rounded},Tw=function(n,t){return void 0!==n[t+"-edge"]},Ew=function(n){return Tw(n,"left")},Dw=function(n){return Tw(n,"right")},Bw=function(n){return Tw(n,"top")},Aw=function(n){return Tw(n,"bottom")},Mw=function(n){return n.model.value.get()},Fw=function(n){return{x:n}},Iw=function(n){return{y:n}},Rw=function(n,t){return{x:n,y:t}},Vw=function(n,t){Ho(n,cw(),{value:t})},Pw=function(n,t,e,o){return n<t?n:n>e?e:n===t?t-1:Math.max(t,n-o)},Hw=function(n,t,e,o){return n>e?n:n<t?t:n===e?e+1:Math.min(e,n+o)},zw=function(n,t,e){return Math.max(t,Math.min(e,n))},Nw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.step,u=n.snap,a=n.snapStart,c=n.rounded,s=n.hasMinEdge,f=n.hasMaxEdge,l=n.minBound,d=n.maxBound,m=n.screenRange,g=s?t-1:t,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=function(n,t,e){return Math.min(e,Math.max(n,t))-t}(r,l,d),v=zw(h/m*o+t,g,p);return u&&v>=t&&v<=e?function(n,t,e,o,r){return r.fold((function(){var r=n-t,i=Math.round(r/o)*o;return zw(t+i,t-1,e+1)}),(function(t){var r=(n-t)%o,i=Math.round(r/o),u=Math.floor((n-t)/o),a=Math.floor((e-t)/o),c=t+Math.min(a,u+i)*o;return Math.max(t,c)}))}(v,t,e,i,a):c?Math.round(v):v},Lw=function(n){var t=n.min,e=n.max,o=n.range,r=n.value,i=n.hasMinEdge,u=n.hasMaxEdge,a=n.maxBound,c=n.maxOffset,s=n.centerMinEdge,f=n.centerMaxEdge;return r<t?i?0:s:r>e?u?a:f:(r-t)/o*c},jw=function(n){return n.element.dom.getBoundingClientRect()},Uw=function(n,t){return n[t]},Ww=function(n){var t=jw(n);return Uw(t,"left")},Gw=function(n){var t=jw(n);return Uw(t,"right")},Xw=function(n){var t=jw(n);return Uw(t,"top")},Yw=function(n){var t=jw(n);return Uw(t,"bottom")},qw=function(n){var t=jw(n);return Uw(t,"width")},Jw=function(n){var t=jw(n);return Uw(t,"height")},Kw=function(n,t,e){return(n+t)/2-e},$w=function(n,t){var e=jw(n),o=jw(t),r=Uw(e,"left"),i=Uw(e,"right"),u=Uw(o,"left");return Kw(r,i,u)},Qw=function(n,t){var e=jw(n),o=jw(t),r=Uw(e,"top"),i=Uw(e,"bottom"),u=Uw(o,"top");return Kw(r,i,u)},Zw=function(n,t){Ho(n,cw(),{value:t})},nS=function(n){return{x:n}},tS=function(n,t,e){var o={min:fw(t),max:gw(t),range:yw(t),value:e,step:kw(t),snap:Cw(t),snapStart:Ow(t),rounded:_w(t),hasMinEdge:Ew(t),hasMaxEdge:Dw(t),minBound:Ww(n),maxBound:Gw(n),screenRange:qw(n)};return Nw(o)},eS=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Hw:Pw)(Mw(e).x,fw(e),gw(e),kw(e));return Zw(t,nS(o)),b.some(o)}(n,t,e).map(s)}},oS=function(n,t,e,o,r,i){var u=function(n,t,e,o,r){var i=qw(n),u=o.bind((function(t){return b.some($w(t,n))})).getOr(0),a=r.bind((function(t){return b.some($w(t,n))})).getOr(i),c={min:fw(t),max:gw(t),range:yw(t),value:e,hasMinEdge:Ew(t),hasMaxEdge:Dw(t),minBound:Ww(n),minOffset:0,maxBound:Gw(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Lw(c)}(t,i,e,o,r);return Ww(t)-Ww(n)+u},rS=eS(-1),iS=eS(1),uS=b.none,aS=b.none,cS={"top-left":b.none(),top:b.none(),"top-right":b.none(),right:b.some((function(n,t){Vw(n,Fw(hw(t)))})),"bottom-right":b.none(),bottom:b.none(),"bottom-left":b.none(),left:b.some((function(n,t){Vw(n,Fw(dw(t)))}))},sS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=tS(n,t,e),r=nS(o);return Zw(n,r),o},setToMin:function(n,t){var e=fw(t);Zw(n,nS(e))},setToMax:function(n,t){var e=gw(t);Zw(n,nS(e))},findValueOfOffset:tS,getValueFromEvent:function(n){return sw(n).map((function(n){return n.left}))},findPositionOfValue:oS,setPositionFromValue:function(n,t,e,o){var r=Mw(e),i=oS(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=bu(t.element)/2;Hi(t.element,"left",i-u+"px")},onLeft:rS,onRight:iS,onUp:uS,onDown:aS,edgeActions:cS}),fS=function(n,t){Ho(n,cw(),{value:t})},lS=function(n){return{y:n}},dS=function(n,t,e){var o={min:lw(t),max:pw(t),range:xw(t),value:e,step:kw(t),snap:Cw(t),snapStart:Ow(t),rounded:_w(t),hasMinEdge:Bw(t),hasMaxEdge:Aw(t),minBound:Xw(n),maxBound:Yw(n),screenRange:Jw(n)};return Nw(o)},mS=function(n){return function(t,e){return function(n,t,e){var o=(n>0?Hw:Pw)(Mw(e).y,lw(e),pw(e),kw(e));return fS(t,lS(o)),b.some(o)}(n,t,e).map(s)}},gS=function(n,t,e,o,r,i){var u=function(n,t,e,o,r){var i=Jw(n),u=o.bind((function(t){return b.some(Qw(t,n))})).getOr(0),a=r.bind((function(t){return b.some(Qw(t,n))})).getOr(i),c={min:lw(t),max:pw(t),range:xw(t),value:e,hasMinEdge:Bw(t),hasMaxEdge:Aw(t),minBound:Xw(n),minOffset:0,maxBound:Yw(n),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return Lw(c)}(t,i,e,o,r);return Xw(t)-Xw(n)+u},pS=b.none,hS=b.none,vS=mS(-1),bS=mS(1),yS={"top-left":b.none(),top:b.some((function(n,t){Vw(n,Iw(mw(t)))})),"top-right":b.none(),right:b.none(),"bottom-right":b.none(),bottom:b.some((function(n,t){Vw(n,Iw(vw(t)))})),"bottom-left":b.none(),left:b.none()},xS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=dS(n,t,e),r=lS(o);return fS(n,r),o},setToMin:function(n,t){var e=lw(t);fS(n,lS(e))},setToMax:function(n,t){var e=pw(t);fS(n,lS(e))},findValueOfOffset:dS,getValueFromEvent:function(n){return sw(n).map((function(n){return n.top}))},findPositionOfValue:gS,setPositionFromValue:function(n,t,e,o){var r=Mw(e),i=gS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),u=fu(t.element)/2;Hi(t.element,"top",i-u+"px")},onLeft:pS,onRight:hS,onUp:vS,onDown:bS,edgeActions:yS}),wS=function(n,t){Ho(n,cw(),{value:t})},SS=function(n,t){return{x:n,y:t}},kS=function(n,t){return function(e,o){return function(n,t,e,o){var r=n>0?Hw:Pw,i=t?Mw(o).x:r(Mw(o).x,fw(o),gw(o),kw(o)),u=t?r(Mw(o).y,lw(o),pw(o),kw(o)):Mw(o).y;return wS(e,SS(i,u)),b.some(i)}(n,t,e,o).map(s)}},CS=kS(-1,!1),OS=kS(1,!1),_S=kS(-1,!0),TS=kS(1,!0),ES={"top-left":b.some((function(n,t){Vw(n,Rw(dw(t),mw(t)))})),top:b.some((function(n,t){Vw(n,Rw(ww(t),mw(t)))})),"top-right":b.some((function(n,t){Vw(n,Rw(hw(t),mw(t)))})),right:b.some((function(n,t){Vw(n,Rw(hw(t),Sw(t)))})),"bottom-right":b.some((function(n,t){Vw(n,Rw(hw(t),vw(t)))})),bottom:b.some((function(n,t){Vw(n,Rw(ww(t),vw(t)))})),"bottom-left":b.some((function(n,t){Vw(n,Rw(dw(t),vw(t)))})),left:b.some((function(n,t){Vw(n,Rw(dw(t),Sw(t)))}))},DS=Object.freeze({__proto__:null,setValueFrom:function(n,t,e){var o=tS(n,t,e.left),r=dS(n,t,e.top),i=SS(o,r);return wS(n,i),i},setToMin:function(n,t){var e=fw(t),o=lw(t);wS(n,SS(e,o))},setToMax:function(n,t){var e=gw(t),o=pw(t);wS(n,SS(e,o))},getValueFromEvent:function(n){return sw(n)},setPositionFromValue:function(n,t,e,o){var r=Mw(e),i=oS(n,o.getSpectrum(n),r.x,o.getLeftEdge(n),o.getRightEdge(n),e),u=gS(n,o.getSpectrum(n),r.y,o.getTopEdge(n),o.getBottomEdge(n),e),a=bu(t.element)/2,c=fu(t.element)/2;Hi(t.element,"left",i-a+"px"),Hi(t.element,"top",u-c+"px")},onLeft:CS,onRight:OS,onUp:_S,onDown:TS,edgeActions:ES}),BS=Pl({name:"Slider",configFields:[Qt("stepSize",1),Qt("onChange",t),Qt("onChoose",t),Qt("onInit",t),Qt("onDragStart",t),Qt("onDragEnd",t),Qt("snapToGrid",!1),Qt("rounded",!0),Xt("snapStart"),Ht("model",Tt("mode",{x:[Qt("minX",0),Qt("maxX",100),ae("value",(function(n){return ce(n.mode.minX)})),Pt("getInitialValue"),ca("manager",sS)],y:[Qt("minY",0),Qt("maxY",100),ae("value",(function(n){return ce(n.mode.minY)})),Pt("getInitialValue"),ca("manager",xS)],xy:[Qt("minX",0),Qt("maxX",100),Qt("minY",0),Qt("maxY",100),ae("value",(function(n){return ce({x:n.mode.minX,y:n.mode.minY})})),Pt("getInitialValue"),ca("manager",DS)]})),If("sliderBehaviours",[Jm,Ff]),ae("mouseIsDown",(function(){return ce(!1)}))],partFields:aw,factory:function(n,t,e,o){var r,i=function(t){return kl(t,n,"thumb")},u=function(t){return kl(t,n,"spectrum")},a=function(t){return Sl(t,n,"left-edge")},c=function(t){return Sl(t,n,"right-edge")},f=function(t){return Sl(t,n,"top-edge")},l=function(t){return Sl(t,n,"bottom-edge")},d=n.model,m=d.manager,g=function(t,e){m.setPositionFromValue(t,e,n,{getLeftEdge:a,getRightEdge:c,getTopEdge:f,getBottomEdge:l,getSpectrum:u})},p=function(t,e){d.value.set(e);var o=i(t);return g(t,o),n.onChange(t,o,e),b.some(!0)},h=function(t){var e=n.mouseIsDown.get();n.mouseIsDown.set(!1),e&&Sl(t,n,"thumb").each((function(e){var o=d.value.get();n.onChoose(t,e,o)}))},v=function(t,e){e.stop(),n.mouseIsDown.set(!0),n.onDragStart(t,i(t))},y=function(t,e){e.stop(),n.onDragEnd(t,i(t)),h(t)};return{uid:n.uid,dom:n.dom,components:t,behaviours:Vf(n.sliderBehaviours,[Jm.config({mode:"special",focusIn:function(t){return Sl(t,n,"spectrum").map(Jm.focusIn).map(s)}}),Ff.config({store:{mode:"manual",getValue:function(n){return d.value.get()}}}),nc.config({channels:(r={},r[hf()]={onReceive:h},r)})]),events:Uo([Xo(cw(),(function(n,t){p(n,t.event.value)})),nr((function(t,e){var o=d.getInitialValue();d.value.set(o);var r=i(t);g(t,r);var a=u(t);n.onInit(t,r,a,d.value.get())})),Xo(Ge(),v),Xo(Ye(),y),Xo(Je(),v),Xo(Qe(),y)]),apis:{resetToMin:function(t){m.setToMin(t,n)},resetToMax:function(t){m.setToMax(t,n)},changeValue:p,refresh:g},domModification:{styles:{position:"relative"}}}},apis:{resetToMin:function(n,t){n.resetToMin(t)},resetToMax:function(n,t){n.resetToMax(t)},refresh:function(n,t){n.refresh(t)}}}),AS=function(n,t){var e=BS.parts.spectrum({dom:{tag:"div",classes:[t("hue-slider-spectrum")],attributes:{role:"presentation"}}}),r=BS.parts.thumb({dom:{tag:"div",classes:[t("hue-slider-thumb")],attributes:{role:"presentation"}}});return BS.sketch({dom:{tag:"div",classes:[t("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:o({y:0})},components:[e,r],sliderBehaviours:qa([ug.config({})]),onChange:function(n,t,e){Ho(n,Yx,{value:e})}})},MS=[If("formBehaviours",[Ff])],FS=function(n){return"<alloy.field."+n+">"},IS=function(n,t){return{uid:n.uid,dom:n.dom,components:t,behaviours:Vf(n.formBehaviours,[Ff.config({store:{mode:"manual",getValue:function(t){var e=Ol(t,n);return Sn(e,(function(n,t){return n().bind((function(n){var e,o,r=Ul.getCurrent(n);return e=r,o=new Error("Cannot find a current component to extract the value from for form part '"+t+"': "+Wr(n.element)),e.fold((function(){return un.error(o)}),un.value)})).map(Ff.getValue)}))},setValue:function(t,e){wn(e,(function(e,o){Sl(t,n,o).each((function(n){Ul.getCurrent(n).each((function(n){Ff.setValue(n,e)}))}))}))}}})]),apis:{getField:function(t,e){return Sl(t,n,e).bind(Ul.getCurrent)}}}},RS={getField:si((function(n,t,e){return n.getField(t,e)})),sketch:function(n){var t=function(){var n=[];return{field:function(t,e){return n.push(t),vl("form",FS(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=H(o,(function(n){return cl({name:n,pname:FS(n)})}));return Ml("form",MS,r,IS,e)}},VS=qr("valid-input"),PS=qr("invalid-input"),HS=qr("validating-input"),zS=function(n,e,o,r){var i=function(t,o){return vx.config({invalidClass:e("invalid"),notify:{onValidate:function(n){Ho(n,HS,{type:t})},onValid:function(n){Ho(n,VS,{type:t,value:Ff.getValue(n)})},onInvalid:function(n){Ho(n,PS,{type:t,value:Ff.getValue(n)})}},validator:{validate:function(t){var e=Ff.getValue(t),r=o(e)?un.value(!0):un.error(n("aria.input.invalid"));return ax(r)},validateOnLoad:!1}})},u=function(o,r,u,a,c){var s=n("colorcustom.rgb.range"),f=[Ey.parts.label({dom:{tag:"label",innerHtml:u,attributes:{"aria-label":a}}}),Ey.parts.field({data:c,factory:$y,inputAttributes:l({type:"text"},"hex"===r?{"aria-live":"polite"}:{}),inputClasses:[e("textfield")],inputBehaviours:qa([i(r,o),Ay.config({})]),onSetValue:function(n){vx.isInvalid(n)&&vx.run(n).get(t)}})],d="hex"!==r?[Ey.parts["aria-descriptor"]({text:s})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:f.concat(d)}},a=function(n,t){var e=t.red,o=t.green,r=t.blue;Ff.setValue(n,{red:e,green:o,blue:r})},c=tp({dom:{tag:"div",classes:[e("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),s=function(n,t){c.getOpt(n).each((function(n){Hi(n.element,"background-color","#"+t.value)}))};return Vl({factory:function(){var t={red:ce(b.some(255)),green:ce(b.some(255)),blue:ce(b.some(255)),hex:ce(b.some("ffffff"))},i=function(n){return t[n].get()},f=function(n,e){t[n].set(e)},l=function(n){var t=n.red,e=n.green,o=n.blue;f("red",b.some(t)),f("green",b.some(e)),f("blue",b.some(o))},d=function(n,t){var e=t.event;"hex"!==e.type?f(e.type,b.none()):r(n)},m=function(n,t,e){var o=parseInt(e,10);f(t,b.some(o)),i("red").bind((function(n){return i("green").bind((function(t){return i("blue").map((function(e){return gb(n,t,e,1)}))}))})).each((function(t){var e=function(n,t){var e=cb(t);return RS.getField(n,"hex").each((function(t){ug.isFocused(t)||Ff.setValue(n,{hex:e.value})})),e}(n,t);s(n,e)}))},g=function(n,t){var e=t.event;!function(n){return"hex"===n.type}(e)?m(n,e.type,e.value):function(n,t){o(n);var e=eb(t);f("hex",b.some(t));var r=vb(e);a(n,r),l(r),Ho(n,Xx,{hex:e}),s(n,e)}(n,e.value)},p=function(t){return{label:n("colorcustom.rgb."+t+".label"),description:n("colorcustom.rgb."+t+".description")}},h=p("red"),v=p("green"),y=p("blue"),x=p("hex");return In(RS.sketch((function(t){return{dom:{tag:"form",classes:[e("rgb-form")],attributes:{"aria-label":n("aria.color.picker")}},components:[t.field("red",Ey.sketch(u(pb,"red",h.label,h.description,255))),t.field("green",Ey.sketch(u(pb,"green",v.label,v.description,255))),t.field("blue",Ey.sketch(u(pb,"blue",y.label,y.description,255))),t.field("hex",Ey.sketch(u(ib,"hex",x.label,x.description,"ffffff"))),c.asSpec()],formBehaviours:qa([vx.config({invalidClass:e("form-invalid")}),tg("rgb-form-events",[Xo(VS,g),Xo(PS,d),Xo(HS,d)])])}})),{apis:{updateHex:function(n,t){Ff.setValue(n,{hex:t.value}),function(n,t){var e=vb(t);a(n,e),l(e)}(n,t),s(n,t)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(n,t,e){n.updateHex(t,e)}},extraApis:{}})},NS=function(n,t){var e=BS.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[t("sv-palette-spectrum")]}}),r=BS.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette-thumb")],innerHtml:"<div class="+t("sv-palette-inner-thumb")+' role="presentation"></div>'}}),i=function(n,t){var e=n.width,o=n.height,r=n.getContext("2d");if(null!==r){r.fillStyle=t,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return Vl({factory:function(n){var u=o({x:0,y:0}),a=qa([Ul.config({find:b.some}),ug.config({})]);return BS.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[t("sv-palette")]},model:{mode:"xy",getInitialValue:u},rounded:!1,components:[e,r],onChange:function(n,t,e){Ho(n,qx,{value:e})},onInit:function(n,t,e,o){i(e.element.dom,yb(xb))},sliderBehaviours:a})},name:"SaturationBrightnessPalette",configFields:[],apis:{setRgba:function(n,t,e){!function(n,t){var e=n.components()[0].element.dom;i(e,yb(t))}(t,e)}},extraApis:{}})},LS=function(n,e){return Vl({name:"ColourPicker",configFields:[Pt("dom"),Qt("onValidHex",t),Qt("onInvalidHex",t)],factory:function(t){var o,r=zS(n,e,t.onValidHex,t.onInvalidHex),i=NS(0,e),u={paletteRgba:ce(xb)},a=tp(i.sketch({})),c=tp(r.sketch({})),s=function(n,t){a.getOpt(n).each((function(n){var e=vb(t);u.paletteRgba.set(e),i.setRgba(n,e)}))},f=function(n,t){c.getOpt(n).each((function(n){r.updateHex(n,t)}))},l=function(n,t,e){z(e,(function(e){e(n,t)}))};return{uid:t.uid,dom:t.dom,components:[a.asSpec(),AS(0,e),c.asSpec()],behaviours:qa([tg("colour-picker-events",[Xo(qx,(o=[f],function(n,t){var e=t.event.value,r=function(n){var t,e=0,o=0,r=n.red/255,i=n.green/255,u=n.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?Gx(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),t=(c-a)/c,o=c,Gx(Math.round(e),Math.round(100*t),Math.round(100*o)))}(u.paletteRgba.get()),i=Gx(r.hue,e.x,100-e.y),a=hb(i),c=cb(a);l(n,c,o)})),Xo(Yx,function(){var n=[s,f];return function(t,e){var o=function(n){var t=Gx((100-n)/100*360,100,100),e=hb(t);return cb(e)}(e.event.value.y);l(t,o,n)}}())]),Ul.config({find:function(n){return c.getOpt(n)}}),Jm.config({mode:"acyclic"})])}}})},jS=function(){return Ul.config({find:b.some})},US=function(n){return Ul.config({find:n.getOpt})},WS=function(n){return Ul.config({find:function(t){return vr(t.element,n).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}})},GS={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},XS=function(n){return function(n){return GS[n]}(n)},YS=tinymce.util.Tools.resolve("tinymce.Resource"),qS=tinymce.util.Tools.resolve("tinymce.util.Tools"),JS=at([Qt("preprocess",r),Qt("postprocess",r)]),KS=function(n,t,e){return Ff.config(In({store:{mode:"manual",getValue:t,setValue:e}},n.map((function(n){return{store:{initialValue:n}}})).getOr({})))},$S=function(n,t,e){return KS(n,(function(n){return t(n.element)}),(function(n,t){return e(n.element,t)}))},QS=function(n,t){var e=Ct("RepresentingConfigs.memento processors",JS,t);return Ff.config({store:{mode:"manual",getValue:function(t){var o=n.get(t),r=Ff.getValue(o);return e.postprocess(r)},setValue:function(t,o){var r=e.preprocess(o),i=n.get(t);Ff.setValue(i,r)}}})},ZS=KS,nk=function(n){return $S(n,Ir,Rr)},tk=function(n){return Ff.config({store:{mode:"memory",initialValue:n}})},ek=function(n,t){var e=function(n,t){t.stop()},o=function(n){return function(t,e){z(n,(function(n){n(t,e)}))}},r=function(n,t){if(!$h.isDisabled(n)){var e=t.event.raw;u(n,e.dataTransfer.files)}},i=function(n,t){var e=t.event.raw.target;u(n,e.files)},u=function(e,o){Ff.setValue(e,function(n,t){var e=qS.explode(t.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return L(tn(n),(function(n){return R(e,(function(t){return be(n.name.toLowerCase(),"."+t.toLowerCase())}))}))}(o,t)),Ho(e,Py,{name:n.name})},a=tp({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:qa([tg("input-file-events",[$o(uo()),$o(bo())])])}),c=n.label.map((function(n){return Vy(n,t)})),s=Ey.parts.field({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:qa([tk([]),jS(),$h.config({}),bg.config({toggleClass:"dragenter",toggleOnExecute:!1}),tg("dropzone-events",[Xo("dragenter",o([e,bg.toggle])),Xo("dragleave",o([e,bg.toggle])),Xo("dragover",e),Xo("drop",o([e,r])),Xo(io(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:t.translate("Drop an image here")}},np.sketch({dom:{tag:"button",innerHtml:t.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(n){a.get(n).element.dom.click()},buttonBehaviours:qa([Ay.config({}),Dv(t.isDisabled),Tv()])})]}]}}}});return Fy(c,s,["tox-form__group--stretched"],[])},ok=qr("alloy-fake-before-tabstop"),rk=qr("alloy-fake-after-tabstop"),ik=function(n){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:n},behaviours:qa([ug.config({ignore:!0}),Ay.config({})])}},uk=function(n){return{dom:{tag:"div",classes:["tox-navobj"]},components:[ik([ok]),n,ik([rk])],behaviours:qa([WS(1)])}},ak=function(n,t){Ho(n,eo(),{raw:{which:9,shiftKey:t}})},ck=function(n,t){var e=t.element;Di(e,ok)?ak(n,!0):Di(e,rk)&&ak(n,!1)},sk=function(n){return sy(n,["."+ok,"."+rk].join(","),c)},fk=!(Me().browser.isIE()||Me().browser.isEdge()),lk=function(n,t){var e=fk&&n.sandboxed,o=l(l({},n.label.map((function(n){return{title:n}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(n){var t=ce("");return{getValue:function(n){return t.get()},setValue:function(e,o){if(n)Pr(e.element,"srcdoc",o);else{Pr(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}t.set(o)}}}(e),i=n.label.map((function(n){return Vy(n,t)})),u=Ey.parts.field({factory:{sketch:function(n){return uk({uid:n.uid,dom:{tag:"iframe",attributes:o},behaviours:qa([Ay.config({}),ug.config({}),ZS(b.none(),r.getValue,r.setValue)])})}}});return Fy(i,u,["tox-form__group--stretched"],[])},dk=function(n,t){return pk(document.createElement("canvas"),n,t)},mk=function(n){var t=dk(n.width,n.height);return gk(t).drawImage(n,0,0),t},gk=function(n){return n.getContext("2d")},pk=function(n,t,e){return n.width=t,n.height=e,n},hk=function(n){return n.naturalWidth||n.width},vk=function(n){return n.naturalHeight||n.height},bk=window.Promise?window.Promise:function(){var n=function(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],f(n,o(u,this),o(a,this))},t=window,e=n.immediateFn||"function"==typeof t.setImmediate&&t.setImmediate||function(n){return setTimeout(n,1)},o=function(n,t){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return n.apply(t,e)}},r=Array.isArray||function(n){return"[object Array]"===Object.prototype.toString.call(n)};function i(n){var t=this;null!==this._state?e((function(){var e=t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void n.reject(t)}n.resolve(o)}else(t._state?n.resolve:n.reject)(t._value)})):this._deferreds.push(n)}function u(n){try{if(n===this)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void f(o(t,n),o(u,this),o(a,this))}this._state=!0,this._value=n,c.call(this)}catch(n){a.call(this,n)}}function a(n){this._state=!1,this._value=n,c.call(this)}function c(){for(var n=0,t=this._deferreds;n<t.length;n++){var e=t[n];i.call(this,e)}this._deferreds=[]}function s(n,t,e,o){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof t?t:null,this.resolve=e,this.reject=o}var f=function(n,t,e){var o=!1;try{n((function(n){o||(o=!0,t(n))}),(function(n){o||(o=!0,e(n))}))}catch(n){if(o)return;o=!0,e(n)}};return n.prototype.catch=function(n){return this.then(null,n)},n.prototype.then=function(t,e){var o=this;return new n((function(n,r){i.call(o,new s(t,e,n,r))}))},n.all=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var o=Array.prototype.slice.call(1===t.length&&r(t[0])?t[0]:t);return new n((function(n,t){if(0===o.length)return n([]);for(var e=o.length,r=function(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(n){r(i,n)}),t)}o[i]=u,0==--e&&n(o)}catch(n){t(n)}},i=0;i<o.length;i++)r(i,o[i])}))},n.resolve=function(t){return t&&"object"==typeof t&&t.constructor===n?t:new n((function(n){n(t)}))},n.reject=function(t){return new n((function(n,e){e(t)}))},n.race=function(t){return new n((function(n,e){for(var o=0,r=t;o<r.length;o++){r[o].then(n,e)}}))},n}(),yk=function(n){return new bk((function(t,e){(function(n){var t=n.split(","),e=/data:([^;]+)/.exec(t[0]);if(!e)return b.none();for(var o=e[1],r=t[1],i=atob(r),u=i.length,a=Math.ceil(u/1024),c=new Array(a),s=0;s<a;++s){for(var f=1024*s,l=Math.min(f+1024,u),d=new Array(l-f),m=f,g=0;m<l;++g,++m)d[g]=i[m].charCodeAt(0);c[s]=new Uint8Array(d)}return b.some(new Blob(c,{type:o}))})(n).fold((function(){e("uri is not base64: "+n)}),t)}))},xk=function(n,t,e){return t=t||"image/png",T(HTMLCanvasElement.prototype.toBlob)?new bk((function(o,r){n.toBlob((function(n){n?o(n):r()}),t,e)})):yk(n.toDataURL(t,e))},wk=function(n){return function(n){return new bk((function(t,e){var o=URL.createObjectURL(n),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),t(r)},a=function(){i(),e("Unable to load data of type "+n.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(n).then((function(n){Sk(n);var t=dk(hk(n),vk(n));return gk(t).drawImage(n,0,0),t}))},Sk=function(n){URL.revokeObjectURL(n.src)},kk=function(n,t,e){var r=t.type,i=o(r),u=o(e),a=function(t,e){return n.then((function(n){return function(n,t,e){return t=t||"image/png",n.toDataURL(t,e)}(n,t,e)}))};return{getType:i,toBlob:function(){return bk.resolve(t)},toDataURL:u,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(t,e){return n.then((function(n){return xk(n,t,e)}))},toAdjustedDataURL:a,toAdjustedBase64:function(n,t){return a(n,t).then((function(n){return n.split(",")[1]}))},toCanvas:function(){return n.then(mk)}}},Ck=function(n){return function(n){return new bk((function(t){var e=new FileReader;e.onloadend=function(){t(e.result)},e.readAsDataURL(n)}))}(n).then((function(t){return kk(wk(n),n,t)}))},Ok=function(n,t){return xk(n,t).then((function(t){return kk(bk.resolve(n),t,n.toDataURL())}))},_k=function(n,t,e){var o="string"==typeof n?parseFloat(n):n;return o>e?o=e:o<t&&(o=t),o},Tk=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],Ek=function(n,t){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=t[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=n[u+5*a]*o[a];r[u+5*i]=e}}return r},Dk=function(n,t){return n.toCanvas().then((function(e){return Bk(e,n.getType(),t)}))},Bk=function(n,t,e){var o=gk(n),r=function(n,t){for(var e,o,r,i,u=n.data,a=t[0],c=t[1],s=t[2],f=t[3],l=t[4],d=t[5],m=t[6],g=t[7],p=t[8],h=t[9],v=t[10],b=t[11],y=t[12],x=t[13],w=t[14],S=t[15],k=t[16],C=t[17],O=t[18],_=t[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return n}(o.getImageData(0,0,n.width,n.height),e);return o.putImageData(r,0,0),Ok(n,t)},Ak=function(n,t,e){var o=gk(n),r=o.getImageData(0,0,n.width,n.height),i=o.getImageData(0,0,n.width,n.height);return i=function(n,t,e){for(var o=function(n,t,e){return n>e?n=e:n<t&&(n=t),n},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=n.data,a=t.data,c=n.width,s=n.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return t}(r,i,e),o.putImageData(i,0,0),Ok(n,t)},Mk=function(n){return function(t,e){return Dk(t,n([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},Fk=function(n){return function(t){return Dk(t,n)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),Ik=Mk((function(n,t){return t=_k(255*t,-255,255),Ek(n,[1,0,0,0,t,0,1,0,0,t,0,0,1,0,t,0,0,0,1,0,0,0,0,0,1])})),Rk=Mk((function(n,t){var e;return t=_k(t,-1,1),e=(t*=100)<0?127+t/100*127:127*(e=0===(e=t%1)?Tk[t]:Tk[Math.floor(t)]*(1-e)+Tk[Math.floor(t)+1]*e)+127,Ek(n,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),Vk=function(n,t,e,o){return Dk(n,function(n,t,e,o){return t=_k(t,0,2),e=_k(e,0,2),o=_k(o,0,2),Ek(n,[t,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],t,e,o))},Pk=(kx=[0,-1,0,-1,5,-1,0,-1,0],function(n){return function(n,t){return n.toCanvas().then((function(e){return Ak(e,n.getType(),t)}))}(n,kx)}),Hk=(Cx=function(n,t){return 255*Math.pow(n/255,1-t)},function(n,t){return n.toCanvas().then((function(e){return function(n,t,e){for(var o=gk(n),r=new Array(256),i=0;i<r.length;i++)r[i]=Cx(i,e);var u=function(n,t){for(var e=n.data,o=0;o<e.length;o+=4)e[o]=t[e[o]],e[o+1]=t[e[o+1]],e[o+2]=t[e[o+2]];return n}(o.getImageData(0,0,n.width,n.height),r);return o.putImageData(u,0,0),Ok(n,t)}(e,n.getType(),t)}))}),zk=function(n,t,e){var o=hk(n),r=vk(n),i=t/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=Nk(n,i,u);return a?c.then((function(n){return zk(n,t,e)})):c},Nk=function(n,t,e){return new bk((function(o){var r=hk(n),i=vk(n),u=Math.floor(r*t),a=Math.floor(i*e),c=dk(u,a);gk(c).drawImage(n,0,0,r,i,0,0,u,a),o(c)}))},Lk=function(n,t,e){var o=dk(n.width,n.height),r=gk(o),i=0,u=0;return 90!==(e=e<0?360+e:e)&&270!==e||pk(o,o.height,o.width),90!==e&&180!==e||(i=o.width),270!==e&&180!==e||(u=o.height),r.translate(i,u),r.rotate(e*Math.PI/180),r.drawImage(n,0,0),Ok(o,t)},jk=function(n,t,e){var o=dk(n.width,n.height),r=gk(o);return"v"===e?(r.scale(1,-1),r.drawImage(n,0,-o.height)):(r.scale(-1,1),r.drawImage(n,-o.width,0)),Ok(o,t)},Uk=function(n,t,e,o,r,i){var u=dk(r,i);return gk(u).drawImage(n,-e,-o),Ok(u,t)},Wk=function(n){return Fk(n)},Gk=function(n){return Pk(n)},Xk=function(n,t){return Hk(n,t)},Yk=function(n,t){return Ik(n,t)},qk=function(n,t){return Rk(n,t)},Jk=function(n,t){return function(n,t){return n.toCanvas().then((function(e){return jk(e,n.getType(),t)}))}(n,t)},Kk=function(n,t,e,o,r){return function(n,t,e,o,r){return n.toCanvas().then((function(i){return Uk(i,n.getType(),t,e,o,r)}))}(n,t,e,o,r)},$k=function(n,t,e){return function(n,t,e){return n.toCanvas().then((function(o){return zk(o,t,e).then((function(t){return Ok(t,n.getType())}))}))}(n,t,e)},Qk=function(n,t){return function(n,t){return n.toCanvas().then((function(e){return Lk(e,n.getType(),t)}))}(n,t)},Zk=function(n,t){return l({dom:{tag:"span",innerHtml:n,classes:["tox-icon","tox-tbtn__icon-wrap"]}},t)},nC=function(n,t){return Zk(op(n,t),{})},tC=function(n,t){return Zk(op(n,t),{behaviours:qa([ng.config({})])})},eC=function(n,t,e){return{dom:{tag:"span",innerHtml:e.translate(n),classes:[t+"__select-label"]},behaviours:qa([ng.config({})])}},oC=qr("toolbar.button.execute"),rC=((Ox={})[ho()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],Ox),iC=qr("update-menu-text"),uC=qr("update-menu-icon"),aC=function(n,e,o){var r=ce(t),u=n.text.map((function(n){return tp(eC(n,e,o.providers))})),a=n.icon.map((function(n){return tp(tC(n,o.providers.icons))})),c=function(n,t){var e=Ff.getValue(n);return ug.focus(e),Ho(e,"keydown",{raw:t.event.raw}),Hx.close(e),b.some(!0)},s=n.role.fold((function(){return{}}),(function(n){return{role:n}})),f=n.tooltip.fold((function(){return{}}),(function(n){var t=o.providers.translate(n);return{title:t,"aria-label":t}}));return tp(Hx.sketch(l(l(l({},n.uid?{uid:n.uid}:{}),s),{dom:{tag:"button",classes:[e,e+"--select"].concat(H(n.classes,(function(n){return e+"--"+n}))),attributes:l({},f)},components:Pv([a.map((function(n){return n.asSpec()})),u.map((function(n){return n.asSpec()})),b.some({dom:{tag:"div",classes:[e+"__select-chevron"],innerHtml:op("chevron-down",o.providers.icons)}})]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:qa(m(n.dropdownBehaviours,[Dv((function(){return n.disabled||o.providers.isDisabled()})),Tv(),Nx.config({}),ng.config({}),tg("dropdown-events",[Fv(n,r),Iv(n,r)]),tg("menubutton-update-display-text",[Xo(iC,(function(n,t){u.bind((function(t){return t.getOpt(n)})).each((function(n){ng.set(n,[ou(o.providers.translate(t.event.text))])}))})),Xo(uC,(function(n,t){a.bind((function(t){return t.getOpt(n)})).each((function(n){ng.set(n,[tC(t.event.icon,o.providers.icons)])}))}))])])),eventOrder:In(rC,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:qa([Jm.config({mode:"special",onLeft:c,onRight:c})]),lazySink:o.getSink,toggleClass:e+"--active",parts:{menu:rh(0,n.columns,n.presets)},fetch:function(t){return ux(i(n.fetch,t))}}))).asSpec()},cC=function(n){return"separator"===n.type},sC={type:"separator"},fC=function(n,t){var e=U(n,(function(n,e){return function(n){return w(n)}(e)?""===e?n:"|"===e?n.length>0&&!cC(n[n.length-1])?n.concat([sC]):n:Dn(t,e.toLowerCase())?n.concat([t[e.toLowerCase()]]):n:n.concat([e])}),[]);return e.length>0&&cC(e[e.length-1])&&e.pop(),e},lC=function(n,t){return function(n){return Dn(n,"getSubmenuItems")}(n)?function(n,t){var e=n.getSubmenuItems(),o=dC(e,t);return{item:n,menus:In(o.menus,Xn(n.value,o.items)),expansions:In(o.expansions,Xn(n.value,n.value))}}(n,t):{item:n,menus:{},expansions:{}}},dC=function(n,t){var e=fC(w(n)?n.split(" "):n,t);return j(e,(function(n,e){var o=function(n){if(cC(n))return n;var t=En(n,"value").getOrThunk((function(){return qr("generated-menu-item")}));return In({value:t},n)}(e),r=lC(o,t);return{menus:In(n.menus,r.menus),items:[r.item].concat(n.items),expansions:In(n.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},mC=function(n,t,e,o){var r=qr("primary-menu"),i=dC(n,e.shared.providers.menuItems());if(0===i.items.length)return b.none();var u=ey(r,i.items,t,e,o),a=Sn(i.menus,(function(n,o){return ey(o,n,t,e,!1)})),c=In(a,Xn(r,u));return b.from(Ng.tieredData(r,c,i.expansions))},gC=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)},setActive:function(t){var e=n.element;t?(_i(e,"tox-tbtn--enabled"),Pr(e,"aria-pressed",!0)):(Ei(e,"tox-tbtn--enabled"),Lr(e,"aria-pressed"))},isActive:function(){return Di(n.element,"tox-tbtn--enabled")}}},pC=function(n,t,e,o){return aC({text:n.text,icon:n.icon,tooltip:n.tooltip,role:o,fetch:function(t,o){n.fetch((function(n){o(mC(n,Xp.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:n.onSetup,getApi:gC,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ay.config({})]},t,e.shared)},hC=function(n,t,e){var o=function(n){return function(o){var r=!o.isActive();o.setActive(r),n.storage.set(r),e.shared.getSink().each((function(e){t().getOpt(e).each((function(t){ec(t.element),Ho(t,Ny,{name:n.name,value:n.storage.get()})}))}))}},r=function(n){return function(t){t.setActive(n.storage.get())}};return function(t){t(H(n,(function(n){var t=n.text.fold((function(){return{}}),(function(n){return{text:n}}));return l(l({type:n.type,active:!1},t),{onAction:o(n),onSetup:r(n)})})))}},vC=function(n,t,e,o,r,i){void 0===e&&(e=[]);var u=t.fold((function(){return{}}),(function(n){return{action:n}})),a=l({buttonBehaviours:qa([Dv((function(){return n.disabled||i.isDisabled()})),Tv(),Ay.config({}),tg("button press",[Go("click"),Go("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=In(a,{dom:o});return In(c,{components:r})},bC=function(n,t,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:n.tooltip.map((function(n){return{"aria-label":e.translate(n),title:e.translate(n)}})).getOr({})},i=n.icon.map((function(n){return nC(n,e.icons)})),u=Pv([i]);return vC(n,t,o,r,u,e)},yC=function(n,t,e,o){void 0===o&&(o=[]);var r=bC(n,b.some(t),e,o);return np.sketch(r)},xC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(n.text),u=n.icon?n.icon.map((function(n){return nC(n,e.icons)})):b.none(),a=u.isSome()?Pv([u]):[],c=u.isSome()?{}:{innerHtml:i},s=m(n.primary||n.borderless?["tox-button"]:["tox-button","tox-button--secondary"],u.isSome()?["tox-button--icon"]:[],n.borderless?["tox-button--naked"]:[],r),f=l(l({tag:"button",classes:s},c),{attributes:{title:i}});return vC(n,t,o,f,a,e)},wC=function(n,t,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=xC(n,b.some(t),e,o,r);return np.sketch(i)},SC=function(n,t){return function(e){"custom"===t?Ho(e,Ny,{name:n,value:{}}):"submit"===t?Po(e,Ly):"cancel"===t?Po(e,zy):console.error("Unknown button type: ",t)}},kC=function(n,e,o){if(function(n,t){return"menu"===t}(0,e)){var r=n,i=l(l({},n),{onSetup:function(e){return e.setDisabled(n.disabled),t},fetch:hC(r.items,(function(){return u}),o)}),u=tp(pC(i,"tox-tbtn",o,b.none()));return u.asSpec()}if(function(n,t){return"custom"===t||"cancel"===t||"submit"===t}(0,e)){var a=SC(n.name,e),c=l(l({},n),{borderless:!1});return wC(c,a,o.shared.providers,[])}console.error("Unknown footer button type: ",e)},CC=function(n,t){var e,o,r=SC(n.name,"custom");return e=b.none(),o=Ey.parts.field(l({factory:np},xC(n,b.some(r),t,[tk(""),jS()]))),Fy(e,o,[],[])},OC=o([Qt("field1Name","field1"),Qt("field2Name","field2"),ua("onLockedChange"),ea(["lockClass"]),Qt("locked",!1),Pf("coupledFieldBehaviours",[Ul,Ff])]),_C=function(n,t){return cl({factory:Ey,name:n,overrides:function(n){return{fieldBehaviours:qa([tg("coupled-input-behaviour",[Xo(ro(),(function(e){(function(n,t,e){return Sl(n,t,e).bind(Ul.getCurrent)})(e,n,t).each((function(t){Sl(e,n,"lock").each((function(o){bg.isOn(o)&&n.onLockedChange(e,t,o)}))}))}))])])}}})},TC=o([_C("field1","field2"),_C("field2","field1"),cl({factory:np,schema:[Pt("dom")],name:"lock",overrides:function(n){return{buttonBehaviours:qa([bg.config({selected:n.locked,toggleClass:n.markers.lockClass,aria:{mode:"pressed"}})])}}})]),EC=Pl({name:"FormCoupledInputs",configFields:OC(),partFields:TC(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Hf(n.coupledFieldBehaviours,[Ul.config({find:b.some}),Ff.config({store:{mode:"manual",getValue:function(t){var e,o=Tl(t,n,["field1","field2"]);return(e={})[n.field1Name]=Ff.getValue(o.field1()),e[n.field2Name]=Ff.getValue(o.field2()),e},setValue:function(t,e){var o=Tl(t,n,["field1","field2"]);Bn(e,n.field1Name)&&Ff.setValue(o.field1(),e[n.field1Name]),Bn(e,n.field2Name)&&Ff.setValue(o.field2(),e[n.field2Name])}}})]),apis:{getField1:function(t){return Sl(t,n,"field1")},getField2:function(t){return Sl(t,n,"field2")},getLock:function(t){return Sl(t,n,"lock")}}}},apis:{getField1:function(n,t){return n.getField1(t)},getField2:function(n,t){return n.getField2(t)},getLock:function(n,t){return n.getLock(t)}}}),DC=function(n){var t=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(n);if(null!==t){var e=parseFloat(t[1]),o=t[2];return un.value({value:e,unit:o})}return un.error(n)},BC=function(n,t){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(n){return Object.prototype.hasOwnProperty.call(e,n)};return n.unit===t?b.some(n.value):o(n.unit)&&o(t)?e[n.unit]===e[t]?b.some(n.value):b.some(n.value/e[n.unit]*e[t]):b.none()},AC=function(n){return b.none()},MC=function(n,t){var e,o,r,i=DC(n).toOptional(),u=DC(t).toOptional();return(e=i,o=u,r=function(n,t){return BC(n,t.unit).map((function(n){return t.value/n})).map((function(n){return function(n,t){return function(e){return BC(e,t).map((function(e){return{value:e*n,unit:t}}))}}(n,t.unit)})).getOr(AC)},e.isSome()&&o.isSome()?b.some(r(e.getOrDie(),o.getOrDie())):b.none()).getOr(AC)},FC=function(n,t){var e=AC,o=qr("ratio-event"),r=EC.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:t.translate(n.label.getOr("Constrain proportions"))}},components:[{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__lock"],innerHtml:op("lock",t.icons)}},{dom:{tag:"span",classes:["tox-icon","tox-lock-icon__unlock"],innerHtml:op("unlock",t.icons)}}],buttonBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()}}),Tv(),Ay.config({})])}),i=function(n){return{dom:{tag:"div",classes:["tox-form__group"]},components:n}},u=function(e){return Ey.parts.field({factory:$y,inputClasses:["tox-textfield"],inputBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()}}),Tv(),Ay.config({}),tg("size-input-events",[Xo(no(),(function(n,t){Ho(n,o,{isField1:e})})),Xo(io(),(function(t,e){Ho(t,Py,{name:n.name})}))])]),selectOnFocus:!1})},a=function(n){return{dom:{tag:"label",classes:["tox-label"],innerHtml:t.translate(n)}}},c=EC.parts.field1(i([Ey.parts.label(a("Width")),u(!0)])),s=EC.parts.field2(i([Ey.parts.label(a("Height")),u(!1)]));return EC.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[c,s,i([a("&nbsp;"),r])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(n,t,o){DC(Ff.getValue(n)).each((function(n){e(n).each((function(n){Ff.setValue(t,function(n){var t,e={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},o=n.value.toFixed((t=n.unit)in e?e[t]:1);return-1!==o.indexOf(".")&&(o=o.replace(/\.?0*$/,"")),o+n.unit}(n))}))}))},coupledFieldBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){EC.getField1(n).bind(Ey.getField).each($h.disable),EC.getField2(n).bind(Ey.getField).each($h.disable),EC.getLock(n).each($h.disable)},onEnabled:function(n){EC.getField1(n).bind(Ey.getField).each($h.enable),EC.getField2(n).bind(Ey.getField).each($h.enable),EC.getLock(n).each($h.enable)}}),Tv(),tg("size-input-events2",[Xo(o,(function(n,t){var o=t.event.isField1,r=o?EC.getField1(n):EC.getField2(n),i=o?EC.getField2(n):EC.getField1(n),u=r.map(Ff.getValue).getOr(""),a=i.map(Ff.getValue).getOr("");e=MC(u,a)}))])])})},IC={undo:o(qr("undo")),redo:o(qr("redo")),zoom:o(qr("zoom")),back:o(qr("back")),apply:o(qr("apply")),swap:o(qr("swap")),transform:o(qr("transform")),tempTransform:o(qr("temp-transform")),transformApply:o(qr("transform-apply"))},RC=o("save-state"),VC=o("disable"),PC=o("enable"),HC={formActionEvent:Ny,saveState:RC,disable:VC,enable:PC},zC=function(n,e){var r=function(n,t,o,r){return tp(wC({name:n,text:n,disabled:o,primary:r,icon:b.none(),borderless:!1},t,e))},i=function(n,t,o,r){return tp(yC({name:n,icon:b.some(n),tooltip:b.some(t),disabled:r,primary:!1,borderless:!1},o,e))},u=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured($h)&&$h.disable(e)}))},a=function(n,t){n.map((function(n){var e=n.get(t);e.hasConfigured($h)&&$h.enable(e)}))},c={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},s=t,f=function(n,t,e){Ho(n,t,e)},l=function(n){return Po(n,HC.disable())},d=function(n){return Po(n,HC.enable())},m=function(n,t){l(n),f(n,IC.transform(),{transform:t}),d(n)},g=function(n){return function(){nn.getOpt(n).each((function(n){ng.set(n,[Q])}))}},p=function(n,t){l(n),f(n,IC.transformApply(),{transform:t,swap:g(n)}),d(n)},h=function(){return r("Back",(function(n){return f(n,IC.back(),{swap:g(n)})}),!1,!1)},v=function(){return tp({dom:{tag:"div",classes:["tox-spacer"]},behaviours:qa([$h.config({})])})},y=function(){return r("Apply",(function(n){return f(n,IC.apply(),{swap:g(n)})}),!0,!0)},x=[h(),v(),r("Apply",(function(t){p(t,(function(t){var e=n.getRect();return Kk(t,e.x,e.y,e.w,e.h)})),n.hideCrop()}),!1,!0)],w=Cy.sketch({dom:c,components:x.map((function(n){return n.asSpec()})),containerBehaviours:qa([tg("image-tools-crop-buttons-events",[Xo(HC.disable(),(function(n,t){u(x,n)})),Xo(HC.enable(),(function(n,t){a(x,n)}))])])}),S=tp(FC({name:"size",label:b.none(),constrain:!0,disabled:!1},e)),k=[h(),v(),S,v(),r("Apply",(function(n){S.getOpt(n).each((function(t){var e=Ff.getValue(t),o=function(n,t){return function(e){return $k(e,n,t)}}(parseInt(e.width,10),parseInt(e.height,10));p(n,o)}))}),!1,!0)],C=Cy.sketch({dom:c,components:k.map((function(n){return n.asSpec()})),containerBehaviours:qa([tg("image-tools-resize-buttons-events",[Xo(HC.disable(),(function(n,t){u(k,n)})),Xo(HC.enable(),(function(n,t){a(k,n)}))])])}),O=function(n,t){return function(e){return n(e,t)}},_=O(Jk,"h"),T=O(Jk,"v"),E=O(Qk,-90),D=O(Qk,90),B=function(n,t){!function(n,t){l(n),f(n,IC.tempTransform(),{transform:t}),d(n)}(n,t)},A=[h(),v(),i("flip-horizontally","Flip horizontally",(function(n){B(n,_)}),!1),i("flip-vertically","Flip vertically",(function(n){B(n,T)}),!1),i("rotate-left","Rotate counterclockwise",(function(n){B(n,E)}),!1),i("rotate-right","Rotate clockwise",(function(n){B(n,D)}),!1),v(),y()],M=Cy.sketch({dom:c,components:A.map((function(n){return n.asSpec()})),containerBehaviours:qa([tg("image-tools-fliprotate-buttons-events",[Xo(HC.disable(),(function(n,t){u(A,n)})),Xo(HC.enable(),(function(n,t){a(A,n)}))])])}),F=function(n,t,r,i,u){var a=BS.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:e.translate(n)}}),c=BS.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),s=BS.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return tp(BS.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:r,maxX:u,getInitialValue:o({x:i})},components:[a,c,s],sliderBehaviours:qa([ug.config({})]),onChoose:t}))},I=function(n,t,e,o,r){return F(n,(function(n,e,o){var r=O(t,o.x/100);m(n,r)}),e,o,r)},R=function(n,t,e,o,r){var i=function(n,t,e,o,r){return[h(),I(n,t,e,o,r),y()]}(n,t,e,o,r);return Cy.sketch({dom:c,components:i.map((function(n){return n.asSpec()})),containerBehaviours:qa([tg("image-tools-filter-panel-buttons-events",[Xo(HC.disable(),(function(n,t){u(i,n)})),Xo(HC.enable(),(function(n,t){a(i,n)}))])])})},V=[h(),v(),y()],P=Cy.sketch({dom:c,components:V.map((function(n){return n.asSpec()}))}),H=R("Brightness",Yk,-100,0,100),z=R("Contrast",qk,-100,0,100),N=R("Gamma",Xk,-100,0,100),L=function(n,t,e){return function(o){return function(n,t,e,o){return Vk(n,t,e,o)}(o,n,t,e)}},j=function(n){return F(n,(function(n,t,e){var o=U.getOpt(n),r=G.getOpt(n),i=W.getOpt(n);o.each((function(t){r.each((function(e){i.each((function(o){var r=Ff.getValue(t).x/100,i=Ff.getValue(o).x/100,u=Ff.getValue(e).x/100,a=L(r,i,u);m(n,a)}))}))}))}),0,100,200)},U=j("R"),W=j("G"),G=j("B"),X=[h(),U,W,G,y()],Y=Cy.sketch({dom:c,components:X.map((function(n){return n.asSpec()}))}),q=function(n,t,e){return function(o){f(o,IC.swap(),{transform:t,swap:function(){nn.getOpt(o).each((function(t){ng.set(t,[n]),e(t)}))}})}},J=b.some(Gk),K=b.some(Wk),$=[i("crop","Crop",q(w,b.none(),(function(t){n.showCrop()})),!1),i("resize","Resize",q(C,b.none(),(function(t){S.getOpt(t).each((function(t){var e=n.getMeasurements(),o=e.width,r=e.height;Ff.setValue(t,{width:o,height:r})}))})),!1),i("orientation","Orientation",q(M,b.none(),s),!1),i("brightness","Brightness",q(H,b.none(),s),!1),i("sharpen","Sharpen",q(P,J,s),!1),i("contrast","Contrast",q(z,b.none(),s),!1),i("color-levels","Color levels",q(Y,b.none(),s),!1),i("gamma","Gamma",q(N,b.none(),s),!1),i("invert","Invert",q(P,K,s),!1)],Q=Cy.sketch({dom:c,components:$.map((function(n){return n.asSpec()}))}),Z=Cy.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:qa([ng.config({})])}),nn=tp(Z);return{memContainer:nn,getApplyButton:function(n){return nn.getOpt(n).map((function(n){var t=n.components()[0];return t.components()[t.components().length-1]}))}}},NC=tinymce.util.Tools.resolve("tinymce.geom.Rect"),LC=tinymce.util.Tools.resolve("tinymce.dom.DomQuery"),jC=tinymce.util.Tools.resolve("tinymce.util.Observable"),UC=tinymce.util.Tools.resolve("tinymce.util.VK"),WC=function(n){var t,e;if(n.changedTouches)for(t="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<t.length;e++)n[t[e]]=n.changedTouches[0][t[e]]};function GC(n,t){var e,o,r,i,u=t.document||document,a=u.getElementById(t.handle||n),c=function(n){if(WC(n),n.button!==o)return s(n);n.deltaX=n.screenX-r,n.deltaY=n.screenY-i,n.preventDefault(),t.drag(n)},s=function(n){WC(n),LC(u).off("mousemove touchmove",c).off("mouseup touchend",s),e.remove(),t.stop&&t.stop(n)};return LC(a).on("mousedown touchstart",(function(n){var f,l=function(n){var t=Math.max,e=n.documentElement,o=n.body,r=t(e.scrollWidth,o.scrollWidth),i=t(e.clientWidth,o.clientWidth),u=t(e.offsetWidth,o.offsetWidth),a=t(e.scrollHeight,o.scrollHeight),c=t(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<t(e.offsetHeight,o.offsetHeight)?c:a}}(u);WC(n),n.preventDefault(),o=n.button;var d=a;r=n.screenX,i=n.screenY,f=window.getComputedStyle?window.getComputedStyle(d,null).getPropertyValue("cursor"):d.runtimeStyle.cursor,e=LC("<div></div>").css({position:"absolute",top:0,left:0,width:l.width,height:l.height,zIndex:2147483647,opacity:1e-4,cursor:f}).appendTo(u.body),LC(u).on("mousemove touchmove",c).on("mouseup touchend",s),t.start(n)})),{destroy:function(){LC(a).off()}}}var XC=0,YC=function(n,t,e,o,r){var i,u="tox-crid-"+XC++,a=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],c=["top","right","bottom","left"],s=function(n,t){return{x:t.x-n.x,y:t.y-n.y,w:t.w,h:t.h}},f=function(t,o,r,i){var u,a,c,f,l;u=o.x,a=o.y,c=o.w,f=o.h,u+=r*t.deltaX,a+=i*t.deltaY,(c+=r*t.deltaW)<20&&(c=20),(f+=i*t.deltaH)<20&&(f=20),l=n=NC.clamp({x:u,y:a,w:c,h:f},e,"move"===t.name),l=s(e,l),g.fire("updateRect",{rect:l}),m(l)},l=function(n){var e=function(n,t){t.h<0&&(t.h=0),t.w<0&&(t.w=0),LC("#"+u+"-"+n,o).css({left:t.x,top:t.y,width:t.w,height:t.h})};qS.each(a,(function(t){LC("#"+u+"-"+t.name,o).css({left:n.w*t.xMul+n.x,top:n.h*t.yMul+n.y})})),e("top",{x:t.x,y:t.y,w:t.w,h:n.y-t.y}),e("right",{x:n.x+n.w,y:n.y,w:t.w-n.x-n.w+t.x,h:n.h}),e("bottom",{x:t.x,y:n.y+n.h,w:t.w,h:t.h-n.y-n.h+t.y}),e("left",{x:t.x,y:n.y,w:n.x-t.x,h:n.h}),e("move",n)},d=function(t){l(n=t)},m=function(n){var t,o;d((t=e,{x:(o=n).x+t.x,y:o.y+t.y,w:o.w,h:o.h}))};LC('<div id="'+u+'" class="tox-croprect-container" role="grid" aria-dropeffect="execute">').appendTo(o),qS.each(c,(function(n){LC("#"+u,o).append('<div id="'+u+"-"+n+'"class="tox-croprect-block" style="display: none" data-mce-bogus="all">')})),qS.each(a,(function(n){LC("#"+u,o).append('<div id="'+u+"-"+n.name+'" class="tox-croprect-handle tox-croprect-handle-'+n.name+'"style="display: none" data-mce-bogus="all" role="gridcell" tabindex="-1" aria-label="'+n.label+'" aria-grabbed="false" title="'+n.label+'">')})),i=qS.map(a,(function(t){var e;return GC(u,{document:o.ownerDocument,handle:u+"-"+t.name,start:function(){e=n},drag:function(n){f(t,e,n.deltaX,n.deltaY)}})})),l(n),LC(o).on("focusin focusout",(function(n){LC(n.target).attr("aria-grabbed","focus"===n.type?"true":"false")})),LC(o).on("keydown",(function(t){var e;qS.each(a,(function(n){if(t.target.id===u+"-"+n.name)return e=n,!1}));var o=function(n,t,o,r,i){n.stopPropagation(),n.preventDefault(),f(e,o,r,i)};switch(t.keyCode){case UC.LEFT:o(t,0,n,-10,0);break;case UC.RIGHT:o(t,0,n,10,0);break;case UC.UP:o(t,0,n,0,-10);break;case UC.DOWN:o(t,0,n,0,10);break;case UC.ENTER:case UC.SPACEBAR:t.preventDefault(),r()}}));var g=qS.extend({toggleVisibility:function(n){var t=qS.map(a,(function(n){return"#"+u+"-"+n.name})).concat(qS.map(c,(function(n){return"#"+u+"-"+n}))).join(",");n?LC(t,o).show():LC(t,o).hide()},setClampRect:function(t){e=t,l(n)},setRect:d,getInnerRect:function(){return s(e,n)},setInnerRect:m,setViewPortRect:function(e){t=e,l(n)},destroy:function(){qS.each(i,(function(n){n.destroy()})),i=[]}},jC);return g},qC=function(n){var e=tp({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),o=ce(1),r=ce(b.none()),i=ce({x:0,y:0,w:1,h:1}),u=ce({x:0,y:0,w:1,h:1}),a=function(n,t){f.getOpt(n).each((function(n){var u=o.get(),a=bu(n.element),c=fu(n.element),s=t.dom.naturalWidth*u,f=t.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};zi(t,m),e.getOpt(n).each((function(n){zi(n.element,m)})),r.get().each((function(n){var t=i.get();n.setRect({x:t.x*u+l,y:t.y*u+d,w:t.w*u,h:t.h*u}),n.setClampRect({x:l,y:d,w:s,h:f}),n.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},c=function(n,t){var e,r=fe.fromTag("img");return Pr(r,"src",t),(e=r.dom,new xp((function(n){var t=function(){e.removeEventListener("load",t),n(e)};e.complete?n(e):e.addEventListener("load",t)}))).then((function(){return f.getOpt(n).map((function(n){var t=ru({element:r});ng.replaceAt(n,1,b.some(t));var e=u.get(),c={x:0,y:0,w:r.dom.naturalWidth,h:r.dom.naturalHeight};u.set(c);var s=NC.inflate(c,-20,-20);return i.set(s),e.w===c.w&&e.h===c.h||function(n,t){f.getOpt(n).each((function(n){var e=bu(n.element),r=fu(n.element),i=t.dom.naturalWidth,u=t.dom.naturalHeight,a=Math.min(e/i,r/u);a>=1?o.set(1):o.set(a)}))}(n,r),a(n,r),r}))}))},s=Cy.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[e.asSpec(),{dom:{tag:"img",attributes:{src:n}}},{dom:{tag:"div"},behaviours:qa([tg("image-panel-crop-events",[nr((function(n){f.getOpt(n).each((function(n){var e=n.element.dom,u=YC({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},e,t);u.toggleVisibility(!1),u.on("updateRect",(function(n){var t=n.rect,e=o.get(),r={x:Math.round(t.x/e),y:Math.round(t.y/e),w:Math.round(t.w/e),h:Math.round(t.h/e)};i.set(r)})),r.set(b.some(u))}))}))])])}],containerBehaviours:qa([ng.config({}),tg("image-panel-events",[nr((function(t){c(t,n)}))])])}),f=tp(s);return{memContainer:f,updateSrc:c,zoom:function(n,t){var e=o.get(),r=t>0?Math.min(2,e+.1):Math.max(.1,e-.1);o.set(r),f.getOpt(n).each((function(n){var t=n.components()[1].element;a(n,t)}))},showCrop:function(){r.get().each((function(n){n.toggleVisibility(!0)}))},hideCrop:function(){r.get().each((function(n){n.toggleVisibility(!1)}))},getRect:function(){return i.get()},getMeasurements:function(){var n=u.get();return{width:n.w,height:n.h}}}},JC=function(n,t,e,o,r){return yC({name:n,icon:b.some(t),disabled:e,tooltip:b.some(n),primary:!1,borderless:!1},o,r)},KC=function(n,t){t?$h.enable(n):$h.disable(n)};var $C,QC=function(n){var e,o,r,i,u=ce(n),a=ce(b.none()),c=(o=-1,{data:e=[],add:function(n){var t=e.splice(++o);return e.push(n),{state:n,removed:t}},undo:function(){if(r())return e[--o]},redo:function(){if(i())return e[++o]},canUndo:r=function(){return o>0},canRedo:i=function(){return-1!==o&&o<e.length-1}});c.add(n);var s=function(n){u.set(n)},f=function(n){return{blob:n,url:URL.createObjectURL(n)}},l=function(n){URL.revokeObjectURL(n.url)},d=function(){a.get().each(l),a.set(b.none())},m=function(n){var t=f(n);s(t);var e,o=c.add(t).removed;return e=o,qS.each(e,l),t.url};return{getBlobState:function(){return u.get()},setBlobState:s,addBlobState:m,getTempState:function(){return a.get().fold((function(){return u.get()}),(function(n){return n}))},updateTempState:function(n){var t=f(n);return d(),a.set(b.some(t)),t.url},addTempState:function(n){var t=f(n);return a.set(b.some(t)),t.url},applyTempState:function(n){return a.get().fold(t,(function(t){m(t.blob),n()}))},destroyTempState:d,undo:function(){var n=c.undo();return s(n),n.url},redo:function(){var n=c.redo();return s(n),n.url},getHistoryStates:function(){return{undoEnabled:c.canUndo(),redoEnabled:c.canRedo()}}}},ZC=function(n,e){var o=QC(n.currentState),r=function(n){var t=o.getHistoryStates();m.updateButtonUndoStates(n,t.undoEnabled,t.redoEnabled),Ho(n,HC.formActionEvent,{name:HC.saveState(),value:t.undoEnabled})},i=function(n){return n.toBlob()},u=function(n){Ho(n,HC.formActionEvent,{name:HC.disable(),value:{}})},a=function(n){g.getApplyButton(n).each((function(n){$h.enable(n)})),Ho(n,HC.formActionEvent,{name:HC.enable(),value:{}})},c=function(n,t){return u(n),d.updateSrc(n,t)},s=function(n,t,e,o,s){return u(n),function(n){return Ck(n)}(t).then(e).then(i).then(o).then((function(t){return c(n,t).then((function(t){return r(n),s(),a(n),t}))})).catch((function(t){return console.log(t),a(n),t}))},f=function(n,t,e){var r=o.getBlobState().blob;s(n,r,t,(function(n){return o.updateTempState(n)}),e)},l=function(n){var t=o.getBlobState().url;return o.destroyTempState(),r(n),t},d=qC(n.currentState.url),m=function(n){var t=tp(JC("Undo","undo",!0,(function(n){Ho(n,IC.undo(),{direction:1})}),n)),e=tp(JC("Redo","redo",!0,(function(n){Ho(n,IC.redo(),{direction:1})}),n));return{container:Cy.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[t.asSpec(),e.asSpec(),JC("Zoom in","zoom-in",!1,(function(n){Ho(n,IC.zoom(),{direction:1})}),n),JC("Zoom out","zoom-out",!1,(function(n){Ho(n,IC.zoom(),{direction:-1})}),n)]}),updateButtonUndoStates:function(n,o,r){t.getOpt(n).each((function(n){KC(n,o)})),e.getOpt(n).each((function(n){KC(n,r)}))}}}(e),g=zC(d,e);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[g.memContainer.asSpec(),d.memContainer.asSpec(),m.container],behaviours:qa([Ff.config({store:{mode:"manual",getValue:function(){return o.getBlobState()}}}),tg("image-tools-events",[Xo(IC.undo(),(function(n,t){var e=o.undo();c(n,e).then((function(t){a(n),r(n)}))})),Xo(IC.redo(),(function(n,t){var e=o.redo();c(n,e).then((function(t){a(n),r(n)}))})),Xo(IC.zoom(),(function(n,t){var e=t.event.direction;d.zoom(n,e)})),Xo(IC.back(),(function(n,t){!function(n){var t=l(n);c(n,t).then((function(t){a(n)}))}(n),(0,t.event.swap)(),d.hideCrop()})),Xo(IC.apply(),(function(n,t){o.applyTempState((function(){l(n),(0,t.event.swap)()}))})),Xo(IC.transform(),(function(n,e){return f(n,e.event.transform,t)})),Xo(IC.tempTransform(),(function(n,e){return function(n,e){var r=o.getTempState().blob;s(n,r,e,(function(n){return o.addTempState(n)}),t)}(n,e.event.transform)})),Xo(IC.transformApply(),(function(n,t){return function(n,t,e){var r=o.getBlobState().blob;s(n,r,t,(function(t){var e=o.addBlobState(t);return l(n),e}),e)}(n,t.event.transform,t.event.swap)})),Xo(IC.swap(),(function(n,t){!function(n){m.updateButtonUndoStates(n,!1,!1)}(n);var e=t.event.transform,o=t.event.swap;e.fold((function(){o()}),(function(t){f(n,t,o)}))}))]),jS()])}},nO=function(n){return!Dn(n,"items")},tO=function(n,t,e,o){return H(e,(function(e){return nO(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Ff.setValue(n,e.value),Ho(n,Py,{name:t}),ug.focus(n)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return tO(n,t,e.items,o)}}}))},eO=function(n,t){return en(n,(function(n){return nO(n)?zl(n.value===t,n):eO(n.items,t)}))},oO=Vl({name:"HtmlSelect",configFields:[Pt("options"),If("selectBehaviours",[ug,Ff]),Qt("selectClasses",[]),Qt("selectAttributes",{}),Xt("data")],factory:function(n,t){var e=H(n.options,(function(n){return{dom:{tag:"option",value:n.value,innerHtml:n.text}}})),o=n.data.map((function(n){return Xn("initialValue",n)})).getOr({});return{uid:n.uid,dom:{tag:"select",classes:n.selectClasses,attributes:n.selectAttributes},components:e,behaviours:Vf(n.selectBehaviours,[ug.config({}),Ff.config({store:l({mode:"manual",getValue:function(n){return qi(n.element)},setValue:function(t,e){W(n.options,(function(n){return n.value===e})).isSome()&&Ji(t.element,e)}},o)})])}}}),rO=function(n,t){var e=n.label.map((function(n){return Vy(n,t)})),r=[$h.config({disabled:function(){return n.disabled||t.isDisabled()}}),Tv(),Jm.config({mode:"execution",useEnter:!0!==n.multiline,useControlEnter:!0===n.multiline,execute:function(n){return Po(n,Ly),b.some(!0)}}),tg("textfield-change",[Xo(ro(),(function(t,e){Ho(t,Py,{name:n.name})})),Xo(go(),(function(t,e){Ho(t,Py,{name:n.name})}))]),Ay.config({})],i=n.validation.map((function(n){return vx.config({getRoot:function(n){return gr(n.element)},invalidClass:"tox-invalid",validator:{validate:function(t){var e=Ff.getValue(t),o=n.validator(e);return ax(!0===o?un.value(e):un.error(o))},validateOnLoad:n.validateOnLoad}})})).toArray(),u=n.placeholder.fold(o({}),(function(n){return{placeholder:t.translate(n)}})),a=n.inputMode.fold(o({}),(function(n){return{inputmode:n}})),c=l(l({},u),a),s=Ey.parts.field({tag:!0===n.multiline?"textarea":"input",inputAttributes:c,inputClasses:[n.classname],inputBehaviours:qa(X([r,i])),selectOnFocus:!1,factory:$y}),f=(n.flex?["tox-form__group--stretched"]:[]).concat(n.maximized?["tox-form-group--maximize"]:[]),d=[$h.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){Ey.getField(n).each($h.disable)},onEnabled:function(n){Ey.getField(n).each($h.enable)}}),Tv()];return Fy(e,s,f,d)},iO=Object.freeze({__proto__:null,events:function(n,t){var e=n.stream.streams.setup(n,t);return Uo([Xo(n.event,e),tr((function(){return t.cancel()}))].concat(n.cancelEvent.map((function(n){return[Xo(n,(function(){return t.cancel()}))]})).getOr([])))}}),uO=function(n){var t=ce(null);return li({readState:function(){return{timer:null!==t.get()?"set":"unset"}},setTimer:function(n){t.set(n)},cancel:function(){var n=t.get();null!==n&&n.cancel()}})},aO=Object.freeze({__proto__:null,throttle:uO,init:function(n){return n.stream.streams.state(n)}}),cO=[Ht("stream",Tt("mode",{throttle:[Pt("delay"),Qt("stopEvent",!0),ca("streams",{setup:function(n,t){var e=n.stream,o=sp(n.onStream,e.delay);return t.setTimer(o),function(n,t){o.throttle(n,t),e.stopEvent&&t.stop()}},state:uO})]})),Qt("event","input"),Xt("cancelEvent"),ua("onStream")],sO=Ka({fields:cO,name:"streaming",active:iO,state:aO}),fO=function(n,t,e){var o=Ff.getValue(e);Ff.setValue(t,o),dO(t)},lO=function(n,t){var e=n.element,o=qi(e),r=e.dom;"number"!==Hr(e,"type")&&t(r,o)},dO=function(n){lO(n,(function(n,t){return n.setSelectionRange(t.length,t.length)}))},mO=function(n,t,e){if(n.selectsOver){var o=Ff.getValue(t),r=n.getDisplayText(o),i=Ff.getValue(e);return 0===n.getDisplayText(i).indexOf(r)?b.some((function(){fO(0,t,e),function(n,t){lO(n,(function(n,e){return n.setSelectionRange(t,e.length)}))}(t,r.length)})):b.none()}return b.none()},gO=o("alloy.typeahead.itemexecute"),pO=o([Xt("lazySink"),Pt("fetch"),Qt("minChars",5),Qt("responseTime",1e3),ra("onOpen"),Qt("getHotspot",b.some),Qt("getAnchorOverrides",o({})),Qt("layouts",b.none()),Qt("eventOrder",{}),ue("model",{},[Qt("getDisplayText",(function(n){return void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.value})),Qt("selectsOver",!0),Qt("populateFromBrowse",!0)]),ra("onSetValue"),ia("onExecute"),ra("onItemExecute"),Qt("inputClasses",[]),Qt("inputAttributes",{}),Qt("inputStyles",{}),Qt("matchWidth",!0),Qt("useMinWidth",!1),Qt("dismissOnBlur",!0),ea(["openClass"]),Xt("initialData"),If("typeaheadBehaviours",[ug,Ff,sO,Jm,bg,xx]),ae("previewing",(function(){return ce(!0)}))].concat(Yy()).concat(Rx())),hO=o([sl({schema:[ta()],name:"menu",overrides:function(n){return{fakeFocus:!0,onHighlight:function(t,e){n.previewing.get()?t.getSystem().getByUid(n.uid).each((function(o){mO(n.model,o,e).fold((function(){return nd.dehighlight(t,e)}),(function(n){return n()}))})):t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&fO(n.model,t,e)})),n.previewing.set(!1)},onExecute:function(t,e){return t.getSystem().getByUid(n.uid).toOptional().map((function(n){return Ho(n,gO(),{item:e}),!0}))},onHover:function(t,e){n.previewing.set(!1),t.getSystem().getByUid(n.uid).each((function(t){n.model.populateFromBrowse&&fO(n.model,t,e)}))}}}})]),vO=Pl({name:"Typeahead",configFields:pO(),partFields:hO(),factory:function(n,e,o,r){var i=function(e,o,i){n.previewing.set(!1);var u=xx.getCoupled(e,"sandbox");if(mf.isOpen(u))Ul.getCurrent(u).each((function(n){nd.getHighlighted(n).fold((function(){i(n)}),(function(){jo(u,n.element,"keydown",o)}))}));else{Tx(n,a(e),e,u,r,(function(n){Ul.getCurrent(n).each(i)}),nx.HighlightFirst).get(t)}},u=qy(n),a=function(n){return function(t){return t.map((function(t){var e=Tn(t.menus),o=Y(e,(function(n){return L(n.items,(function(n){return"item"===n.type}))}));return Ff.getState(n).update(H(o,(function(n){return n.data}))),t}))}},c=[ug.config({}),Ff.config({onSetValue:n.onSetValue,store:l({mode:"dataset",getDataKey:function(n){return qi(n.element)},getFallbackEntry:function(n){return{value:n,meta:{}}},setValue:function(t,e){Ji(t.element,n.model.getDisplayText(e))}},n.initialData.map((function(n){return Xn("initialValue",n)})).getOr({}))}),sO.config({stream:{mode:"throttle",delay:n.responseTime,stopEvent:!1},onStream:function(e,o){var i=xx.getCoupled(e,"sandbox");if(ug.isFocused(e)&&qi(e.element).length>=n.minChars){var u=Ul.getCurrent(i).bind((function(n){return nd.getHighlighted(n).map(Ff.getValue)}));n.previewing.set(!0);Tx(n,a(e),e,i,r,(function(t){Ul.getCurrent(i).each((function(t){u.fold((function(){n.model.selectsOver&&nd.highlightFirst(t)}),(function(n){nd.highlightBy(t,(function(t){return Ff.getValue(t).value===n.value})),nd.getHighlighted(t).orThunk((function(){return nd.highlightFirst(t),b.none()}))}))}))}),nx.HighlightFirst).get(t)}},cancelEvent:wo()}),Jm.config({mode:"special",onDown:function(n,t){return i(n,t,nd.highlightFirst),b.some(!0)},onEscape:function(n){var t=xx.getCoupled(n,"sandbox");return mf.isOpen(t)?(mf.close(t),b.some(!0)):b.none()},onUp:function(n,t){return i(n,t,nd.highlightLast),b.some(!0)},onEnter:function(t){var e=xx.getCoupled(t,"sandbox"),o=mf.isOpen(e);if(o&&!n.previewing.get())return Ul.getCurrent(e).bind((function(n){return nd.getHighlighted(n)})).map((function(n){return Ho(t,gO(),{item:n}),!0}));var r=Ff.getValue(t);return Po(t,wo()),n.onExecute(e,t,r),o&&mf.close(e),b.some(!0)}}),bg.config({toggleClass:n.markers.openClass,aria:{mode:"expanded"}}),xx.config({others:{sandbox:function(t){return Fx(n,t,{onOpen:function(){return bg.on(t)},onClose:function(){return bg.off(t)}})}}}),tg("typeaheadevents",[or((function(e){var o=t;Dx(n,a(e),e,r,o,nx.HighlightFirst).get(t)})),Xo(gO(),(function(t,e){var o=xx.getCoupled(t,"sandbox");fO(n.model,t,e.event.item),Po(t,wo()),n.onItemExecute(t,o,e.event.item,Ff.getValue(t)),mf.close(o),dO(t)}))].concat(n.dismissOnBlur?[Xo(mo(),(function(n){var t=xx.getCoupled(n,"sandbox");rc(t.element).isNone()&&mf.close(t)}))]:[]))];return{uid:n.uid,dom:Ky(In(n,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:l(l({},u),Vf(n.typeaheadBehaviours,c)),eventOrder:n.eventOrder}}}),bO=function(n){return l(l({},n),{toCached:function(){return bO(n.toCached())},bindFuture:function(t){return bO(n.bind((function(n){return n.fold((function(n){return ax(un.error(n))}),(function(n){return t(n)}))})))},bindResult:function(t){return bO(n.map((function(n){return n.bind(t)})))},mapResult:function(t){return bO(n.map((function(n){return n.map(t)})))},mapError:function(t){return bO(n.map((function(n){return n.mapError(t)})))},foldResult:function(t,e){return n.map((function(n){return n.fold(t,e)}))},withTimeout:function(t,e){return bO(ux((function(o){var r=!1,i=setTimeout((function(){r=!0,o(un.error(e()))}),t);n.get((function(n){r||(clearTimeout(i),o(n))}))})))}})},yO=function(n){return bO(ux(n))},xO=yO,wO={type:"separator"},SO=function(n){return{type:"menuitem",value:n.url,text:n.title,meta:{attach:n.attach},onAction:t}},kO=function(n,e){return{type:"menuitem",value:e,text:n,meta:{attach:void 0},onAction:t}},CO=function(n,t){return function(n){return H(n,SO)}(function(n,t){return L(t,(function(t){return t.type===n}))}(n,t))},OO=function(n){return CO("header",n.targets)},_O=function(n){return CO("anchor",n.targets)},TO=function(n){return b.from(n.anchorTop).map((function(n){return kO("<top>",n)})).toArray()},EO=function(n){return b.from(n.anchorBottom).map((function(n){return kO("<bottom>",n)})).toArray()},DO=function(n,t){var e=n.toLowerCase();return L(t,(function(n){var t=void 0!==n.meta&&void 0!==n.meta.text?n.meta.text:n.text;return ve(t.toLowerCase(),e)||ve(n.value.toLowerCase(),e)}))},BO=function(n,t,e){var o=Ff.getValue(t),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(t){var o,i=DO(r,function(n){return H(n,(function(n){return kO(n,n)}))}(e.getHistory(n)));return"file"===n?(o=[i,DO(r,OO(t)),DO(r,X([TO(t),_O(t),EO(t)]))],U(o,(function(n,t){return 0===n.length||0===t.length?n.concat(t):n.concat(wO,t)}),[])):i}))},AO=qr("aria-invalid"),MO=function(n){return function(t,e,o){return En(e,"name").fold((function(){return n(e,o)}),(function(r){return t.field(r,n(e,o))}))}},FO={bar:MO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:H(n.items,t.interpreter)}}(n,t.shared)})),collection:MO((function(n,t){return Xy(n,t.shared.providers)})),alertbanner:MO((function(n,t){return function(n,t){return Cy.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+n.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[np.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:op(n.icon,t.icons),attributes:{title:t.translate(n.iconTooltip)}},action:function(t){Ho(t,Ny,{name:"alert-banner",value:n.url})}})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:t.translate(n.text)}}]})}(n,t.shared.providers)})),input:MO((function(n,t){return function(n,t){return rO({name:n.name,multiline:!1,label:n.label,inputMode:n.inputMode,placeholder:n.placeholder,flex:!1,disabled:n.disabled,classname:"tox-textfield",validation:b.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),textarea:MO((function(n,t){return function(n,t){return rO({name:n.name,multiline:!0,label:n.label,inputMode:b.none(),placeholder:n.placeholder,flex:!0,disabled:n.disabled,classname:"tox-textarea",validation:b.none(),maximized:n.maximized},t)}(n,t.shared.providers)})),label:MO((function(n,t){return function(n,t){var e={dom:{tag:"label",innerHtml:t.providers.translate(n.label),classes:["tox-label"]}},o=H(n.items,t.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:qa([jS(),ng.config({}),nk(b.none()),Jm.config({mode:"acyclic"})])}}(n,t.shared)})),iframe:function(n){return function(t,e,o){var r=In(e,{source:"dynamic"});return MO(n)(t,r,o)}}((function(n,t){return lk(n,t.shared.providers)})),button:MO((function(n,t){return CC(n,t.shared.providers)})),checkbox:MO((function(n,t){return function(n,t){var e=Ff.config({store:{mode:"manual",getValue:function(n){return n.element.dom.checked},setValue:function(n,t){n.element.dom.checked=t}}}),o=function(n){return n.element.dom.click(),b.some(!0)},i=Ey.parts.field({factory:{sketch:r},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:qa([jS(),$h.config({disabled:function(){return n.disabled||t.isDisabled()}}),Ay.config({}),ug.config({}),e,Jm.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),tg("checkbox-events",[Xo(io(),(function(t,e){Ho(t,Py,{name:n.name})}))])])}),u=Ey.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:t.translate(n.label)},behaviours:qa([Nx.config({})])}),a=function(n){return{dom:{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+n],innerHtml:op("checked"===n?"selected":"unselected",t.icons)}}},c=tp({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[a("checked"),a("unchecked")]});return Ey.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[i,c.asSpec(),u],fieldBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(n){Ey.getField(n).each($h.disable)},onEnabled:function(n){Ey.getField(n).each($h.enable)}}),Tv()])})}(n,t.shared.providers)})),colorinput:MO((function(n,t){return Wx(n,t.shared,t.colorinput)})),colorpicker:MO((function(n){var t=function(n){return"tox-"+n},e=LS(XS,t),o=tp(e.sketch({dom:{tag:"div",classes:[t("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(n){Ho(n,Ny,{name:"hex-valid",value:!0})},onInvalidHex:function(n){Ho(n,Ny,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:qa([Ff.config({store:{mode:"manual",getValue:function(n){var t=o.get(n);return Ul.getCurrent(t).bind((function(n){return Ff.getValue(n).hex})).map((function(n){return"#"+n})).getOr("")},setValue:function(n,t){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(t),r=o.get(n);Ul.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(n){Ff.setValue(n,{hex:b.from(e[1]).getOr("")}),RS.getField(n,"hex").each((function(n){Po(n,ro())}))}))}}}),jS()])}})),dropzone:MO((function(n,t){return ek(n,t.shared.providers)})),grid:MO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+n.columns+"col"]},components:H(n.items,t.interpreter)}}(n,t.shared)})),listbox:MO((function(n,e){return function(n,e){var r=e.shared.providers,i=Z(n.items).filter(nO),u=n.label.map((function(n){return Vy(n,r)})),a={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Ey.parts.field({dom:{},factory:{sketch:function(r){return aC({uid:r.uid,text:i.map((function(n){return n.text})),icon:b.none(),tooltip:n.label,role:b.none(),fetch:function(t,o){var r=tO(t,n.name,n.items,Ff.getValue(t));o(mC(r,Xp.CLOSE_ON_EXECUTE,e,!1))},onSetup:o(t),getApi:o({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Ay.config({}),Ff.config({store:{mode:"manual",initialValue:i.map((function(n){return n.value})).getOr(""),getValue:function(n){return Hr(n.element,"data-value")},setValue:function(t,e){eO(n.items,e).each((function(n){Pr(t.element,"data-value",n.value),Ho(t,iC,{text:n.text})}))}}})]},"tox-listbox",e.shared)}}})]};return Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:X([u.toArray(),[a]]),fieldBehaviours:qa([$h.config({disabled:o(n.disabled),onDisabled:function(n){Ey.getField(n).each($h.disable)},onEnabled:function(n){Ey.getField(n).each($h.enable)}})])})}(n,e)})),selectbox:MO((function(n,t){return function(n,t){var e=H(n.items,(function(n){return{text:t.translate(n.text),value:n.value}})),o=n.label.map((function(n){return Vy(n,t)})),r=Ey.parts.field({dom:{},selectAttributes:{size:n.size},options:e,factory:oO,selectBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()}}),Ay.config({}),tg("selectbox-change",[Xo(io(),(function(t,e){Ho(t,Py,{name:n.name})}))])])}),i=n.size>1?b.none():b.some({dom:{tag:"div",classes:["tox-selectfield__icon-js"],innerHtml:op("chevron-down",t.icons)}}),u={dom:{tag:"div",classes:["tox-selectfield"]},components:X([[r],i.toArray()])};return Ey.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:X([o.toArray(),[u]]),fieldBehaviours:qa([$h.config({disabled:function(){return n.disabled||t.isDisabled()},onDisabled:function(n){Ey.getField(n).each($h.disable)},onEnabled:function(n){Ey.getField(n).each($h.enable)}}),Tv()])})}(n,t.shared.providers)})),sizeinput:MO((function(n,t){return FC(n,t.shared.providers)})),urlinput:MO((function(n,e){return function(n,e,o){var r,i=e.shared.providers,u=function(t){var e=Ff.getValue(t);o.addToHistory(e.value,n.filetype)},a=Ey.parts.field({factory:vO,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":AO,type:"url"},minChars:0,responseTime:0,fetch:function(t){var r=BO(n.filetype,t,o),i=mC(r,Xp.BUBBLE_TO_SANDBOX,e,!1);return ax(i)},getHotspot:function(n){return g.getOpt(n)},onSetValue:function(n,e){n.hasConfigured(vx)&&vx.run(n).get(t)},typeaheadBehaviours:qa(X([o.getValidationHandler().map((function(t){return vx.config({getRoot:function(n){return gr(n.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(n,t){s.getOpt(n).each((function(n){Pr(n.element,"title",i.translate(t))}))}},validator:{validate:function(e){var o=Ff.getValue(e);return xO((function(e){t({type:n.filetype,url:o.value},(function(n){if("invalid"===n.status){var t=un.error(n.message);e(t)}else{var o=un.value(n.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[$h.config({disabled:function(){return n.disabled||i.isDisabled()}}),Ay.config({}),tg("urlinput-events",X(["file"===n.filetype?[Xo(ro(),(function(t){Ho(t,Py,{name:n.name})}))]:[],[Xo(io(),(function(t){Ho(t,Py,{name:n.name}),u(t)})),Xo(go(),(function(t){Ho(t,Py,{name:n.name}),u(t)}))]]))]])),eventOrder:(r={},r[ro()]=["streaming","urlinput-events","invalidating"],r),model:{getDisplayText:function(n){return n.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:e.shared.getSink,parts:{menu:rh(0,0,"normal")},onExecute:function(n,t,e){Ho(t,Ly,{})},onItemExecute:function(t,e,o,r){u(t),Ho(t,Py,{name:n.name})}}),c=n.label.map((function(n){return Vy(n,i)})),s=tp(function(n,t,e,o){return void 0===e&&(e=n),void 0===o&&(o=n),{dom:{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+n],innerHtml:op(e,i.icons),attributes:l({title:i.translate(o),"aria-live":"polite"},t.fold((function(){return{}}),(function(n){return{id:n}})))}}}("invalid",b.some(AO),"warning")),f=tp({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[s.asSpec()]}),d=o.getUrlPicker(n.filetype),m=qr("browser.url.event"),g=tp({dom:{tag:"div",classes:["tox-control-wrap"]},components:[a,f.asSpec()],behaviours:qa([$h.config({disabled:function(){return n.disabled||i.isDisabled()}})])}),p=tp(wC({name:n.name,icon:b.some("browse"),text:n.label.getOr(""),disabled:n.disabled,primary:!1,borderless:!0},(function(n){return Po(n,m)}),i,[],["tox-browse-url"]));return Ey.sketch({dom:Ry([]),components:c.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:X([[g.asSpec()],d.map((function(){return p.asSpec()})).toArray()])}]),fieldBehaviours:qa([$h.config({disabled:function(){return n.disabled||i.isDisabled()},onDisabled:function(n){Ey.getField(n).each($h.disable),p.getOpt(n).each($h.disable)},onEnabled:function(n){Ey.getField(n).each($h.enable),p.getOpt(n).each($h.enable)}}),Tv(),tg("url-input-events",[Xo(m,(function(t){Ul.getCurrent(t).each((function(e){var o=Ff.getValue(e),r=l({fieldname:n.name},o);d.each((function(o){o(r).get((function(o){Ff.setValue(e,o),Ho(t,Py,{name:n.name})}))}))}))}))])])})}(n,e,e.urlinput)})),customeditor:MO((function(n){var t=ce(b.none()),e=tp({dom:{tag:n.tag}}),o=ce(b.none());return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:qa([tg("custom-editor-events",[nr((function(r){e.getOpt(r).each((function(e){(!function(n){return Object.prototype.hasOwnProperty.call(n,"init")}(n)?YS.load(n.scriptId,n.scriptUrl).then((function(t){return t(e.element.dom,n.settings)})):n.init(e.element.dom)).then((function(n){o.get().each((function(t){n.setValue(t)})),o.set(b.none()),t.set(b.some(n))}))}))}))]),Ff.config({store:{mode:"manual",getValue:function(){return t.get().fold((function(){return o.get().getOr("")}),(function(n){return n.getValue()}))},setValue:function(n,e){t.get().fold((function(){o.set(b.some(e))}),(function(n){return n.setValue(e)}))}}}),jS()]),components:[e.asSpec()]}})),htmlpanel:MO((function(n){return"presentation"===n.presets?Cy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html}}):Cy.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:n.html,attributes:{role:"document"}},containerBehaviours:qa([Ay.config({}),ug.config({})])})})),imagetools:MO((function(n,t){return ZC(n,t.shared.providers)})),table:MO((function(n,t){return function(n,t){var e,o,r=function(n){return{dom:{tag:"th",innerHtml:t.translate(n)}}},i=function(n){return{dom:{tag:"td",innerHtml:t.translate(n)}}},u=function(n){return{dom:{tag:"tr"},components:H(n,i)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[(o=n.header,{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:H(o,r)}]}),(e=n.cells,{dom:{tag:"tbody"},components:H(e,u)})],behaviours:qa([Ay.config({}),ug.config({})])}}(n,t.shared.providers)})),panel:MO((function(n,t){return function(n,t){return{dom:{tag:"div",classes:n.classes},components:H(n.items,t.shared.interpreter)}}(n,t)}))},IO={field:function(n,t){return t}},RO=function(n,t,e){var o=In(e,{shared:{interpreter:function(t){return VO(n,t,o)}}});return VO(n,t,o)},VO=function(n,t,e){return En(FO,t.type).fold((function(){return console.error('Unknown factory type "'+t.type+'", defaulting to container: ',t),t}),(function(o){return o(n,t,e)}))},PO={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},HO=function(n,t,e){var o=Ec(-12,12,PO),r={maxHeightFunction:Cc()};return function(){return e()?{anchor:"node",root:Sr(n()),node:b.from(n()),bubble:o,layouts:{onRtl:function(){return[Kg]},onLtr:function(){return[Jg]}},overrides:r}:{anchor:"hotspot",hotspot:t(),bubble:o,layouts:{onRtl:function(){return[Ea]},onLtr:function(){return[Da]}},overrides:r}}},zO=function(n,t,e){return function(){return e()?{anchor:"node",root:Sr(n()),node:b.from(n()),layouts:{onRtl:function(){return[$g]},onLtr:function(){return[$g]}}}:{anchor:"hotspot",hotspot:t(),layouts:{onRtl:function(){return[Fa]},onLtr:function(){return[Fa]}}}}},NO=function(n,t){return function(){return{anchor:"selection",root:t(),getSelection:function(){var t=n.selection.getRng();return b.some(rs.range(fe.fromDom(t.startContainer),t.startOffset,fe.fromDom(t.endContainer),t.endOffset))}}}},LO=function(n){return function(t){return{anchor:"node",root:n(),node:t}}},jO=function(n,t,e){var o=hv(n),r=function(){return fe.fromDom(n.getBody())},i=function(){return fe.fromDom(n.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:HO(i,t,u),banner:zO(i,t,u),cursor:NO(n,r),node:LO(r)}},UO=function(n){return function(t,e){Pb(n)(t,e)}},WO=function(n){return function(){return Tb(n)}},GO=function(n){return function(){return Eb(n)}},XO=function(n){return function(){return Bb(n)}},YO=function(n){return{colorPicker:UO(n),hasCustomColors:WO(n),getColors:GO(n),getColorCols:XO(n)}},qO=function(n){return function(){return function(n){return n.getParam("draggable_modal",!1,"boolean")}(n)}},JO=function(n){return{isDraggableModal:qO(n)}},KO=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],$O=function(n){return U(n,(function(n,t){if(Dn(t,"items")){var e=$O(t.items);return{customFormats:n.customFormats.concat(e.customFormats),formats:n.formats.concat([{title:t.title,items:e.formats}])}}if(function(n){return Dn(n,"inline")}(t)||function(n){return Dn(n,"block")}(t)||function(n){return Dn(n,"selector")}(t)){var o="custom-"+(w(t.name)?t.name:t.title.toLowerCase());return{customFormats:n.customFormats.concat([{name:o,format:t}]),formats:n.formats.concat([{title:t.title,format:o,icon:t.icon}])}}return l(l({},n),{formats:n.formats.concat(t)})}),{customFormats:[],formats:[]})},QO=function(n){return function(n){return b.from(n.getParam("style_formats")).filter(k)}(n).map((function(t){var e=function(n,t){var e=$O(t),o=function(t){z(t,(function(t){n.formatter.has(t.name)||n.formatter.register(t.name,t.format)}))};return n.formatter?o(e.customFormats):n.on("init",(function(){o(e.customFormats)})),e.formats}(n,t);return function(n){return n.getParam("style_formats_merge",!1,"boolean")}(n)?KO.concat(e):e})).getOr(KO)},ZO=function(n,t,e){var o={type:"formatter",isSelected:t(n.format),getStylePreview:e(n.format)};return In(n,o)},n_=function(n,t,e,o){var r=function(t){return H(t,(function(t){var i=yn(t);if(Bn(t,"items")){var u=r(t.items);return In(function(n){return In(n,{type:"submenu"})}(t),{getStyleItems:function(){return u}})}return Bn(t,"format")?function(n){return ZO(n,e,o)}(t):1===i.length&&I(i,"title")?In(t,{type:"separator"}):function(t){var r=w(t.name)?t.name:qr(t.title),i="custom-"+r,u={type:"formatter",format:i,isSelected:e(i),getStylePreview:o(i)},a=In(t,u);return n.formatter.register(r,a),a}(t)}))};return r(t)},t_=function(n){var t=function(t){return function(){return n.formatter.match(t)}},e=function(t){return function(){var e=n.formatter.get(t);return void 0!==e?b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):b.none()}},o=function(n){var t=n.items;return void 0!==t&&t.length>0?Y(t,o):[n.format]},r=ce([]),i=ce([]),u=ce([]),a=ce([]),c=ce(!1);n.on("PreInit",(function(u){var a=QO(n),c=n_(n,a,t,e);r.set(c),i.set(Y(c,o))})),n.on("addStyleModifications",(function(r){var i=n_(n,r.items,t,e);u.set(i),c.set(r.replace),a.set(Y(i,o))}));return{getData:function(){var n=c.get()?[]:r.get(),t=u.get();return n.concat(t)},getFlattenedKeys:function(){var n=c.get()?[]:i.get(),t=a.get();return n.concat(t)}}},e_=qS.trim,o_=function(n){return function(t){if(function(n){return _(n)&&1===n.nodeType}(t)){if(t.contentEditable===n)return!0;if(t.getAttribute("data-mce-contenteditable")===n)return!0}return!1}},r_=o_("true"),i_=o_("false"),u_=function(n,t,e,o,r){return{type:n,title:t,url:e,level:o,attach:r}},a_=function(n){return n.innerText||n.textContent},c_=function(n){return function(n){return n&&"A"===n.nodeName&&void 0!==(n.id||n.name)}(n)&&f_(n)},s_=function(n){return n&&/^(H[1-6])$/.test(n.nodeName)},f_=function(n){return function(n){for(;n=n.parentNode;){var t=n.contentEditable;if(t&&"inherit"!==t)return r_(n)}return!1}(n)&&!i_(n)},l_=function(n){return s_(n)&&f_(n)},d_=function(n){var t=function(n){return n.id?n.id:qr("h")}(n);return u_("header",a_(n),"#"+t,function(n){return s_(n)?parseInt(n.nodeName.substr(1),10):0}(n),(function(){n.id=t}))},m_=function(n){var e=n.id||n.name,o=a_(n);return u_("anchor",o||"#"+e,"#"+e,0,t)},g_=function(n){var t,e;return t="h1,h2,h3,h4,h5,h6,a:not([href])",e=n,H(hs(fe.fromDom(e),t),(function(n){return n.dom}))},p_=function(n){return e_(n.title).length>0},h_=function(n){var t=g_(n);return L(function(n){return H(L(n,l_),d_)}(t).concat(function(n){return H(L(n,c_),m_)}(t)),p_)},v_="tinymce-url-history",b_=function(n){return w(n)&&/^https?/.test(n)},y_=function(n){return S(n)&&_n(n,(function(n){return!(k(t=n)&&t.length<=5&&q(t,b_));var t})).isNone()},x_=function(){var n,t=Sb.getItem(v_);if(null===t)return{};try{n=JSON.parse(t)}catch(n){if(n instanceof SyntaxError)return console.log("Local storage "+v_+" was not valid JSON",n),{};throw n}return y_(n)?n:(console.log("Local storage "+v_+" was not valid format",n),{})},w_=function(n){var t=x_();return Object.prototype.hasOwnProperty.call(t,n)?t[n]:[]},S_=function(n,t){if(b_(n)){var e=x_(),o=Object.prototype.hasOwnProperty.call(e,t)?e[t]:[],r=L(o,(function(t){return t!==n}));e[t]=[n].concat(r).slice(0,5),function(n){if(!y_(n))throw new Error("Bad format for history:\n"+JSON.stringify(n));Sb.setItem(v_,JSON.stringify(n))}(e)}},k_=function(n){return!!n},C_=function(n){return Sn(qS.makeMap(n,/[, ]/),k_)},O_=function(n){return b.from(function(n){return n.getParam("file_picker_callback")}(n)).filter(T)},__=function(n,t){var e=function(n){var t=b.some(function(n){return n.getParam("file_picker_types")}(n)).filter(k_),e=b.some(function(n){return n.getParam("file_browser_callback_types")}(n)).filter(k_),o=t.or(e).map(C_);return O_(n).fold(c,(function(n){return o.fold(s,(function(n){return yn(n).length>0&&n}))}))}(n);return C(e)?e?O_(n):b.none():e[t]?O_(n):b.none()},T_=function(n){return b.from(n).filter(w).getOrUndefined()},E_=function(n){return{getHistory:w_,addToHistory:S_,getLinkInformation:function(){return function(n){return function(n){return!1===n.getParam("typeahead_urls")}(n)?b.none():b.some({targets:h_(n.getBody()),anchorTop:T_(Sv(n)),anchorBottom:T_(kv(n))})}(n)},getValidationHandler:function(){return function(n){return b.from(function(n){var t=n.getParam("file_picker_validator_handler",void 0,"function");return void 0===t?n.getParam("filepicker_validator_handler",void 0,"function"):t}(n))}(n)},getUrlPicker:function(t){return function(n,t){return __(n,t).map((function(e){return function(o){return ux((function(r){var i=l({filetype:t,fieldname:o.fieldname},b.from(o.meta).getOr({}));e.call(n,(function(n,t){if(!w(n))throw new Error("Expected value to be string");if(void 0!==t&&!S(t))throw new Error("Expected meta to be a object");r({value:n,meta:t})}),o.value,i)}))}}))}(n,t)}}},D_=function(n,t,e){var o=ce(!1),r=function(n){var t=ce(gv(n)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===t.get()},getDockingMode:t.get,setDockingMode:t.set}}(t),i={shared:{providers:{icons:function(){return t.ui.registry.getAll().icons},menuItems:function(){return t.ui.registry.getAll().menuItems},translate:Ph.translate,isDisabled:function(){return t.mode.isReadOnly()||t.ui.isDisabled()},getSetting:t.getParam.bind(t)},interpreter:function(n){return function(n,t){return VO(IO,n,t)}(n,i)},anchors:jO(t,e,r.isPositionedAtTop),header:r,getSink:function(){return un.value(n)}},urlinput:E_(t),styleselect:t_(t),colorinput:YO(t),dialog:JO(t),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(n){return o.set(n)}};return i},B_=o((function(n,t){!function(n,t){var e=vu.max(n,t,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);Hi(n,"max-width",e+"px")}(n,Math.floor(t))})),A_=o([Pt("dom"),Qt("shell",!0),If("toolbarBehaviours",[ng])]),M_=o([fl({name:"groups",overrides:function(){return{behaviours:qa([ng.config({})])}}})]),F_=Pl({name:"Toolbar",configFields:A_(),partFields:M_(),factory:function(n,t,e,o){var r=function(t){return n.shell?b.some(t):Sl(t,n,"groups")},i=n.shell?{behaviours:[ng.config({})],components:[]}:{behaviours:[],components:t};return{uid:n.uid,dom:n.dom,components:i.components,behaviours:Vf(n.toolbarBehaviours,i.behaviours),apis:{setGroups:function(n,t){r(n).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(n){ng.set(n,t)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)}}}),I_=function(n,t,e){return{within:n,extra:t,withinWidth:e}},R_=function(n,t,e){var r,i=(r=function(n,t){var o=e(n);return b.some({element:n,start:t,finish:t+o,width:o})},U(n,(function(n,t){return r(t,n.len).fold(o(n),(function(t){return{len:t.finish,list:n.list.concat([t])}}))}),{len:0,list:[]}).list),u=L(i,(function(n){return n.finish<=t})),a=j(u,(function(n,t){return n+t.width}),0);return{within:u,extra:i.slice(u.length),withinWidth:a}},V_=function(n){return H(n,(function(n){return n.element}))},P_=function(n,t,e,o){var r=function(n,t,e){var o=R_(t,n,e);return 0===o.extra.length?b.some(o):b.none()}(n,t,e).getOrThunk((function(){return R_(t,n-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(n,t,e){var o=V_(n.concat(t));return I_(o,[],e)}(i,u,a):u.length>=1?function(n,t,e,o){var r=V_(n).concat([e]);return I_(r,V_(t),o)}(i,u,o,a):function(n,t,e){return I_(V_(n),[],e)}(i,0,a)},H_=function(n,t){var e=H(t,(function(n){return au(n)}));F_.setGroups(n,e)},z_=function(n,t,e){var o=kl(n,t,"primary"),r=xx.getCoupled(n,"overflowGroup");Hi(o.element,"visibility","hidden");var i=t.builtGroups.get().concat([r]),u=en(i,(function(n){return rc(n.element).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}));e([]),H_(o,i);var a=bu(o.element),c=P_(a,t.builtGroups.get(),(function(n){return bu(n.element)}),r);0===c.extra.length?(ng.remove(o,r),e([])):(H_(o,c.within),e(c.extra)),Xi(o.element,"visibility"),Yi(o.element),u.each(ug.focus)},N_=o([If("splitToolbarBehaviours",[xx]),ae("builtGroups",(function(){return ce([])}))]),L_=o([ea(["overflowToggledClass"]),Kt("getOverflowBounds"),Pt("lazySink"),ae("overflowGroups",(function(){return ce([])}))].concat(N_())),j_=o([cl({factory:F_,schema:A_(),name:"primary"}),sl({schema:A_(),name:"overflow"}),sl({name:"overflow-button"}),sl({name:"overflow-group"})]),U_=o([ea(["toggledClass"]),Pt("lazySink"),jt("fetch"),Kt("getBounds"),$t("fireDismissalEventInstead",[Qt("event",Do())]),Rc()]),W_=o([sl({name:"button",overrides:function(n){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:qa([bg.config({toggleClass:n.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),sl({factory:F_,schema:A_(),name:"toolbar",overrides:function(n){return{toolbarBehaviours:qa([Jm.config({mode:"cyclic",onEscape:function(t){return Sl(t,n,"button").each(ug.focus),b.none()}})])}}})]),G_=function(n,t){var e=xx.getCoupled(n,"toolbarSandbox");mf.isOpen(e)?mf.close(e):mf.open(e,t.toolbar())},X_=function(n,t,e,o){var r=e.getBounds.map((function(n){return n()})),i=e.lazySink(n).getOrDie();Ws.positionWithinBounds(i,{anchor:"hotspot",hotspot:n,layouts:o,overrides:{maxWidthFunction:B_()}},t,r)},Y_=function(n,t,e,o,r){F_.setGroups(t,r),X_(n,t,e,o),bg.on(n)},q_=Pl({name:"FloatingToolbarButton",factory:function(n,t,e,o){return l(l({},np.sketch(l(l({},o.button()),{action:function(n){G_(n,o)},buttonBehaviours:Hf({dump:o.button().buttonBehaviours},[xx.config({others:{toolbarSandbox:function(t){return function(n,t,e){var o=ju();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:qa([Jm.config({mode:"special",onEscape:function(n){return mf.close(n),b.some(!0)}}),mf.config({onOpen:function(r,i){e.fetch().get((function(r){Y_(n,i,e,t.layouts,r),o.link(n.element),Jm.focusIn(i)}))},onClose:function(){bg.off(n),ug.focus(n),o.unlink(n.element)},isPartOf:function(t,e,o){return Wu(e,o)||Wu(n,o)},getAttachPoint:function(){return e.lazySink(n).getOrDie()}}),nc.config({channels:l(l({},bf(l({isExtraPart:c},e.fireDismissalEventInstead.map((function(n){return{fireEventInstead:{event:n.event}}})).getOr({})))),xf({doReposition:function(){mf.getState(xx.getCoupled(n,"toolbarSandbox")).each((function(o){X_(n,o,e,t.layouts)}))}}))})])}}(t,e,n)}}})])}))),{apis:{setGroups:function(t,o){mf.getState(xx.getCoupled(t,"toolbarSandbox")).each((function(r){Y_(t,r,n,e.layouts,o)}))},reposition:function(t){mf.getState(xx.getCoupled(t,"toolbarSandbox")).each((function(o){X_(t,o,n,e.layouts)}))},toggle:function(n){G_(n,o)},getToolbar:function(n){return mf.getState(xx.getCoupled(n,"toolbarSandbox"))},isOpen:function(n){return mf.isOpen(xx.getCoupled(n,"toolbarSandbox"))}}})},configFields:U_(),partFields:W_(),apis:{setGroups:function(n,t,e){n.setGroups(t,e)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},getToolbar:function(n,t){return n.getToolbar(t)},isOpen:function(n,t){return n.isOpen(t)}}}),J_=o([Pt("items"),ea(["itemSelector"]),If("tgroupBehaviours",[Jm])]),K_=o([ll({name:"items",unit:"item"})]),$_=Pl({name:"ToolbarGroup",configFields:J_(),partFields:K_(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Vf(n.tgroupBehaviours,[Jm.config({mode:"flow",selector:n.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),Q_=function(n){return H(n,(function(n){return au(n)}))},Z_=function(n,t,e){z_(n,e,(function(o){e.overflowGroups.set(o),t.getOpt(n).each((function(n){q_.setGroups(n,Q_(o))}))}))},nT=Pl({name:"SplitFloatingToolbar",configFields:L_(),partFields:j_(),factory:function(n,t,e,o){var r=tp(q_.sketch({fetch:function(){return ux((function(t){t(Q_(n.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Da,Ea]},onRtl:function(){return[Ea,Da]},onBottomLtr:function(){return[Aa,Ba]},onBottomRtl:function(){return[Ba,Aa]}},getBounds:e.getOverflowBounds,lazySink:n.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:n.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:n.uid,dom:n.dom,components:t,behaviours:Vf(n.splitToolbarBehaviours,[xx.config({others:{overflowGroup:function(){return $_.sketch(l(l({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(t,e){n.builtGroups.set(H(e,t.getSystem().build)),Z_(t,r,n)},refresh:function(t){return Z_(t,r,n)},toggle:function(n){r.getOpt(n).each((function(n){q_.toggle(n)}))},isOpen:function(n){return r.getOpt(n).map(q_.isOpen).getOr(!1)},reposition:function(n){r.getOpt(n).each((function(n){q_.reposition(n)}))},getOverflow:function(n){return r.getOpt(n).bind(q_.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},reposition:function(n,t){n.reposition(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)},getOverflow:function(n,t){return n.getOverflow(t)}}}),tT=function(n,t){return t.getAnimationRoot.fold((function(){return n.element}),(function(t){return t(n)}))},eT=function(n){return n.dimension.property},oT=function(n,t){return n.dimension.getDimension(t)},rT=function(n,t){var e=tT(n,t);Ai(e,[t.shrinkingClass,t.growingClass])},iT=function(n,t){Ei(n.element,t.openClass),_i(n.element,t.closedClass),Hi(n.element,eT(t),"0px"),Yi(n.element)},uT=function(n,t){Ei(n.element,t.closedClass),_i(n.element,t.openClass),Xi(n.element,eT(t))},aT=function(n,t,e,o){e.setCollapsed(),Hi(n.element,eT(t),oT(t,n.element)),Yi(n.element),rT(n,t),iT(n,t),t.onStartShrink(n),t.onShrunk(n)},cT=function(n,t,e,o){var r=o.getOrThunk((function(){return oT(t,n.element)}));e.setCollapsed(),Hi(n.element,eT(t),r),Yi(n.element);var i=tT(n,t);Ei(i,t.growingClass),_i(i,t.shrinkingClass),iT(n,t),t.onStartShrink(n)},sT=function(n,t,e){var o=oT(t,n.element);("0px"===o?aT:cT)(n,t,e,b.some(o))},fT=function(n,t,e){var o=tT(n,t),r=Di(o,t.shrinkingClass),i=oT(t,n.element);uT(n,t);var u=oT(t,n.element);(r?function(){Hi(n.element,eT(t),i),Yi(n.element)}:function(){iT(n,t)})(),Ei(o,t.shrinkingClass),_i(o,t.growingClass),uT(n,t),Hi(n.element,eT(t),u),e.setExpanded(),t.onStartGrow(n)},lT=function(n,t,e){var o=tT(n,t);return!0===Di(o,t.growingClass)},dT=function(n,t,e){var o=tT(n,t);return!0===Di(o,t.shrinkingClass)},mT=Object.freeze({__proto__:null,refresh:function(n,t,e){if(e.isExpanded()){Xi(n.element,eT(t));var o=oT(t,n.element);Hi(n.element,eT(t),o)}},grow:function(n,t,e){e.isExpanded()||fT(n,t,e)},shrink:function(n,t,e){e.isExpanded()&&sT(n,t,e)},immediateShrink:function(n,t,e){e.isExpanded()&&aT(n,t,e,b.none())},hasGrown:function(n,t,e){return e.isExpanded()},hasShrunk:function(n,t,e){return e.isCollapsed()},isGrowing:lT,isShrinking:dT,isTransitioning:function(n,t,e){return lT(n,t)||dT(n,t)},toggleGrow:function(n,t,e){(e.isExpanded()?sT:fT)(n,t,e)},disableTransitions:rT}),gT=Object.freeze({__proto__:null,exhibit:function(n,t,e){var o=t.expanded;return mi(o?{classes:[t.openClass],styles:{}}:{classes:[t.closedClass],styles:Xn(t.dimension.property,"0px")})},events:function(n,t){return Uo([Zo(ao(),(function(e,o){o.event.raw.propertyName===n.dimension.property&&(rT(e,n),t.isExpanded()&&Xi(e.element,n.dimension.property),(t.isExpanded()?n.onGrown:n.onShrunk)(e))}))])}}),pT=[Pt("closedClass"),Pt("openClass"),Pt("shrinkingClass"),Pt("growingClass"),Xt("getAnimationRoot"),ra("onShrunk"),ra("onStartShrink"),ra("onGrown"),ra("onStartGrow"),Qt("expanded",!1),Ht("dimension",Tt("property",{width:[ca("property","width"),ca("getDimension",(function(n){return bu(n)+"px"}))],height:[ca("property","height"),ca("getDimension",(function(n){return fu(n)+"px"}))]}))],hT=Ka({fields:pT,name:"sliding",active:gT,apis:mT,state:Object.freeze({__proto__:null,init:function(n){var t=ce(n.expanded);return li({isExpanded:function(){return!0===t.get()},isCollapsed:function(){return!1===t.get()},setCollapsed:i(t.set,!1),setExpanded:i(t.set,!0),readState:function(){return"expanded: "+t.get()}})}})}),vT=o([ea(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),ra("onOpened"),ra("onClosed")].concat(N_())),bT=o([cl({factory:F_,schema:A_(),name:"primary"}),cl({factory:F_,schema:A_(),name:"overflow",overrides:function(n){return{toolbarBehaviours:qa([hT.config({dimension:{property:"height"},closedClass:n.markers.closedClass,openClass:n.markers.openClass,shrinkingClass:n.markers.shrinkingClass,growingClass:n.markers.growingClass,onShrunk:function(t){Sl(t,n,"overflow-button").each((function(n){bg.off(n),ug.focus(n)})),n.onClosed(t)},onGrown:function(t){Jm.focusIn(t),n.onOpened(t)},onStartGrow:function(t){Sl(t,n,"overflow-button").each(bg.on)}}),Jm.config({mode:"acyclic",onEscape:function(t){return Sl(t,n,"overflow-button").each(ug.focus),b.some(!0)}})])}}}),sl({name:"overflow-button",overrides:function(n){return{buttonBehaviours:qa([bg.config({toggleClass:n.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),sl({name:"overflow-group"})]),yT=function(n,t){Sl(n,t,"overflow-button").bind((function(){return Sl(n,t,"overflow")})).each((function(e){xT(n,t),hT.toggleGrow(e)}))},xT=function(n,t){Sl(n,t,"overflow").each((function(e){z_(n,t,(function(n){var t=H(n,(function(n){return au(n)}));F_.setGroups(e,t)})),Sl(n,t,"overflow-button").each((function(n){hT.hasGrown(e)&&bg.on(n)})),hT.refresh(e)}))},wT=Pl({name:"SplitSlidingToolbar",configFields:vT(),partFields:bT(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,behaviours:Vf(n.splitToolbarBehaviours,[xx.config({others:{overflowGroup:function(n){return $_.sketch(l(l({},o["overflow-group"]()),{items:[np.sketch(l(l({},o["overflow-button"]()),{action:function(t){Po(n,"alloy.toolbar.toggle")}}))]}))}}}),tg("toolbar-toggle-events",[Xo("alloy.toolbar.toggle",(function(t){yT(t,n)}))])]),apis:{setGroups:function(t,e){!function(t,e){var o=H(e,t.getSystem().build);n.builtGroups.set(o)}(t,e),xT(t,n)},refresh:function(t){return xT(t,n)},toggle:function(t){return yT(t,n)},isOpen:function(t){return function(n,t){return Sl(n,t,"overflow").map(hT.hasGrown).getOr(!1)}(t,n)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(n,t,e){n.setGroups(t,e)},refresh:function(n,t){n.refresh(t)},toggle:function(n,t){n.toggle(t)},isOpen:function(n,t){return n.isOpen(t)}}}),ST=o(qr("toolbar-height-change")),kT=function(n){var t=n.title.fold((function(){return{}}),(function(n){return{attributes:{title:n}}}));return{dom:l({tag:"div",classes:["tox-toolbar__group"]},t),components:[$_.parts.items({})],items:n.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:qa([Ay.config({}),ug.config({})])}},CT=function(n){return $_.sketch(kT(n))},OT=function(n,t){var e=nr((function(t){var e=H(n.initGroups,CT);F_.setGroups(t,e)}));return qa([Av(n.providers.isDisabled),Tv(),Jm.config({mode:t,onEscape:n.onEscape,selector:".tox-toolbar__group"}),tg("toolbar-events",[e])])},_T=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return{uid:n.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":kT({title:b.none(),items:[]}),"overflow-button":bC({name:"more",icon:b.some("more-drawer"),disabled:!1,tooltip:b.some("More..."),primary:!1,borderless:!1},b.none(),n.providers)},splitToolbarBehaviours:OT(n,t)}},TT=function(n){var t=_T(n),e=nT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return nT.sketch(l(l({},t),{lazySink:n.getSink,getOverflowBounds:function(){var t=n.moreDrawerData.lazyHeader().element,e=Mu(t),o=dr(t),r=Mu(o),i=Math.max(o.dom.scrollHeight,r.height);return Bu(e.x+4,r.y,e.width-8,i)},parts:l(l({},t.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:n.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},ET=function(n){var t=wT.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=wT.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=_T(n);return wT.sketch(l(l({},o),{components:[t,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(n){n.getSystem().broadcastOn([ST()],{type:"opened"})},onClosed:function(n){n.getSystem().broadcastOn([ST()],{type:"closed"})}}))},DT=function(n){var t=n.cyclicKeying?"cyclic":"acyclic";return F_.sketch({uid:n.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(n.type===Gp.scrolling?["tox-toolbar--scrolling"]:[])},components:[F_.parts.groups({})],toolbarBehaviours:OT(n,t)})},BT=at([Nt("type"),Ht("items",st([bt([Nt("name"),Gt("items",At)]),At]))].concat(Bp)),AT=[Jt("text"),Jt("tooltip"),Jt("icon"),jt("fetch"),re("onSetup",(function(){return t}))],MT=at(m([Nt("type")],AT)),FT=function(n){return St("menubutton",MT,n)},IT=at([Nt("type"),Jt("tooltip"),Jt("icon"),Jt("text"),Kt("select"),jt("fetch"),re("onSetup",(function(){return t})),ee("presets","normal",["normal","color","listpreview"]),Qt("columns",1),jt("onAction"),jt("onItemAction")]),RT=Object.freeze({__proto__:null,events:function(n,t){var e=function(e,o){n.updateState.each((function(n){var r=n(e,o);t.set(r)})),n.renderComponents.each((function(n){var r=n(o,t.get()),i=H(r,e.getSystem().build);qs(e,i)}))};return Uo([Xo(po(),(function(t,o){var r=o;if(!r.universal){var i=n.channel;I(r.channels,i)&&e(t,r.data)}})),nr((function(t,o){n.initialData.each((function(n){e(t,n)}))}))])}}),VT=Object.freeze({__proto__:null,getState:function(n,t,e){return e}}),PT=[Pt("channel"),Xt("renderComponents"),Xt("updateState"),Xt("initialData")],HT=Ka({fields:PT,name:"reflecting",active:RT,apis:VT,state:Object.freeze({__proto__:null,init:function(){var n=ce(b.none());return{readState:function(){return n.get().fold((function(){return"none"}),(function(n){return n}))},get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(b.none())}}}})}),zT=o([Pt("toggleClass"),Pt("fetch"),ua("onExecute"),Qt("getHotspot",b.some),Qt("getAnchorOverrides",o({})),Rc(),ua("onItemExecute"),Xt("lazySink"),Pt("dom"),ra("onOpen"),If("splitDropdownBehaviours",[xx,Jm,ug]),Qt("matchWidth",!1),Qt("useMinWidth",!1),Qt("eventOrder",{}),Xt("role")].concat(Rx())),NT=cl({factory:np,schema:[Pt("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:qa([ug.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each(zo)},buttonBehaviours:qa([bg.config({toggleOnExecute:!1,toggleClass:n.toggleClass})])}}}),LT=cl({factory:np,schema:[Pt("dom")],name:"button",defaults:function(){return{buttonBehaviours:qa([ug.revoke()])}},overrides:function(n){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(t){t.getSystem().getByUid(n.uid).each((function(e){n.onExecute(e,t)}))}}}}),jT=o([NT,LT,fl({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:n.text}}}},schema:[Pt("text")],name:"aria-descriptor"}),sl({schema:[ta()],name:"menu",defaults:function(n){return{onExecute:function(t,e){t.getSystem().getByUid(n.uid).each((function(o){n.onItemExecute(o,t,e)}))}}}}),Sx()]),UT=Pl({name:"SplitDropdown",configFields:zT(),partFields:jT(),factory:function(n,e,o,r){var i,u=function(n){Ul.getCurrent(n).each((function(n){nd.highlightFirst(n),Jm.focusIn(n)}))},a=function(e){Dx(n,(function(n){return n}),e,r,u,nx.HighlightFirst).get(t)},c=function(t){var e=kl(t,n,"button");return zo(e),b.some(!0)},s=l(l({},Uo([nr((function(t,e){Sl(t,n,"aria-descriptor").each((function(n){var e=qr("aria");Pr(n.element,"id",e),Pr(t.element,"aria-describedby",e)}))}))])),xg(b.some(a))),f={repositionMenus:function(n){bg.isOn(n)&&Ix(n)}};return{uid:n.uid,dom:n.dom,components:e,apis:f,eventOrder:l(l({},n.eventOrder),(i={},i[ho()]=["disabling","toggling","alloy.base.behaviour"],i)),events:s,behaviours:Vf(n.splitDropdownBehaviours,[xx.config({others:{sandbox:function(t){var e=kl(t,n,"arrow");return Fx(n,t,{onOpen:function(){bg.on(e),bg.on(t)},onClose:function(){bg.off(e),bg.off(t)}})}}}),Jm.config({mode:"special",onSpace:c,onEnter:c,onDown:function(n){return a(n),b.some(!0)}}),ug.config({}),bg.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:n.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(n,t){return n.repositionMenus(t)}}}),WT=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},GT=function(n){return{setActive:function(t){bg.set(n,t)},isActive:function(){return bg.isOn(n)},isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)}}},XT=function(n,t){return n.map((function(n){return{"aria-label":t.translate(n),title:t.translate(n)}})).getOr({})},YT=qr("focus-button"),qT=["checklist","ordered-list"],JT=["indent","outdent","table-insert-column-after","table-insert-column-before","unordered-list"],KT=function(n,t,e,o,r,i){var u,a=function(n){return Ph.isRtl()&&I(qT,n)?n+"-rtl":n},c=Ph.isRtl()&&n.exists((function(n){return I(JT,n)}));return{dom:{tag:"button",classes:["tox-tbtn"].concat(t.isSome()?["tox-tbtn--select"]:[]).concat(c?["tox-tbtn__icon-rtl"]:[]),attributes:XT(e,i)},components:Pv([n.map((function(n){return nC(a(n),i.icons)})),t.map((function(n){return eC(n,"tox-tbtn",i)}))]),eventOrder:(u={},u[Je()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:qa([Av(i.isDisabled),Tv(),tg("common-button-display-events",[Xo(Je(),(function(n,t){t.event.prevent(),Po(n,YT)}))])].concat(o.map((function(e){return HT.config({channel:e,initialData:{icon:n,text:t},renderComponents:function(n,t){return Pv([n.icon.map((function(n){return nC(a(n),i.icons)})),n.text.map((function(n){return eC(n,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},$T=function(n,e,o){var r,i=ce(t),u=KT(n.icon,n.text,n.tooltip,b.none(),b.none(),o);return np.sketch({dom:u.dom,components:u.components,eventOrder:rC,buttonBehaviours:qa([tg("toolbar-button-events",[(r={onAction:n.onAction,getApi:e.getApi},or((function(n,t){Mv(r,n)((function(t){Ho(n,oC,{buttonApi:t}),r.onAction(t)}))}))),Fv(e,i),Iv(e,i)]),Av((function(){return n.disabled||o.isDisabled()})),Tv()].concat(e.toolbarButtonBehaviours))})},QT=function(n,t,e){return $T(n,{toolbarButtonBehaviours:[].concat(e.length>0?[tg("toolbarButtonWith",e)]:[]),getApi:WT,onSetup:n.onSetup},t)},ZT=function(n,t,e){return In($T(n,{toolbarButtonBehaviours:[ng.config({}),bg.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[tg("toolbarToggleButtonWith",e)]:[]),getApi:GT,onSetup:n.onSetup},t))},nE=function(n,t,e){return function(o){return ux((function(n){return t.fetch(n)})).map((function(r){return b.from(oy(In(Hb(qr("menu-value"),r,(function(e){t.onItemAction(n(o),e)}),t.columns,t.presets,Xp.CLOSE_ON_EXECUTE,t.select.getOr(c),e),{movement:Nb(t.columns,t.presets),menuBehaviours:Th("auto"!==t.columns?[]:[nr((function(n,e){Oh(n,4,Qp(t.presets)).each((function(t){var e=t.numRows,o=t.numColumns;Jm.setGridSize(n,e,o)}))}))])})))}))}},tE=function(n,t){return Xo(oC,(function(e,o){var r=function(n){return{hide:function(){return Po(n,xo())},getValue:function(){return Ff.getValue(n)}}}(n.get(e));t.onAction(r,o.event.buttonApi)}))},eE=function(n,e,o){var r={backstage:{shared:{providers:o}}};return"contextformtogglebutton"===e.type?function(n,e,o){var r=e.original,i=(r.primary,d(r,["primary"])),u=kt(Rp(l(l({},i),{type:"togglebutton",onAction:t})));return ZT(u,o.backstage.shared.providers,[tE(n,e)])}(n,e,r):function(n,e,o){var r=e.original,i=(r.primary,d(r,["primary"])),u=kt(Mp(l(l({},i),{type:"button",onAction:t})));return QT(u,o.backstage.shared.providers,[tE(n,e)])}(n,e,r)},oE=function(n,t){var e=n.label.fold((function(){return{}}),(function(n){return{"aria-label":n}})),o=tp($y.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:n.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:qa([Jm.config({mode:"special",onEnter:function(n){return r.findPrimary(n).map((function(n){return zo(n),!0}))},onLeft:function(n,t){return t.cut(),b.none()},onRight:function(n,t){return t.cut(),b.none()}})])})),r=function(n,t,e){var o=H(t,(function(t){return tp(eE(n,t,e))}));return{asSpecs:function(){return H(o,(function(n){return n.asSpec()}))},findPrimary:function(n){return en(t,(function(t,e){return t.primary?b.from(o[e]).bind((function(t){return t.getOpt(n)})).filter(u($h.isDisabled)):b.none()}))}}}(o,n.commands,t);return[{title:b.none(),items:[o.asSpec()]},{title:b.none(),items:r.asSpecs()}]},rE=oE,iE=function(n,t){var e=_u(window),o=Au(fe.fromDom(n.getContentAreaContainer())),r=iv(n)||uv(n)||cv(n),i=function(n,t){var e=Math.max(t.x,n.x),o=n.right-e,r=t.width-(e-t.x);return{x:e,width:Math.min(o,r)}}(o,e),u=i.x,a=i.width;if(n.inline&&!r)return Bu(u,e.y,a,e.height);var c=function(n,t,e,o){var r=fe.fromDom(n.getContainer()),i=Nu(r,".tox-editor-header").getOr(r),u=Au(i),a=u.y>=t.bottom,c=o&&!a;if(n.inline&&c)return{y:Math.max(u.bottom,e.y),bottom:e.bottom};if(n.inline&&!c)return{y:e.y,bottom:Math.min(u.y,e.bottom)};var s=Au(r);return c?{y:Math.max(u.bottom,e.y),bottom:Math.min(s.bottom,e.bottom)}:{y:Math.max(s.y,e.y),bottom:Math.min(u.y,e.bottom)}}(n,o,e,t.header.isPositionedAtTop()),s=c.y,f=c.bottom;return Bu(u,s,a,f-s)},uE=function(n,t){var e=L(t,(function(t){return t.predicate(n.dom)})),o=N(e,(function(n){return"contexttoolbar"===n.type}));return{contextToolbars:o.pass,contextForms:o.fail}},aE=function(n,t,e){var o=uE(n,t);if(o.contextForms.length>0)return b.some({elem:n,toolbars:[o.contextForms[0]]});var r=uE(n,e);if(r.contextForms.length>0)return b.some({elem:n,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(n){if(n.length<=1)return n;var t=function(t){return R(n,(function(n){return n.position===t}))},e=function(t){return L(n,(function(n){return n.position===t}))},o=t("selection"),r=t("node");if(o||r){if(r&&o){var i=e("node"),u=H(e("selection"),(function(n){return l(l({},n),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return b.some({elem:n,toolbars:i})}return b.none()},cE=function(n,t,e){return n(t)?b.none():ze(t,(function(n){var t=uE(n,e.inNodeScope),o=t.contextToolbars,r=t.contextForms,i=r.length>0?r:function(n){if(n.length<=1)return n;var t=function(t){return W(n,(function(n){return n.position===t}))};return t("selection").orThunk((function(){return t("node")})).orThunk((function(){return t("line")})).map((function(n){return n.position})).fold((function(){return[]}),(function(t){return L(n,(function(n){return n.position===t}))}))}(o);return i.length>0?b.some({elem:n,toolbars:i}):b.none()}),n)},sE=function(n,t){var e={},o=[],r=[],i={},u={},a=function(n,a){var c=kt(St("ContextForm",jp,a));e[n]=c,c.launch.map((function(e){i["form:"+n]=l(l({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){t(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[n]=c},c=function(n,t){var e;(e=t,St("ContextToolbar",Up,e)).each((function(e){"editor"===t.scope?r.push(e):o.push(e),u[n]=e}))},s=yn(n);return z(s,(function(t){var e=n[t];"contextform"===e.type?a(t,e):"contexttoolbar"===e.type&&c(t,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},fE=qr("forward-slide"),lE=qr("backward-slide"),dE=qr("change-slide-event"),mE=function(n,t,e){var o=function(n,o,i,u){var a=t.shared.providers.translate(n.title);if("separator"===n.type)return b.some({type:"separator",text:a});if("submenu"===n.type){var c=Y(n.getStyleItems(),(function(n){return r(n,o,u)}));return 0===o&&c.length<=0?b.none():b.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return Y(n.getStyleItems(),(function(n){return r(n,o,u)}))}})}return b.some(l({type:"togglemenuitem",text:a,icon:n.icon,active:n.isSelected(u),disabled:i,onAction:e.onAction(n)},n.getStylePreview().fold((function(){return{}}),(function(n){return{meta:{style:n}}}))))},r=function(n,t,r){var i="formatter"===n.type&&e.isInvalid(n);return 0===t?i?[]:o(n,t,!1,r).toArray():o(n,t,i,r).toArray()},i=function(n){var t=e.getCurrentValue(),o=e.shouldHide?0:1;return Y(n,(function(n){return r(n,o,t)}))};return{validateItems:i,getFetch:function(n,t){return function(e,o){var r=t(),u=i(r);o(mC(u,Xp.CLOSE_ON_EXECUTE,n,!1))}}}},gE=function(n,t,e){var o=e.dataset,r="basic"===o.type?function(){return H(o.data,(function(n){return ZO(n,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:mE(0,t,e),getStyleItems:r}},pE=function(n,e,o){var r=gE(0,e,o),i=r.items,u=r.getStyleItems;return aC({text:o.icon.isSome()?b.none():b.some(""),icon:o.icon,tooltip:b.from(o.tooltip),role:b.none(),fetch:i.getFetch(e,u),onSetup:function(e){return o.setInitialValue.each((function(n){return n(e.getComponent())})),o.nodeChangeHandler.map((function(t){var o=t(e.getComponent());return n.on("NodeChange",o),function(){n.off("NodeChange",o)}})).getOr(t)},getApi:function(n){return{getComponent:function(){return n}}},columns:1,presets:"normal",classes:o.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",e.shared)};!function(n){n[n.SemiColon=0]="SemiColon",n[n.Space=1]="Space"}($C||($C={}));var hE,vE,bE,yE=function(n,t,e,o){return{type:"basic",data:function(n){return H(n,(function(n){var t=n,e=n,o=n.split("=");return o.length>1&&(t=o[0],e=o[1]),{title:t,format:e}}))}(function(n,t){return t===$C.SemiColon?n.replace(/;$/,"").split(";"):n.split(" ")}(n.getParam(t,e,"string"),o))}},xE=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],wE=function(n){var t=function(t){var e=W(xE,(function(t){return n.formatter.match(t.format)})).fold((function(){return"left"}),(function(n){return n.title.toLowerCase()}));Ho(t,uC,{icon:"align-"+e})},e=b.some((function(n){return function(){return t(n)}})),o=b.some((function(n){return t(n)})),r={type:"basic",data:xE};return{tooltip:"Align",icon:b.some("align-left"),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:b.none,getPreviewFor:function(n){return function(){return b.none()}},onAction:function(t){return function(){return W(xE,(function(n){return n.format===t.format})).each((function(t){return n.execCommand(t.command)}))}},setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},SE=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],kE=function(n){var t=n.split(/\s*,\s*/);return H(t,(function(n){return n.replace(/^['"]+|['"]+$/g,"")}))},CE=function(n){var t=function(){var t=function(n){return n?kE(n)[0]:""},e=n.queryCommandValue("FontName"),o=i.data,r=e?e.toLowerCase():"";return{matchOpt:W(o,(function(n){var e=n.format;return e.toLowerCase()===r||t(e).toLowerCase()===t(r).toLowerCase()})).orThunk((function(){return function(n){var t;return 0===n.indexOf("-apple-system")&&(t=kE(n.toLowerCase()),q(SE,(function(n){return t.indexOf(n.toLowerCase())>-1})))}(r)?b.from({title:"System Font",format:r}):b.none()})),font:e}},e=function(n){var e=t(),o=e.matchOpt,r=e.font,i=o.fold((function(){return r}),(function(n){return n.title}));Ho(n,iC,{text:i})},o=b.some((function(n){return function(){return e(n)}})),r=b.some((function(n){return e(n)})),i=yE(n,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",$C.SemiColon);return{tooltip:"Fonts",icon:b.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getCurrentValue:function(){return t().matchOpt},getPreviewFor:function(n){return function(){return b.some({tag:"div",styles:-1===n.indexOf("dings")?{"font-family":n}:{}})}},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontName",!1,t.format)}))}},setInitialValue:r,nodeChangeHandler:o,dataset:i,shouldHide:!1,isInvalid:c}},OE={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},_E={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},TE=function(n,t){return/[0-9.]+px$/.test(n)?function(n,t){var e=Math.pow(10,t);return Math.round(n*e)/e}(72*parseInt(n,10)/96,t||0)+"pt":En(_E,n).getOr(n)},EE=function(n){var t=function(){var t=b.none(),e=a.data,o=n.queryCommandValue("FontSize");if(o)for(var r=function(n){var r=TE(o,n),i=function(n){return En(OE,n).getOr("")}(r);t=W(e,(function(n){return n.format===o||n.format===r||n.format===i}))},i=3;t.isNone()&&i>=0;i--)r(i);return{matchOpt:t,size:o}},e=o(b.none),r=function(n){var e=t(),o=e.matchOpt,r=e.size,i=o.fold((function(){return r}),(function(n){return n.title}));Ho(n,iC,{text:i})},i=b.some((function(n){return function(){return r(n)}})),u=b.some((function(n){return r(n)})),a=yE(n,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",$C.Space);return{tooltip:"Font sizes",icon:b.none(),isSelectedFor:function(n){return function(t){return t.exists((function(t){return t.format===n}))}},getPreviewFor:e,getCurrentValue:function(){return t().matchOpt},onAction:function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("FontSize",!1,t.format)}))}},setInitialValue:u,nodeChangeHandler:i,dataset:a,shouldHide:!1,isInvalid:c}},DE=function(n,t){var e=t(),o=H(e,(function(n){return n.format}));return b.from(n.formatter.closest(o)).bind((function(n){return W(e,(function(t){return t.format===n}))})).orThunk((function(){return zl(n.formatter.match("p"),{title:"Paragraph",format:"p"})}))},BE=function(n){var t=ce(b.none()),e=function(){return t.get().each(n)};return{clear:function(){e(),t.set(b.none())},isSet:function(){return t.get().isSome()},set:function(n){e(),t.set(b.some(n))}}},AE=function(){return BE((function(n){return n.destroy()}))},ME=function(){return BE((function(n){return n.unbind()}))},FE=function(n,t){return function(e){var o=ME(),r=function(){e.setActive(n.formatter.match(t));var r=n.formatter.formatChanged(t,e.setActive);o.set(r)};return n.initialized?r():n.on("init",r),o.clear}},IE=function(n){return function(t){return function(){n.undoManager.transact((function(){n.focus(),n.execCommand("mceToggleFormat",!1,t.format)}))}}},RE=function(n){var t=function(t){var e=DE(n,(function(){return r.data})).fold((function(){return"Paragraph"}),(function(n){return n.title}));Ho(t,iC,{text:e})},e=b.some((function(n){return function(){return t(n)}})),o=b.some((function(n){return t(n)})),r=yE(n,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",$C.SemiColon);return{tooltip:"Blocks",icon:b.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:b.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t);return b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))})}},onAction:IE(n),setInitialValue:o,nodeChangeHandler:e,dataset:r,shouldHide:!1,isInvalid:function(t){return!n.formatter.canApply(t.format)}}},VE=function(n,t){var e=function(t){var e=function(n){var t=n.items;return void 0!==t&&t.length>0?Y(t,e):[{title:n.title,format:n.format}]},o=Y(QO(n),e),r=DE(n,(function(){return o})).fold((function(){return"Paragraph"}),(function(n){return n.title}));Ho(t,iC,{text:r})},o=b.some((function(n){return function(){return e(n)}})),r=b.some((function(n){return e(n)}));return{tooltip:"Formats",icon:b.none(),isSelectedFor:function(t){return function(){return n.formatter.match(t)}},getCurrentValue:b.none,getPreviewFor:function(t){return function(){var e=n.formatter.get(t);return void 0!==e?b.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:n.dom.parseStyle(n.formatter.getCssText(t))}):b.none()}},onAction:IE(n),setInitialValue:r,nodeChangeHandler:o,shouldHide:n.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(t){return!n.formatter.canApply(t.format)},dataset:t}},PE=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],HE=function(n,t){return function(e,o,r){var i=n(e).mapError((function(n){return Ot(n)})).getOrDie();return t(i,o,r)}},zE={button:HE(Mp,(function(n,t){return e=n,o=t.backstage.shared.providers,QT(e,o,[]);var e,o})),togglebutton:HE(Rp,(function(n,t){return e=n,o=t.backstage.shared.providers,ZT(e,o,[]);var e,o})),menubutton:HE(FT,(function(n,t){return pC(n,"tox-tbtn",t.backstage,b.none())})),splitbutton:HE((function(n){return St("SplitButton",IT,n)}),(function(n,e){return function(n,e){var o,r=qr("channel-update-split-dropdown-display"),i=function(n){return{isDisabled:function(){return $h.isDisabled(n)},setDisabled:function(t){return $h.set(n,t)},setIconFill:function(t,e){Nu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Pr(n,"fill",e)}))},setIconStroke:function(t,e){Nu(n.element,'svg path[id="'+t+'"], rect[id="'+t+'"]').each((function(n){Pr(n,"stroke",e)}))},setActive:function(t){Pr(n.element,"aria-pressed",t),Nu(n.element,"span").each((function(e){n.getSystem().getByDom(e).each((function(n){return bg.set(n,t)}))}))},isActive:function(){return Nu(n.element,"span").exists((function(t){return n.getSystem().getByDom(t).exists(bg.isOn)}))}}},u=ce(t),a={getApi:i,onSetup:n.onSetup};return UT.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:l({"aria-pressed":!1},XT(n.tooltip,e.providers))},onExecute:function(t){n.onAction(i(t))},onItemExecute:function(n,t,e){},splitDropdownBehaviours:qa([Bv(e.providers.isDisabled),Tv(),tg("split-dropdown-events",[Xo(YT,ug.focus),Fv(a,u),Iv(a,u)]),Nx.config({})]),eventOrder:(o={},o[To()]=["alloy.base.behaviour","split-dropdown-events"],o),toggleClass:"tox-tbtn--enabled",lazySink:e.getSink,fetch:nE(i,n,e.providers),parts:{menu:rh(0,n.columns,n.presets)},components:[UT.parts.button(KT(n.icon,n.text,b.none(),b.some(r),b.some([bg.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),e.providers)),UT.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:op("chevron-down",e.providers.icons)},buttonBehaviours:qa([Bv(e.providers.isDisabled),Tv()])}),UT.parts["aria-descriptor"]({text:e.providers.translate("To open the popup, press Shift+Enter")})]})}(n,e.backstage.shared)})),grouptoolbarbutton:HE((function(n){return St("GroupToolbarButton",BT,n)}),(function(n,t,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[Fc]=t.backstage.shared.header.isPositionedAtTop()?Gu.TopToBottom:Gu.BottomToTop,o);switch(fv(e)){case Gp.floating:return function(n,t,e,o){var r=t.shared;return q_.sketch({lazySink:r.getSink,fetch:function(){return ux((function(t){t(H(e(n.items),CT))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:KT(n.icon,n.text,n.tooltip,b.none(),b.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(n,t.backstage,(function(n){return UE(e,{buttons:r,toolbar:n,allowToolbarGroups:!1},t,b.none())}),i);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(n,t){return function(n,t){var e=l({type:"advanced"},t.styleselect);return pE(n,t,VE(n,e))}(n,t.backstage)},fontsizeSelectButton:function(n,t){return function(n,t){return pE(n,t,EE(n))}(n,t.backstage)},fontSelectButton:function(n,t){return function(n,t){return pE(n,t,CE(n))}(n,t.backstage)},formatButton:function(n,t){return function(n,t){return pE(n,t,RE(n))}(n,t.backstage)},alignMenuButton:function(n,t){return function(n,t){return pE(n,t,wE(n))}(n,t.backstage)}},NE={styleselect:zE.styleSelectButton,fontsizeselect:zE.fontsizeSelectButton,fontselect:zE.fontSelectButton,formatselect:zE.formatButton,align:zE.alignMenuButton},LE=function(n){var t,e=n.toolbar,o=n.buttons;return!1===e?[]:void 0===e||!0===e?function(n){var t=H(PE,(function(t){var e=L(t.items,(function(t){return Dn(n,t)||Dn(NE,t)}));return{name:t.name,items:e}}));return L(t,(function(n){return n.items.length>0}))}(o):w(e)?(t=e.split("|"),H(t,(function(n){return{items:n.trim().split(" ")}}))):function(n){return D(n,(function(n){return Dn(n,"name")&&Dn(n,"items")}))}(e)?e:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},jE=function(n,t,e,o,r,i){return En(t,e.toLowerCase()).orThunk((function(){return i.bind((function(n){return en(n,(function(n){return En(t,n+e.toLowerCase())}))}))})).fold((function(){return En(NE,e.toLowerCase()).map((function(t){return t(n,r)})).orThunk((function(){return b.none()}))}),(function(t){return"grouptoolbarbutton"!==t.type||o?function(n,t,e){return En(zE,n.type).fold((function(){return console.error("skipping button defined by",n),b.none()}),(function(o){return b.some(o(n,t,e))}))}(t,r,n):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),b.none())}))},UE=function(n,t,e,o){var r=LE(t),i=H(r,(function(r){var i=Y(r.items,(function(r){return 0===r.trim().length?[]:jE(n,t.buttons,r,t.allowToolbarGroups,e,o).toArray()}));return{title:b.from(n.translate(r.name)),items:i}}));return L(i,(function(n){return n.items.length>0}))},WE={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},GE={maxHeightFunction:Cc(),maxWidthFunction:B_()},XE={onLtr:function(){return[Ma,Fa,Ba,Ea,Aa,Da,$g,Qg,Jg,Yg,Kg,qg]},onRtl:function(){return[Ma,Fa,Aa,Da,Ba,Ea,$g,Qg,Kg,qg,Jg,Yg]}},YE={onLtr:function(){return[Fa,Ea,Da,Ba,Aa,Ma,$g,Qg,Jg,Yg,Kg,qg]},onRtl:function(){return[Fa,Da,Ea,Aa,Ba,Ma,$g,Qg,Kg,qg,Jg,Yg]}},qE=function(n,e,o,r){var i,u,a=Me().deviceType.isTouch,c=uu((i={sink:o,onEscape:function(){return n.focus(),b.some(!0)}},u=ce([]),Lg.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(n){u.set([]),Lg.getContent(n).each((function(n){Xi(n.element,"visibility")})),Ei(n.element,"tox-pop--resizing"),Xi(n.element,"width")},inlineBehaviours:qa([tg("context-toolbar-events",[Zo(ao(),(function(n,t){Ei(n.element,"tox-pop--resizing"),Xi(n.element,"width")})),Xo(dE,(function(n,t){var e=n.element;Xi(e,"width");var o=bu(e);Lg.setContent(n,t.event.contents),_i(e,"tox-pop--resizing");var r=bu(e);Hi(e,"width",o+"px"),Lg.getContent(n).each((function(n){t.event.focus.bind((function(n){return ec(n),rc(e)})).orThunk((function(){return Jm.focusIn(n),oc(wr(e))}))})),Zg.setTimeout((function(){Hi(n.element,"width",r+"px")}),0)})),Xo(fE,(function(n,t){Lg.getContent(n).each((function(t){u.set(u.get().concat([{bar:t,focus:oc(wr(n.element))}]))})),Ho(n,dE,{contents:t.event.forwardContents,focus:b.none()})})),Xo(lE,(function(n,t){nn(u.get()).each((function(t){u.set(u.get().slice(0,u.get().length-1)),Ho(n,dE,{contents:au(t.bar),focus:t.focus})}))}))]),Jm.config({mode:"special",onEscape:function(n){return nn(u.get()).fold((function(){return i.onEscape()}),(function(t){return Po(n,lE),b.some(!0)}))}})]),lazySink:function(){return un.value(i.sink)}}))),s=function(){return iE(n,r.backstage.shared)},f=function(){if(a()&&r.backstage.isContextMenuOpen())return!0;var t,e,o,i,u,c,f=(t=h.get().filter((function(n){return Fi(fe.fromDom(n))})).map((function(n){return n.getBoundingClientRect()})).getOrThunk((function(){return n.selection.getRng().getBoundingClientRect()})),e=n.inline?ku().top:Mu(fe.fromDom(n.getBody())).y,{y:t.top+e,bottom:t.bottom+e}),l=s();return o=f.y,i=f.bottom,u=l.y,c=l.bottom,!(Math.max(o,u)<=Math.min(i,c))},d=function(){p.set(b.none()),Lg.hide(c)},m=function(){Lg.hide(c)},g=function(){p.get().each((function(n){var t=c.element;Xi(t,"display"),f()?Hi(t,"display","none"):Ws.positionWithinBounds(o,n,c,b.some(s()))}))},p=ce(b.none()),h=ce(b.none()),v=ce(null),y=function(t){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[t],behaviours:qa([Jm.config({mode:"acyclic"}),tg("pop-dialog-wrap-events",[nr((function(t){n.shortcuts.add("ctrl+F9","focus statusbar",(function(){return Jm.focusIn(t)}))})),tr((function(t){n.shortcuts.remove("ctrl+F9")}))])])}},x=Vn((function(){return sE(e,(function(n){var t=w([n]);Ho(c,fE,{forwardContents:y(t)})}))})),w=function(t){var e=n.ui.registry.getAll().buttons,o=x(),i=l(l({},e),o.formNavigators),u=fv(n)===Gp.scrolling?Gp.scrolling:Gp.default,a=X(H(t,(function(t){return"contexttoolbar"===t.type?function(t,e){return UE(n,{buttons:t,toolbar:e.items,allowToolbarGroups:!1},r,b.some(["form:"]))}(i,t):function(n,t){return rE(n,t)}(t,r.backstage.shared.providers)})));return DT({type:u,uid:qr("context-toolbar"),initGroups:a,onEscape:b.none,cyclicKeying:!0,providers:r.backstage.shared.providers})};n.on("contexttoolbar-show",(function(t){var e=x();En(e.lookupTable,t.toolbarKey).each((function(e){k([e],t.target===n?b.none():b.some(t)),Lg.getContent(c).each(Jm.focusIn)}))}));var S=function(n,t){var e="node"===n?r.backstage.shared.anchors.node(t):r.backstage.shared.anchors.cursor();return In(e,function(n,t){return"line"===n?{bubble:Ec(12,0,WE),layouts:{onLtr:function(){return[Ia]},onRtl:function(){return[Ra]}},overrides:GE}:{bubble:Ec(0,12,WE),layouts:t?YE:XE,overrides:GE}}(n,a()))},k=function(n,t){if(O(),!a()||!r.backstage.isContextMenuOpen()){var e=w(n),o=t.map(fe.fromDom),i=S(n[0].position,o);p.set(b.some(i)),h.set(t);var u=c.element;Xi(u,"display"),Lg.showWithinBounds(c,i,y(e),(function(){return b.some(s())})),f()&&Hi(u,"display","none")}},C=function(){n.hasFocus()&&function(n,t){var e=fe.fromDom(t.getBody()),o=function(n){return Re(n,e)},r=fe.fromDom(t.selection.getNode());return function(n){return!o(n)&&!Pe(e,n)}(r)?b.none():aE(r,n.inNodeScope,n.inEditorScope).orThunk((function(){return cE(o,r,n)}))}(x(),n).fold(d,(function(n){k(n.toolbars,b.some(n.elem.dom))}))},O=function(){var n=v.get();null!==n&&(Zg.clearTimeout(n),v.set(null))},_=function(){O(),v.set(Zg.setEditorTimeout(n,C,0))};n.on("init",(function(){n.on("contexttoolbar-hide",m),n.on("ScrollContent ScrollWindow longpress",g),n.on("click keyup focus SetContent ObjectResized ResizeEditor",(function(){_()})),n.on("focusout",(function(t){Zg.setEditorTimeout(n,(function(){rc(o.element).isNone()&&rc(c.element).isNone()&&d()}),0)})),n.on("SwitchMode",(function(){n.mode.isReadOnly()&&d()})),n.on("AfterProgressState",(function(t){t.state?d():n.hasFocus()&&_()})),n.on("NodeChange",(function(n){rc(c.element).fold(_,t)}))}))},JE=Bl,KE=ml,$E=o([Qt("shell",!1),Pt("makeItem"),Qt("setupItem",t),Pf("listBehaviours",[ng])]),QE=fl({name:"items",overrides:function(){return{behaviours:qa([ng.config({})])}}}),ZE=o([QE]),nD=o("CustomList"),tD=Pl({name:nD(),configFields:$E(),partFields:ZE(),factory:function(n,t,e,o){var r=n.shell?{behaviours:[ng.config({})],components:[]}:{behaviours:[],components:t},i=function(t){return n.shell?b.some(t):Sl(t,n,"items")};return{uid:n.uid,dom:n.dom,components:r.components,behaviours:Vf(n.listBehaviours,r.behaviours),apis:{setItems:function(t,e){i(t).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=ng.contents(o),i=e.length,u=i-r.length,a=u>0?V(u,(function(){return n.makeItem()})):[],c=r.slice(i);z(c,(function(n){return ng.remove(o,n)})),z(a,(function(n){return ng.append(o,n)}));var s=ng.contents(o);z(s,(function(o,r){n.setupItem(t,o,e[r],r)}))}))}}}},apis:{setItems:function(n,t,e){n.setItems(t,e)}}}),eD=t,oD=c,rD=o([]),iD=Object.freeze({__proto__:null,setup:eD,isDocked:oD,getBehaviours:rD}),uD=function(n){return(Ui(n,"position").is("fixed")?b.none():pr(n)).orThunk((function(){var t=fe.fromTag("span");return gr(n).bind((function(n){Dr(n,t);var e=pr(t);return Mr(t),e}))}))},aD=function(n){return uD(n).map(pu).getOrThunk((function(){return mu(0,0)}))},cD=An([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),sD=function(n,t){var e=n.element;_i(e,t.transitionClass),Ei(e,t.fadeOutClass),_i(e,t.fadeInClass),t.onShow(n)},fD=function(n,t){var e=n.element;_i(e,t.transitionClass),Ei(e,t.fadeInClass),_i(e,t.fadeOutClass),t.onHide(n)},lD=function(n,t,e){return q(n,(function(n){switch(n){case"bottom":return function(n,t){return n.bottom<=t.bottom}(t,e);case"top":return function(n,t){return n.y>=t.y}(t,e)}}))},dD=function(n,t){return t.getInitialPosition().map((function(t){return Bu(t.bounds.x,t.bounds.y,bu(n),fu(n))}))},mD=function(n,t,e){return e.getInitialPosition().bind((function(o){switch(e.setInitialPosition(b.none()),o.position){case"static":return b.some(cD.static());case"absolute":var r=uD(n).map(Au).getOrThunk((function(){return Au(Ii())}));return b.some(cD.absolute(uc("absolute",En(o.style,"left").map((function(n){return t.x-r.x})),En(o.style,"top").map((function(n){return t.y-r.y})),En(o.style,"right").map((function(n){return r.right-t.right})),En(o.style,"bottom").map((function(n){return r.bottom-t.bottom})))));default:return b.none()}}))},gD=function(n,t,e){var o=Au(n);if(lD(e.getModes(),o,t))return b.none();!function(n,t,e){e.setInitialPosition(b.some({style:Wi(n),position:Li(n,"position")||"static",bounds:t}))}(n,o,e);var r=Fu(),i=o.x-r.x,u=t.y-r.y,a=r.bottom-t.bottom,c=o.y<=t.y;return b.some(cD.fixed(uc("fixed",b.some(i),c?b.some(u):b.none(),b.none(),c?b.none():b.some(a))))},pD=function(n,t,e){var o=n.element;return Ui(o,"position").is("fixed")?function(n,t,e){return dD(n,e).filter((function(n){return lD(e.getModes(),n,t)})).bind((function(t){return mD(n,t,e)}))}(o,t,e):gD(o,t,e)},hD=function(n,t){z(["left","right","top","bottom","position"],(function(t){return Xi(n.element,t)})),t.onUndocked(n)},vD=function(n,t,e){ac(n.element,e),("fixed"===e.position?t.onDocked:t.onUndocked)(n)},bD=function(n,t,e,o,r){void 0===r&&(r=!1),t.contextual.each((function(t){t.lazyContext(n).each((function(i){var u=function(n,t){return n.y<t.bottom&&n.bottom>t.y}(i,o);u!==e.isVisible()&&(e.setVisible(u),r&&!u?(Bi(n.element,[t.fadeOutClass]),t.onHide(n)):(u?sD:fD)(n,t))}))}))},yD=function(n,e,o){var r=n.element;o.setDocked(!1),function(n,t){var e=n.element;return dD(e,t).bind((function(n){return mD(e,n,t)}))}(n,o).each((function(o){o.fold((function(){return hD(n,e)}),(function(t){return vD(n,e,t)}),t)})),o.setVisible(!0),e.contextual.each((function(t){Ai(r,[t.fadeInClass,t.fadeOutClass,t.transitionClass]),t.onShow(n)})),xD(n,e,o)},xD=function(n,t,e){n.getSystem().isConnected()&&function(n,t,e){var o=t.lazyViewport(n),r=e.isDocked();r&&bD(n,t,e,o),pD(n,o,e).each((function(i){e.setDocked(!r),i.fold((function(){return hD(n,t)}),(function(e){return vD(n,t,e)}),(function(r){bD(n,t,e,o,!0),vD(n,t,r)}))}))}(n,t,e)},wD=function(n,t,e){e.isDocked()&&yD(n,t,e)},SD=Object.freeze({__proto__:null,refresh:xD,reset:wD,isDocked:function(n,t,e){return e.isDocked()},getModes:function(n,t,e){return e.getModes()},setModes:function(n,t,e,o){return e.setModes(o)}}),kD=Object.freeze({__proto__:null,events:function(n,t){return Uo([Zo(ao(),(function(e,o){n.contextual.each((function(n){Di(e.element,n.transitionClass)&&(Ai(e.element,[n.transitionClass,n.fadeInClass]),(t.isVisible()?n.onShown:n.onHidden)(e));o.stop()}))})),Xo(Oo(),(function(e,o){xD(e,n,t)})),Xo(_o(),(function(e,o){wD(e,n,t)}))])}}),CD=[$t("contextual",[Nt("fadeInClass"),Nt("fadeOutClass"),Nt("transitionClass"),jt("lazyContext"),ra("onShow"),ra("onShown"),ra("onHide"),ra("onHidden")]),re("lazyViewport",Fu),ie("modes",["top","bottom"],At),ra("onDocked"),ra("onUndocked")],OD=Object.freeze({__proto__:null,init:function(n){var t=ce(!1),e=ce(!0),o=ce(b.none()),r=ce(n.modes);return li({isDocked:t.get,setDocked:t.set,getInitialPosition:o.get,setInitialPosition:o.set,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+t.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}}),_D=Ka({fields:CD,name:"docking",active:kD,apis:SD,state:OD}),TD={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},ED=function(n){var t=n.element;gr(t).each((function(e){var o="padding-"+_D.getModes(n)[0];if(_D.isDocked(n)){var r=bu(e);Hi(t,"width",r+"px"),Hi(e,o,function(n){return lu(n)+(parseInt(Li(n,"margin-top"),10)||0)+(parseInt(Li(n,"margin-bottom"),10)||0)}(t)+"px")}else Xi(t,"width"),Xi(e,o)}))},DD=function(n,t){t?(Ei(n,TD.fadeOutClass),Bi(n,[TD.transitionClass,TD.fadeInClass])):(Ei(n,TD.fadeInClass),Bi(n,[TD.fadeOutClass,TD.transitionClass]))},BD=function(n,t){var e=fe.fromDom(n.getContainer());t?(_i(e,"tox-tinymce--toolbar-sticky-on"),Ei(e,"tox-tinymce--toolbar-sticky-off")):(_i(e,"tox-tinymce--toolbar-sticky-off"),Ei(e,"tox-tinymce--toolbar-sticky-on"))},AD=function(n,t){var e=ce(b.none()),o=t.getSink,r=function(n){o().each((function(t){return n(t.element)}))},i=function(t){n.inline||ED(t),BD(n,_D.isDocked(t)),t.getSystem().broadcastOn([pf()],{}),o().each((function(n){return n.getSystem().broadcastOn([pf()],{})}))},u=n.inline?[]:function(){var n;return[nc.config({channels:(n={},n[ST()]={onReceive:ED},n)})]}();return m([ug.config({}),_D.config({contextual:l({lazyContext:function(t){var e,o,r=lu(t.element),i=n.inline?n.getContentAreaContainer():n.getContainer(),u=Au(fe.fromDom(i)),a=u.height-r,c=u.y+(e=t,o="top",I(_D.getModes(e),o)?0:r);return b.some(Bu(u.x,c,u.width,a))},onShow:function(){r((function(n){return DD(n,!0)}))},onShown:function(n){r((function(n){return Ai(n,[TD.transitionClass,TD.fadeInClass])})),e.get().each((function(t){var o,r,i;o=n.element,i=fr(r=t),oc(i).filter((function(n){return!Re(r,n)})).filter((function(n){return Re(n,fe.fromDom(i.dom.body))||Pe(o,n)})).each((function(){return ec(r)})),e.set(b.none())}))},onHide:function(n){e.set(function(n,t){return rc(n).orThunk((function(){return t().toOptional().bind((function(n){return rc(n.element)}))}))}(n.element,o)),r((function(n){return DD(n,!1)}))},onHidden:function(){r((function(n){return Ai(n,[TD.transitionClass])}))}},TD),modes:[t.header.getDockingMode()],onDocked:i,onUndocked:i})],u)},MD=Object.freeze({__proto__:null,setup:function(n,t,e){n.inline||(t.header.isPositionedAtTop()||n.on("ResizeEditor",(function(){e().each(_D.reset)})),n.on("ResizeWindow ResizeEditor",(function(){e().each(ED)})),n.on("SkinLoaded",(function(){e().each((function(n){_D.isDocked(n)?_D.reset(n):_D.refresh(n)}))})),n.on("FullscreenStateChanged",(function(){e().each(_D.reset)}))),n.on("AfterScrollIntoView",(function(n){e().each((function(t){_D.refresh(t);var e=t.element;Ud(e)&&function(n,t){var e=fr(t),o=e.dom.defaultView.innerHeight,r=ku(e),i=fe.fromDom(n.elm),u=Mu(i),a=fu(i),c=u.y,s=c+a,f=pu(t),l=fu(t),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)Cu(r.left,c-l,e);else if(p&&s>d){var h=c-o+a+l;Cu(r.left,h,e)}}(n,e)}))})),n.on("PostRender",(function(){BD(n,!1)}))},isDocked:function(n){return n().map(_D.isDocked).getOr(!1)},getBehaviours:AD}),FD=Vl({factory:function(n,t){var e={focus:Jm.focusIn,setMenus:function(n,e){var o=H(e,(function(n){var e={type:"menubutton",text:n.text,fetch:function(t){t(n.getItems())}},o=FT(e).mapError((function(n){return Ot(n)})).getOrDie();return pC(o,"tox-mbtn",t.backstage,b.some("menuitem"))}));ng.set(n,o)}};return{uid:n.uid,dom:n.dom,components:[],behaviours:qa([ng.config({}),tg("menubar-events",[nr((function(t){n.onSetup(t)})),Xo(Ze(),(function(n,t){Nu(n.element,".tox-mbtn--active").each((function(e){Lu(t.event.target,".tox-mbtn").each((function(t){Re(e,t)||n.getSystem().getByDom(e).each((function(e){n.getSystem().getByDom(t).each((function(n){Hx.expand(n),Hx.close(e),ug.focus(n)}))}))}))}))})),Xo(Ao(),(function(n,t){t.event.prevFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(e){t.event.newFocus.bind((function(t){return n.getSystem().getByDom(t).toOptional()})).each((function(n){Hx.isOpen(e)&&(Hx.expand(n),Hx.close(e))}))}))}))]),Jm.config({mode:"flow",selector:".tox-mbtn",onEscape:function(t){return n.onEscape(t),b.some(!0)}}),Ay.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[Pt("dom"),Pt("uid"),Pt("onEscape"),Pt("backstage"),Qt("onSetup",t)],apis:{focus:function(n,t){n.focus(t)},setMenus:function(n,t,e){n.setMenus(t,e)}}}),ID=[If("slotBehaviours",[])],RD=function(n){return"<alloy.field."+n+">"},VD=function(n,t){var e,o=function(t){return _l(n)},r=function(t,e){return function(o,r){return Sl(o,n,r).map((function(n){return t(n,r)})).getOr(e)}},i=function(n,t){return"true"!==Hr(n.element,"aria-hidden")},u=r(i,!1),a=r((function(n,t){if(i(n)){var e=n.element;Hi(e,"display","none"),Pr(e,"aria-hidden","true"),Ho(n,Mo(),{name:t,visible:!1})}})),c=(e=a,function(n,t){z(t,(function(t){return e(n,t)}))}),s=r((function(n,t){if(!i(n)){var e=n.element;Xi(e,"display"),Lr(e,"aria-hidden"),Ho(n,Mo(),{name:t,visible:!0})}})),f={getSlotNames:o,getSlot:function(t,e){return Sl(t,n,e)},isShowing:u,hideSlot:a,hideAllSlots:function(n){return c(n,o())},showSlot:s};return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.slotBehaviours),apis:f}},PD=Sn({getSlotNames:function(n,t){return n.getSlotNames(t)},getSlot:function(n,t,e){return n.getSlot(t,e)},isShowing:function(n,t,e){return n.isShowing(t,e)},hideSlot:function(n,t,e){return n.hideSlot(t,e)},hideAllSlots:function(n,t){return n.hideAllSlots(t)},showSlot:function(n,t,e){return n.showSlot(t,e)}},(function(n){return si(n)})),HD=l(l({},PD),{sketch:function(n){var t=function(){var n=[];return{slot:function(t,e){return n.push(t),vl("container",RD(t),e)},record:function(){return n}}}(),e=n(t),o=t.record(),r=H(o,(function(n){return cl({name:n,pname:RD(n)})}));return Ml("container",ID,r,VD,e)}}),zD=at([Jt("icon"),Jt("tooltip"),re("onShow",t),re("onHide",t),re("onSetup",(function(){return t}))]),ND=function(n){return{element:function(){return n.element.dom}}},LD=function(n,e){var o=H(yn(e),(function(n){var t=e[n],o=kt(function(n){return St("sidebar",zD,n)}(t));return{name:n,getApi:ND,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return H(o,(function(e){var r=ce(t);return n.slot(e.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:Th([Fv(e,r),Iv(e,r),Xo(Mo(),(function(n,t){var e=t.event;W(o,(function(n){return n.name===e.name})).each((function(t){(e.visible?t.onShow:t.onHide)(t.getApi(n))}))}))])})}))},jD=function(n){return HD.sketch((function(t){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:LD(t,n),slotBehaviours:Th([nr((function(n){return HD.hideAllSlots(n)}))])}}))},UD=function(n){return Ul.getCurrent(n).bind((function(n){return hT.isGrowing(n)||hT.hasGrown(n)?Ul.getCurrent(n).bind((function(n){return W(HD.getSlotNames(n),(function(t){return HD.isShowing(n,t)}))})):b.none()}))},WD=qr("FixSizeEvent"),GD=qr("AutoSizeEvent"),XD=function(n){var t=fe.fromHtml(n),e=hr(t),o=function(n){var t=void 0!==n.dom.attributes?n.dom.attributes:[];return U(t,(function(n,t){var e;return"class"===t.name?n:l(l({},n),((e={})[t.name]=t.value,e))}),{})}(t),r=function(n){return Array.prototype.slice.call(n.dom.classList,0)}(t),i=0===e.length?{}:{innerHtml:Ir(t)};return l({tag:rr(t),classes:r,attributes:o},i)},YD=function(n){return{dom:{tag:"div",attributes:{"aria-label":n.translate("Loading...")},classes:["tox-throbber__busy-spinner"]},components:[{dom:XD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}],behaviours:qa([Jm.config({mode:"special",onTab:function(){return b.some(!0)},onShiftTab:function(){return b.some(!0)}}),ug.config({})])}},qD=function(n,t,e){var o=ce(!1),r=ce(b.none()),i=function(r){r!==o.get()&&(!function(n,t,e){var o=n.element;!0===t?(ng.set(n,[YD(e)]),Xi(o,"display"),Lr(o,"aria-hidden")):(ng.set(n,[]),Hi(o,"display","none"),Pr(o,"aria-hidden","true"))}(t(),r,e.providers),o.set(r),n.fire("AfterProgressState",{state:r}))};n.on("ProgressState",(function(t){if(r.get().each(Zg.clearTimeout),E(t.time)){var e=Zg.setEditorTimeout(n,(function(){return i(t.state)}),t.time);r.set(b.some(e))}else i(t.state),r.set(b.none())}))},JD=KE.optional({factory:FD,name:"menubar",schema:[Pt("backstage")]}),KD=KE.optional({factory:{sketch:function(n){return tD.sketch({uid:n.uid,dom:n.dom,listBehaviours:qa([Jm.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return DT({type:n.type,uid:qr("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:n.providers,onEscape:function(){return n.onEscape(),b.some(!0)}})},setupItem:function(n,t,e,o){F_.setGroups(t,e)},shell:!0})}},name:"multiple-toolbar",schema:[Pt("dom"),Pt("onEscape")]}),$D=KE.optional({factory:{sketch:function(n){return function(n){return n.type===Gp.sliding?ET:n.type===Gp.floating?TT:DT}(n)({type:n.type,uid:n.uid,onEscape:function(){return n.onEscape(),b.some(!0)},cyclicKeying:!1,initGroups:[],getSink:n.getSink,providers:n.providers,moreDrawerData:{lazyToolbar:n.lazyToolbar,lazyMoreButton:n.lazyMoreButton,lazyHeader:n.lazyHeader},attributes:n.attributes})}},name:"toolbar",schema:[Pt("dom"),Pt("onEscape"),Pt("getSink")]}),QD=KE.optional({factory:{sketch:function(n){var t=n.editor,e=n.sticky?AD:rD;return{uid:n.uid,dom:n.dom,components:n.components,behaviours:qa(e(t,n.sharedBackstage))}}},name:"header",schema:[Pt("dom")]}),ZD=KE.optional({name:"socket",schema:[Pt("dom")]}),nB=KE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:qa([Ay.config({}),ug.config({}),hT.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(n){Ul.getCurrent(n).each(HD.hideAllSlots),Po(n,GD)},onGrown:function(n){Po(n,GD)},onStartGrow:function(n){Ho(n,WD,{width:Ui(n.element,"width").getOr("")})},onStartShrink:function(n){Ho(n,WD,{width:bu(n.element)+"px"})}}),ng.config({}),Ul.config({find:function(n){var t=ng.contents(n);return Z(t)}})])}],behaviours:qa([WS(0),tg("sidebar-sliding-events",[Xo(WD,(function(n,t){Hi(n.element,"width",t.event.width)})),Xo(GD,(function(n,t){Xi(n.element,"width")}))])])}}},name:"sidebar",schema:[Pt("dom")]}),tB=KE.optional({factory:{sketch:function(n){return{uid:n.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:qa([ng.config({})]),components:[]}}},name:"throbber",schema:[Pt("dom")]}),eB=Pl({name:"OuterContainer",factory:function(n,t,e){var o={getSocket:function(t){return JE.getPart(t,n,"socket")},setSidebar:function(t,e){JE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Ul.getCurrent(n).each((function(n){return ng.set(n,[jD(t)])}))}(n,e)}))},toggleSidebar:function(t,e){JE.getPart(t,n,"sidebar").each((function(n){return function(n,t){Ul.getCurrent(n).each((function(n){Ul.getCurrent(n).each((function(e){hT.hasGrown(n)?HD.isShowing(e,t)?hT.shrink(n):(HD.hideAllSlots(e),HD.showSlot(e,t)):(HD.hideAllSlots(e),HD.showSlot(e,t),hT.grow(n))}))}))}(n,e)}))},whichSidebar:function(t){return JE.getPart(t,n,"sidebar").bind(UD).getOrNull()},getHeader:function(t){return JE.getPart(t,n,"header")},getToolbar:function(t){return JE.getPart(t,n,"toolbar")},setToolbar:function(t,e){JE.getPart(t,n,"toolbar").each((function(n){n.getApis().setGroups(n,e)}))},setToolbars:function(t,e){JE.getPart(t,n,"multiple-toolbar").each((function(n){tD.setItems(n,e)}))},refreshToolbar:function(t){JE.getPart(t,n,"toolbar").each((function(n){return n.getApis().refresh(n)}))},toggleToolbarDrawer:function(t){JE.getPart(t,n,"toolbar").each((function(n){var t,e;t=n.getApis().toggle,e=function(t){return t(n)},null!=t?b.some(e(t)):b.none()}))},isToolbarDrawerToggled:function(t){return JE.getPart(t,n,"toolbar").bind((function(n){return b.from(n.getApis().isOpen).map((function(t){return t(n)}))})).getOr(!1)},getThrobber:function(t){return JE.getPart(t,n,"throbber")},focusToolbar:function(t){JE.getPart(t,n,"toolbar").orThunk((function(){return JE.getPart(t,n,"multiple-toolbar")})).each((function(n){Jm.focusIn(n)}))},setMenubar:function(t,e){JE.getPart(t,n,"menubar").each((function(n){FD.setMenus(n,e)}))},focusMenubar:function(t){JE.getPart(t,n,"menubar").each((function(n){FD.focus(n)}))}};return{uid:n.uid,dom:n.dom,components:t,apis:o,behaviours:n.behaviours}},configFields:[Pt("dom"),Pt("behaviours")],partFields:[QD,JD,$D,KD,ZD,nB,tB],apis:{getSocket:function(n,t){return n.getSocket(t)},setSidebar:function(n,t,e){n.setSidebar(t,e)},toggleSidebar:function(n,t,e){n.toggleSidebar(t,e)},whichSidebar:function(n,t){return n.whichSidebar(t)},getHeader:function(n,t){return n.getHeader(t)},getToolbar:function(n,t){return n.getToolbar(t)},setToolbar:function(n,t,e){var o=H(e,(function(n){return CT(n)}));n.setToolbar(t,o)},setToolbars:function(n,t,e){var o=H(e,(function(n){return H(n,CT)}));n.setToolbars(t,o)},refreshToolbar:function(n,t){return n.refreshToolbar(t)},toggleToolbarDrawer:function(n,t){n.toggleToolbarDrawer(t)},isToolbarDrawerToggled:function(n,t){return n.isToolbarDrawerToggled(t)},getThrobber:function(n,t){return n.getThrobber(t)},setMenubar:function(n,t,e){n.setMenubar(t,e)},focusMenubar:function(n,t){n.focusMenubar(t)},focusToolbar:function(n,t){n.focusToolbar(t)}}}),oB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},rB=function(n){return"string"==typeof n?n.split(" "):n},iB=function(n,t){var e=l(l({},oB),t.menus),o=yn(t.menus).length>0,r=void 0===t.menubar||!0===t.menubar?rB("file edit view insert format tools table help"):rB(!1===t.menubar?"":t.menubar),i=L(r,(function(n){return o&&t.menus.hasOwnProperty(n)&&t.menus[n].hasOwnProperty("items")||oB.hasOwnProperty(n)})),u=H(i,(function(o){var r=e[o];return function(n,t,e){var o=function(n){return n.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:n.title,getItems:function(){return Y(n.items,(function(n){var e=n.toLowerCase();return 0===e.trim().length||R(o,(function(n){return n===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:t.menuItems[e]?[t.menuItems[e]]:[]}))}}}({title:r.title,items:rB(r.items)},t,n)}));return L(u,(function(n){return n.getItems().length>0&&R(n.getItems(),(function(n){return"separator"!==n.type}))}))},uB=function(n){var t=function(){n._skinLoaded=!0,function(n){n.fire("SkinLoaded")}(n)};return function(){n.initialized?t():n.on("init",t)}},aB=function(n,t,e){return new xp((function(o,r){e.load(t,o,r),n.on("remove",(function(){return e.unload(t)}))}))},cB=function(n,t){return aB(n,t+"/skin.min.css",n.ui.styleSheetLoader)},sB=function(n,t){var e;return(e=fe.fromDom(n.getElement()),kr(e).isSome())?aB(n,t+"/skin.shadowdom.min.css",Vh.DOM.styleSheetLoader):xp.resolve()},fB=function(n,t){var e=function(n){var t=n.getParam("skin"),e=n.getParam("skin_url");if(!1!==t){var o=t||"oxide";e=e?n.documentBaseURI.toAbsolute(e):Qh.baseURL+"/skins/ui/"+o}return e}(t);e&&t.contentCSS.push(e+(n?"/content.inline":"/content")+".min.css"),!1===function(n){return!1===n.getParam("skin")}(t)&&w(e)?xp.all([cB(t,e),sB(t,e)]).then(uB(t),function(n,t){return function(){return function(n,t){return n.fire("SkinLoadError",t)}(n,{message:t})}}(t,"Skin could not be loaded")):uB(t)()},lB=i(fB,!1),dB=i(fB,!0),mB=function(n,t,e,o){var r=t.outerContainer,i=e.toolbar,u=e.buttons;if(D(i,w)){var a=i.map((function(t){var r={toolbar:t,buttons:u,allowToolbarGroups:e.allowToolbarGroups};return UE(n,r,{backstage:o},b.none())}));eB.setToolbars(r,a)}else eB.setToolbar(r,UE(n,e,{backstage:o},b.none()))},gB=Me(),pB=gB.os.isiOS()&&gB.os.version.major<=12,hB=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var i=ce(0),u=t.outerContainer;lB(n);var a=fe.fromDom(r.targetNode),c=Sr(wr(a));!function(n,t){tf(n,t,Tr)}(a,t.mothership),nf(c,t.uiMothership),n.on("PostRender",(function(){mB(n,t,e,o),i.set(n.getWin().innerWidth),eB.setMenubar(u,iB(n,e)),eB.setSidebar(u,e.sidebar),function(n,t){var e=n.dom,o=n.getWin(),r=n.getDoc().documentElement,i=ce(mu(o.innerWidth,o.innerHeight)),u=ce(mu(r.offsetWidth,r.offsetHeight)),a=function(){var t=i.get();t.left===o.innerWidth&&t.top===o.innerHeight||(i.set(mu(o.innerWidth,o.innerHeight)),wb(n))},c=function(){var t=n.getDoc().documentElement,e=u.get();e.left===t.offsetWidth&&e.top===t.offsetHeight||(u.set(mu(t.offsetWidth,t.offsetHeight)),wb(n))},s=function(t){return function(n,t){return n.fire("ScrollContent",t)}(n,t)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=ay(fe.fromDom(n.getBody()),"load",c),l=t.uiMothership.element;n.on("hide",(function(){Hi(l,"display","none")})),n.on("show",(function(){Xi(l,"display")})),n.on("NodeChange",c),n.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(n,t)}));var s,f,l,d=eB.getSocket(u).getOrDie("Could not find expected socket element");if(pB){zi(d.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var m=(s=function(){n.fire("ScrollContent")},f=20,l=null,{cancel:function(){null!==l&&(clearTimeout(l),l=null)},throttle:function(){for(var n=[],t=0;t<arguments.length;t++)n[t]=arguments[t];null===l&&(l=setTimeout((function(){s.apply(null,n),l=null}),f))}}),g=uy(d.element,"scroll",m.throttle);n.on("remove",g.unbind)}_v(n,t),n.addCommand("ToggleSidebar",(function(t,e){eB.toggleSidebar(u,e),n.fire("ToggleSidebar")})),n.addQueryValueHandler("ToggleSidebar",(function(){return eB.whichSidebar(u)}));var p=fv(n);p!==Gp.sliding&&p!==Gp.floating||n.on("ResizeWindow ResizeEditor ResizeContent",(function(){var e=n.getWin().innerWidth;e!==i.get()&&(eB.refreshToolbar(t.outerContainer),i.set(e))}));var h={enable:function(){Ov(t,!1)},disable:function(){Ov(t,!0)},isDisabled:function(){return $h.isDisabled(u)}};return{iframeContainer:d.element.dom,editorContainer:u.element.dom,api:h}}}),vB=function(n){return/^[0-9\.]+(|px)$/i.test(""+n)?b.some(parseInt(""+n,10)):b.none()},bB=function(n){return E(n)?n+"px":n},yB=function(n,t,e){var o=t.filter((function(t){return n<t})),r=e.filter((function(t){return n>t}));return o.or(r).getOr(n)},xB=function(n){return function(n){var t=Zh(n),e=ev(n),o=rv(n);return vB(t).map((function(n){return yB(n,e,o)}))}(n).getOr(Zh(n))},wB=function(n){var t=nv(n),e=tv(n),o=ov(n);return vB(t).map((function(n){return yB(n,e,o)}))},SB=function(n,t,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=Vh.DOM,c=hv(n),s=yv(n),f=ov(n).or(wB(n)),l=o.shared.header,d=l.isPositionedAtTop,m=fv(n),g=m===Gp.sliding||m===Gp.floating,p=ce(!1),h=function(){return p.get()&&!n.removed},v=function(n){return g?n.fold((function(){return 0}),(function(n){return n.components().length>1?fu(n.components()[1].element):0})):0},b=function(){i.broadcastOn([pf()],{})},y=function(n){if(void 0===n&&(n=!1),h()){var e;if(c||(e=f.getOrThunk((function(){var n=vB(Li(Ii(),"margin-left")).getOr(0);return bu(Ii())-pu(t).left+n})),Hi(r.get().element,"max-width",e+"px")),g&&eB.refreshToolbar(u),c||function(){var n=eB.getToolbar(u),e=v(n),o=Au(t),i=d()?Math.max(o.y-fu(r.get().element)+e,0):o.bottom;zi(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})}(),s){var o=r.get();n?_D.reset(o):_D.refresh(o)}b()}},x=function(e){if(void 0===e&&(e=!0),!c&&s&&h()){var o=l.getDockingMode(),i=function(e){switch(mv(n)){case sv.auto:var o=eB.getToolbar(u),r=v(o),i=fu(e.element)-r,a=Au(t);if(a.y>i)return"top";var c=dr(t),s=Math.max(c.dom.scrollHeight,fu(c));return a.bottom<s-i||Fu().bottom<a.bottom-i?"bottom":"top";case sv.bottom:return"bottom";case sv.top:default:return"top"}}(r.get());i!==o&&(!function(n){var t=r.get();_D.setModes(t,[n]),l.setDockingMode(n);var e=d()?Gu.TopToBottom:Gu.BottomToTop;Pr(t.element,Fc,e)}(i),e&&y(!0))}};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),Hi(u.element,"display","flex"),a.addClass(n.getBody(),"mce-edit-focus"),Xi(i.element,"display"),x(!1),y()},hide:function(){p.set(!1),e.outerContainer&&(Hi(u.element,"display","none"),a.removeClass(n.getBody(),"mce-edit-focus")),Hi(i.element,"display","none")},update:y,updateMode:x,repositionPopups:b}},kB=function(n,t){var e=Au(n);return{pos:t?e.y:e.bottom,bounds:e}},CB=Object.freeze({__proto__:null,render:function(n,t,e,o,r){var i=t.mothership,u=t.uiMothership,a=t.outerContainer,c=ce(null),s=fe.fromDom(r.targetNode),f=SB(n,s,t,o,c),l=function(n){return n.getParam("toolbar_persist",!1,"boolean")}(n);dB(n);var d=function(){if(c.get())f.show();else{c.set(eB.getHeader(a).getOrDie());var r=vv(n);nf(r,i),nf(r,u),mB(n,t,e,o),eB.setMenubar(a,iB(n,e)),f.show(),function(n,t,e,o){var r=ce(kB(t,e.isPositionedAtTop())),i=function(o){var i=kB(t,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&wb(n,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(n.on("activate",e.show),n.on("deactivate",e.hide)),n.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),n.on("NodeChange keydown",(function(n){Zg.requestAnimationFrame((function(){return i(n)}))})),n.on("ScrollWindow",(function(){return e.updateMode()}));var u=ME();u.set(ay(fe.fromDom(n.getBody()),"load",i)),n.on("remove",(function(){u.clear()}))}(n,s,f,l),n.nodeChanged()}};n.on("show",d),n.on("hide",f.hide),l||(n.on("focus",d),n.on("blur",f.hide)),n.on("init",(function(){(n.hasFocus()||l)&&d()})),_v(n,t);var m={show:function(){f.show()},hide:function(){f.hide()},enable:function(){Ov(t,!1)},disable:function(){Ov(t,!0)},isDisabled:function(){return $h.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),OB=function(n,t){!function(n,t){var e=gE(0,t,wE(n));n.ui.registry.addNestedMenuItem("align",{text:t.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=gE(0,t,CE(n));n.ui.registry.addNestedMenuItem("fontformats",{text:t.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=l({type:"advanced"},t.styleselect),o=gE(0,t,VE(n,e));n.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(n,t),function(n,t){var e=gE(0,t,RE(n));n.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t),function(n,t){var e=gE(0,t,EE(n));n.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(n,t)},_B={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},TB=(vE=["Infinity","[0-9]+\\."+(hE=function(n){return"(?:"+n+")?"})("[0-9]+")+hE("[eE][+-]?[0-9]+"),"\\.[0-9]+"+hE("[eE][+-]?[0-9]+"),"[0-9]+"+hE("[eE][+-]?[0-9]+")].join("|"),new RegExp("^([+-]?(?:"+vE+"))(.*)$")),EB=function(n,t){return b.from(TB.exec(n)).bind((function(n){var e=Number(n[1]),o=n[2];return function(n,t){return R(t,(function(t){return R(_B[t],(function(t){return n===t}))}))}(o,t)?b.some({value:e,unit:o}):b.none()}))},DB=function(n){return function(n,t){return EB(n,t).map((function(n){return n.value+n.unit}))}(n,["fixed","relative","empty"]).getOr(n)},BB=function(n){var t=function(n){return n.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")}(n),e=new Map,o=AE(),r=function(){var t=DB(n.queryCommandValue("LineHeight"));b.from(e.get(t)).fold((function(){return o.clear()}),(function(n){o.set({destroy:function(){n.setActive(!1)}}),n.setActive(!0)}))};return n.on("nodeChange",r),H(t,(function(i,u){return{type:"togglemenuitem",text:i,onSetup:function(a){return e.set(DB(i),a),u+1===t.length&&r(),function(){0===u&&(n.off("nodeChange",r),o.clear())}},onAction:function(){return n.execCommand("LineHeight",!1,i)}}}))},AB=function(n){!function(n){n.ui.registry.addNestedMenuItem("lineheight",{type:"nestedmenuitem",text:"Line height",getSubmenuItems:function(){return BB(n)}})}(n),function(n){n.ui.registry.addMenuButton("lineheight",{tooltip:"Line height",icon:"line-height",fetch:function(t){return t(BB(n))}})}(n)},MB=function(n,t){return function(){n.execCommand("mceToggleFormat",!1,t)}},FB=function(n){!function(n){qS.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(t,e){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onSetup:FE(n,t.name),onAction:MB(n,t.name)})}));for(var t=1;t<=6;t++){var e="h"+t;n.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+t,onSetup:FE(n,e),onAction:MB(n,e)})}}(n),function(n){qS.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(t){n.ui.registry.addButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)}})}))}(n),function(n){qS.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,icon:t.icon,onAction:function(){return n.execCommand(t.action)},onSetup:FE(n,t.name)})}))}(n)},IB=function(n){FB(n),function(n){qS.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(t){n.ui.registry.addMenuItem(t.name,{text:t.text,icon:t.icon,shortcut:t.shortcut,onAction:function(){return n.execCommand(t.action)}})})),n.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:MB(n,"code")})}(n)},RB=function(n,t,e){var o=function(){return!!t.undoManager&&t.undoManager[e]()},r=function(){n.setDisabled(t.mode.isReadOnly()||!o())};return n.setDisabled(!o()),t.on("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r),function(){return t.off("Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",r)}},VB=function(n){!function(n){n.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:function(t){return RB(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:function(t){return RB(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(n),function(n){n.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",onSetup:function(t){return RB(t,n,"hasUndo")},onAction:function(){return n.execCommand("undo")}}),n.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",onSetup:function(t){return RB(t,n,"hasRedo")},onAction:function(){return n.execCommand("redo")}})}(n)},PB=function(n,t){!function(n){qS.each([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(t){n.ui.registry.addToggleButton(t.name,{tooltip:t.text,onAction:function(){return n.execCommand(t.cmd)},icon:t.icon,onSetup:FE(n,t.name)})}));var t="alignnone",e="No alignment",o="JustifyNone",r="align-none";n.ui.registry.addButton(t,{tooltip:e,onAction:function(){return n.execCommand(o)},icon:r})}(n),IB(n),OB(n,t),VB(n),function(n){!function(n){n.addCommand("mceApplyTextcolor",(function(t,e){!function(n,t,e){n.undoManager.transact((function(){n.focus(),n.formatter.apply(t,{value:e}),n.nodeChanged()}))}(n,t,e)})),n.addCommand("mceRemoveTextcolor",(function(t){!function(n,t){n.undoManager.transact((function(){n.focus(),n.formatter.remove(t,{value:null},null,!0),n.nodeChanged()}))}(n,t)}))}(n);var t=ce(null),e=ce(null);Rb(n,"forecolor","forecolor","Text color",t),Rb(n,"backcolor","hilitecolor","Background color",e),Vb(n,"forecolor","forecolor","Text color"),Vb(n,"backcolor","hilitecolor","Background color")}(n),function(n){!function(n){n.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:function(){return n.execCommand("mceToggleVisualAid")}})}(n),function(n){n.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:function(t){return function(n,t){n.setActive(t.hasVisual);var e=function(t){n.setActive(t.hasVisual)};return t.on("VisualAid",e),function(){return t.off("VisualAid",e)}}(t,n)},onAction:function(){n.execCommand("mceToggleVisualAid")}})}(n)}(n),function(n){!function(n){n.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:function(t){return function(n,t){n.setDisabled(!t.queryCommandState("outdent"));var e=function(){n.setDisabled(!t.queryCommandState("outdent"))};return t.on("NodeChange",e),function(){return t.off("NodeChange",e)}}(t,n)},onAction:function(){return n.execCommand("outdent")}}),n.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:function(){return n.execCommand("indent")}})}(n)}(n),AB(n)},HB=function(n,t){return{anchor:"makeshift",x:n,y:t}},zB=function(n){return"longpress"===n.type||0===n.type.indexOf("touch")},NB=function(n,t){var e=Vh.DOM.getPos(n);return function(n,t,e){return HB(n.x+t,n.y+e)}(t,e.x,e.y)},LB=function(n,t){return"contextmenu"===t.type||"longpress"===t.type?n.inline?function(n){if(zB(n)){var t=n.touches[0];return HB(t.pageX,t.pageY)}return HB(n.pageX,n.pageY)}(t):NB(n.getContentAreaContainer(),function(n){if(zB(n)){var t=n.touches[0];return HB(t.clientX,t.clientY)}return HB(n.clientX,n.clientY)}(t)):jB(n)},jB=function(n){return{anchor:"selection",root:fe.fromDom(n.selection.getNode())}},UB=function(n){return{anchor:"node",node:b.some(fe.fromDom(n.selection.getNode())),root:fe.fromDom(n.getBody())}},WB=function(n,t,e,o,r,i){var u=e(),a=i?UB(n):LB(n,t);mC(u,Xp.CLOSE_ON_EXECUTE,o,!1).map((function(n){t.preventDefault(),Lg.showMenuAt(r,a,{menu:{markers:th("normal")},data:n})}))},GB={onLtr:function(){return[Fa,Ea,Da,Ba,Aa,Ma,$g,Qg,Jg,Yg,Kg,qg]},onRtl:function(){return[Fa,Da,Ea,Aa,Ba,Ma,$g,Qg,Kg,qg,Jg,Yg]}},XB={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},YB=function(n,t,e,o,r,i,u){var a=i?UB(n):function(n,t){return l({bubble:Ec(0,12,XB),layouts:GB,overrides:{maxWidthFunction:B_(),maxHeightFunction:Cc()}},LB(n,t))}(n,t);mC(e,Xp.CLOSE_ON_EXECUTE,o,!0).map((function(e){t.preventDefault(),Lg.showMenuWithinBounds(r,a,{menu:{markers:th("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return b.some(iE(n,o.shared))})),n.fire("contexttoolbar-hide")}))},qB=function(n,t,e,o,r,i){var u=Me(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e();YB(n,t,u,o,r,i,!(s||a||c&&f))};if(!c&&!a||i)s&&!i&&n.selection.setCursorLocation(t.target,0),l();else{var d=function(){!function(n){var t=n.selection.getRng(),e=function(){Zg.setEditorTimeout(n,(function(){n.selection.setRng(t)}),10),i()};n.once("touchend",e);var o=function(n){n.preventDefault(),n.stopImmediatePropagation()};n.on("mousedown",o,!0);var r=function(){return i()};n.once("longpresscancel",r);var i=function(){n.off("touchend",e),n.off("longpresscancel",r),n.off("mousedown",o)}}(n),l()};!function(n,t){var e=n.selection;if(e.isCollapsed()||t.touches.length<1)return!1;var o=t.touches[0],r=e.getRng();return ws(n.getWin(),rs.domRange(r)).exists((function(n){return n.left<=o.clientX&&n.right>=o.clientX&&n.top<=o.clientY&&n.bottom>=o.clientY}))}(n,t)?(n.once("selectionchange",d),n.once("touchend",(function(){return n.off("selectionchange",d)}))):d()}},JB=function(n){return"string"==typeof n?n.split(/[ ,]/):n},KB=function(n){return n.getParam("contextmenu_never_use_native",!1,"boolean")},$B=function(n){return function(n,t,e){var o=n.ui.registry.getAll().contextMenus;return b.from(n.getParam(t)).map(JB).getOrThunk((function(){return L(JB(e),(function(n){return Dn(o,n)}))}))}(n,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},QB=function(n){return w(n)?"|"===n:"separator"===n.type},ZB={type:"separator"},nA=function(n){if(w(n))return n;switch(n.type){case"separator":return ZB;case"submenu":return{type:"nestedmenuitem",text:n.text,icon:n.icon,getSubmenuItems:function(){var t=n.getSubmenuItems();return w(t)?t:H(t,nA)}};default:return{type:"menuitem",text:n.text,icon:n.icon,onAction:(t=n.onAction,function(){return t()})}}var t},tA=function(n,t){if(0===t.length)return n;var e=nn(n).filter((function(n){return!QB(n)})).fold((function(){return[]}),(function(n){return[ZB]}));return n.concat(e).concat(t).concat([ZB])},eA=function(n,t){return"longpress"!==t.type&&(2!==t.button||t.target===n.getBody()&&""===t.pointerType)},oA=function(n,t){return eA(n,t)?n.selection.getStart(!0):t.target},rA=function(n,t,e){var o=Me().deviceType.isTouch,r=uu(Lg.sketch({dom:{tag:"div"},lazySink:t,onEscape:function(){return n.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:qa([tg("dismissContextMenu",[Xo(Do(),(function(t,e){mf.close(t),n.focus()}))])])})),i=function(n){return Lg.hide(r)},u=function(t){if(KB(n)&&t.preventDefault(),!function(n,t){return t.ctrlKey&&!KB(n)}(n,t)&&!function(n){return!1===n.getParam("contextmenu")}(n)){var i=function(n,t){var e=function(n){return n.getParam("contextmenu_avoid_overlap","","string")}(n);if(eA(n,t))return!0;if(e){var o=oA(n,t);return sy(fe.fromDom(o),e)}return!1}(n,t);(o()?qB:WB)(n,t,(function(){var e=oA(n,t),o=n.ui.registry.getAll(),r=$B(n);return function(n,t,e){var o=U(t,(function(t,o){if(Dn(n,o)){var r=n[o].update(e);if(w(r))return tA(t,r.split(" "));if(r.length>0){var i=H(r,nA);return tA(t,i)}return t}return t.concat([o])}),[]);return o.length>0&&QB(o[o.length-1])&&o.pop(),o}(o.contextMenus,r,e)}),e,r,i)}};n.on("init",(function(){var t="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");n.on(t,i),n.on("longpress contextmenu",u)}))},iA=An([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),uA=function(n){return function(t){return t.translate(-n.left,-n.top)}},aA=function(n){return function(t){return t.translate(n.left,n.top)}},cA=function(n){return function(t,e){return U(n,(function(n,t){return t(n)}),mu(t,e))}},sA=function(n,t,e){return n.fold(cA([aA(e),uA(t)]),cA([uA(t)]),cA([]))},fA=function(n,t,e){return n.fold(cA([aA(e)]),cA([]),cA([aA(t)]))},lA=function(n,t,e){return n.fold(cA([]),cA([uA(e)]),cA([aA(t),uA(e)]))},dA=function(n,t,e){var o=n.fold((function(n,t){return{position:b.some("absolute"),left:b.some(n+"px"),top:b.some(t+"px")}}),(function(n,t){return{position:b.some("absolute"),left:b.some(n-e.left+"px"),top:b.some(t-e.top+"px")}}),(function(n,t){return{position:b.some("fixed"),left:b.some(n+"px"),top:b.some(t+"px")}}));return l({right:b.none(),bottom:b.none()},o)},mA=function(n,t,e,o){var r=function(n,r){return function(i,u){var a=n(t,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return n.fold(r(lA,gA),r(fA,pA),r(sA,hA))},gA=iA.offset,pA=iA.absolute,hA=iA.fixed,vA=function(n,t){var e=Hr(n,t);return O(e)?NaN:parseInt(e,10)},bA=function(n,t,e,o){return function(n,t){var e=n.element,o=vA(e,t.leftAttr),r=vA(e,t.topAttr);return isNaN(o)||isNaN(r)?b.none():b.some(mu(o,r))}(n,t).fold((function(){return e}),(function(n){return hA(n.left+o.left,n.top+o.top)}))},yA=function(n,t,e,o,r,i){var u=bA(n,t,e,o),a=t.mustSnap?SA(n,t,u,r,i):kA(n,t,u,r,i),c=sA(u,r,i);return function(n,t,e){var o=n.element;Pr(o,t.leftAttr,e.left+"px"),Pr(o,t.topAttr,e.top+"px")}(n,t,c),a.fold((function(){return{coord:hA(c.left,c.top),extra:b.none()}}),(function(n){return{coord:n.output,extra:n.extra}}))},xA=function(n,t){!function(n,t){var e=n.element;Lr(e,t.leftAttr),Lr(e,t.topAttr)}(n,t)},wA=function(n,t,e,o){return en(n,(function(n){var r=n.sensor;return function(n,t,e,o,r,i){var u=fA(n,r,i),a=fA(t,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(t,r,n.range.left,n.range.top,e,o)?b.some({output:mA(n.output,t,e,o),extra:n.extra}):b.none()}))},SA=function(n,t,e,o,r){var i=t.getSnapPoints(n);return wA(i,e,o,r).orThunk((function(){return U(i,(function(n,t){var i=t.sensor,u=function(n,t,e,o,r,i){var u=fA(n,r,i),a=fA(t,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return mu(c,s)}(e,i,t.range.left,t.range.top,o,r);return n.deltas.fold((function(){return{deltas:b.some(u),snap:b.some(t)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:b.some(u),snap:b.some(t)}:n}))}),{deltas:b.none(),snap:b.none()}).snap.map((function(n){return{output:mA(n.output,e,o,r),extra:n.extra}}))}))},kA=function(n,t,e,o,r){var i=t.getSnapPoints(n);return wA(i,e,o,r)},CA=Object.freeze({__proto__:null,snapTo:function(n,t,e,o){var r=t.getTarget(n.element);if(t.repositionTarget){var i=fr(n.element),u=ku(i),a=aD(r),c=function(n,t,e){return{coord:mA(n.output,n.output,t,e),extra:n.extra}}(o,u,a),s=dA(c.coord,0,a);Ni(r,s)}}}),OA=function(n,t){n.getSystem().addToGui(t),function(n){gr(n.element).filter(ur).each((function(t){Ui(t,"z-index").each((function(n){Pr(t,"data-initial-z-index",n)})),Hi(t,"z-index",Li(n.element,"z-index"))}))}(t)},_A=function(n){!function(n){gr(n.element).filter(ur).each((function(n){zr(n,"data-initial-z-index").fold((function(){return Xi(n,"z-index")}),(function(t){return Hi(n,"z-index",t)})),Lr(n,"data-initial-z-index")}))}(n),n.getSystem().removeFromGui(n)},TA=function(n,t,e){return n.getSystem().build(Cy.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[t]},events:e}))},EA=$t("snaps",[Pt("getSnapPoints"),ra("onSensor"),Pt("leftAttr"),Pt("topAttr"),Qt("lazyViewport",Fu),Qt("mustSnap",!1)]),DA=[Qt("useFixed",c),Pt("blockerClass"),Qt("getTarget",r),Qt("onDrag",t),Qt("repositionTarget",!0),Qt("onDrop",t),re("getBounds",Fu),EA],BA=function(n){return(t=Ui(n,"left"),e=Ui(n,"top"),o=Ui(n,"position"),r=function(n,t,e){return("fixed"===e?hA:gA)(parseInt(n,10),parseInt(t,10))},t.isSome()&&e.isSome()&&o.isSome()?b.some(r(t.getOrDie(),e.getOrDie(),o.getOrDie())):b.none()).getOrThunk((function(){var t=pu(n);return pA(t.left,t.top)}));var t,e,o,r},AA=function(n,t,e,o,r,i,u){return function(n,t,e,o,r){var i=r.bounds,u=fA(t,e,o),a=vc(u.left,i.x,i.x+i.width-r.width),c=vc(u.top,i.y,i.y+i.height-r.height),s=pA(a,c);return t.fold((function(){var n=lA(s,e,o);return gA(n.left,n.top)}),(function(){return s}),(function(){var n=sA(s,e,o);return hA(n.left,n.top)}))}(0,t.fold((function(){var n,t,u,a=(n=e,t=i.left,u=i.top,n.fold((function(n,e){return gA(n+t,e+u)}),(function(n,e){return pA(n+t,e+u)}),(function(n,e){return hA(n+t,e+u)}))),c=sA(a,o,r);return hA(c.left,c.top)}),(function(t){var u=yA(n,t,e,i,o,r);return u.extra.each((function(e){t.onSensor(n,e)})),u.coord})),o,r,u)},MA=function(n,t){return{bounds:n.getBounds(),height:lu(t.element),width:yu(t.element)}},FA=function(n,t,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return MA(t,n)}));i.each((function(e){!function(n,t,e,o){var r=t.getTarget(n.element);if(t.repositionTarget){var i=fr(n.element),u=ku(i),a=aD(r),c=BA(r),s=AA(n,t.snaps,c,u,a,o,e),f=dA(s,0,a);Ni(r,f)}t.onDrag(n,r,o)}(n,t,u,e)}))},IA=function(n,t,e,o){t.each(_A),e.snaps.each((function(t){xA(n,t)}));var r=e.getTarget(n.element);o.reset(),e.onDrop(n,r)},RA=function(n){return function(t,e){var o=function(n){e.setStartData(MA(t,n))};return Uo(m([Xo(Oo(),(function(n){e.getStartData().each((function(){return o(n)}))}))],n(t,e,o)))}},VA=Object.freeze({__proto__:null,getData:function(n){return b.from(mu(n.x,n.y))},getDelta:function(n,t){return mu(t.left-n.left,t.top-n.top)}}),PA=function(n,t,e){return[Xo(Je(),(function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return IA(o,b.some(c),n,t)},u=fy(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),FA(o,n,t,VA,e)}},c=TA(o,n.blockerClass,function(n){return Uo([Xo(Je(),n.forceDrop),Xo(Qe(),n.drop),Xo(Ke(),(function(t,e){n.move(e.event)})),Xo($e(),n.delayDrop)])}(a));e(o),OA(o,c)}}))]},HA=m(DA,[ca("dragger",{handlers:RA(PA)})]),zA=Object.freeze({__proto__:null,getData:function(n){var t=n.raw.touches;return 1===t.length?function(n){var t=n[0];return b.some(mu(t.clientX,t.clientY))}(t):b.none()},getDelta:function(n,t){return mu(t.left-n.left,t.top-n.top)}}),NA=function(n,e,o){var r=ce(b.none());return[Xo(Ge(),(function(i,u){u.stop();var a=function(){IA(i,r.get(),n,e),r.set(b.none())},c={drop:a,delayDrop:t,forceDrop:a,move:function(t){FA(i,n,e,zA,t)}},s=TA(i,n.blockerClass,function(n){return Uo([Xo(Ge(),n.forceDrop),Xo(Ye(),n.drop),Xo(qe(),n.drop),Xo(Xe(),(function(t,e){n.move(e.event)}))])}(c));r.set(b.some(s));o(i),OA(i,s)})),Xo(Xe(),(function(t,o){o.stop(),FA(t,n,e,zA,o.event)})),Xo(Ye(),(function(t,o){o.stop(),IA(t,r.get(),n,e),r.set(b.none())})),Xo(qe(),(function(t){IA(t,r.get(),n,e),r.set(b.none())}))]},LA=HA,jA=m(DA,[ca("dragger",{handlers:RA(NA)})]),UA=m(DA,[ca("dragger",{handlers:RA((function(n,t,e){return m(PA(n,t,e),NA(n,t,e))}))})]),WA=Qa({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:LA,touch:jA,mouseOrTouch:UA}),name:"dragging",active:{events:function(n,t){return n.dragger.handlers(n,t)}},extra:{snap:function(n){return{sensor:n.sensor,range:n.range,output:n.output,extra:b.from(n.extra)}}},state:Object.freeze({__proto__:null,init:function(){var n=b.none(),t=b.none(),e=o({});return li({readState:e,reset:function(){n=b.none(),t=b.none()},update:function(t,e){return t.getData(e).bind((function(e){return function(t,e){var o=n.map((function(n){return t.getDelta(n,e)}));return n=b.some(e),o}(t,e)}))},getStartData:function(){return t},setStartData:function(n){t=b.some(n)}})}}),apis:CA}),GA=function(n,t,e,o,r,i){return n.fold((function(){return WA.snap({sensor:pA(e-20,o-20),range:mu(r,i),output:pA(b.some(e),b.some(o)),extra:{td:t}})}),(function(n){var r=e-20,i=o-20,u=n.element.dom.getBoundingClientRect();return WA.snap({sensor:pA(r,i),range:mu(40,40),output:pA(b.some(e-u.width/2),b.some(o-u.height/2)),extra:{td:t}})}))},XA=function(n,t,e){return{getSnapPoints:n,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(n,o){var r=o.td;(function(n,t){return n.exists((function(n){return Re(n,t)}))})(t.get(),r)||(t.set(b.some(r)),e(r))},mustSnap:!0}},YA=function(n){return tp(np.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:qa([WA.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:n}),Nx.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},qA=function(n,t){var e=ce([]),o=ce([]),r=ce(!1),i=ce(b.none()),u=ce(b.none()),a=function(n){var e=Mu(n);return GA(l.getOpt(t),n,e.x,e.y,e.width,e.height)},c=function(n){var e=Mu(n);return GA(d.getOpt(t),n,e.right,e.bottom,e.width,e.height)},s=XA((function(){return H(e.get(),(function(n){return a(n)}))}),i,(function(t){u.get().each((function(e){n.fire("TableSelectorChange",{start:t,finish:e})}))})),f=XA((function(){return H(o.get(),(function(n){return c(n)}))}),u,(function(t){i.get().each((function(e){n.fire("TableSelectorChange",{start:e,finish:t})}))})),l=YA(s),d=YA(f),m=uu(l.asSpec()),g=uu(d.asSpec()),p=function(t,e,o,r){var i=o(e);WA.snapTo(t,i);!function(t,e,o,r){var i=e.dom.getBoundingClientRect();Xi(t.element,"display");var u=mr(fe.fromDom(n.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&Hi(t.element,"display","none")}(t,e,(function(n){return n[r]<0}),(function(n,t){return n[r]>t}))},h=function(n){return p(m,n,a,"top")},v=function(n){return p(g,n,c,"bottom")};Me().deviceType.isTouch()&&(n.on("TableSelectionChange",(function(n){r.get()||(Js(t,m),Js(t,g),r.set(!0)),i.set(b.some(n.start)),u.set(b.some(n.finish)),n.otherCells.each((function(t){e.set(t.upOrLeftCells),o.set(t.downOrRightCells),h(n.start),v(n.finish)}))})),n.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(h),u.get().each(v)})),n.on("TableSelectionClear",(function(){r.get()&&(Qs(m),Qs(g),r.set(!1)),i.set(b.none()),u.set(b.none())})))};!function(n){n[n.None=0]="None",n[n.Both=1]="Both",n[n.Vertical=2]="Vertical"}(bE||(bE={}));var JA=function(n,t,e){var o=fe.fromDom(n.getContainer()),r=function(n,t,e,o,r){var i={};return i.height=yB(o+t.top,ev(n),rv(n)),e===bE.Both&&(i.width=yB(r+t.left,tv(n),ov(n))),i}(n,t,e,fu(o),bu(o));wn(r,(function(n,t){return Hi(o,t,bB(n))})),function(n){n.fire("ResizeEditor")}(n)},KA=function(n){if(1===n.nodeType){if("BR"===n.nodeName||n.getAttribute("data-mce-bogus"))return!0;if("bookmark"===n.getAttribute("data-mce-type"))return!0}return!1},$A=function(n,t,e){t.delimiter||(t.delimiter="»");return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:qa([Jm.config({mode:"flow",selector:"div[role=button]"}),$h.config({disabled:e.isDisabled}),Tv(),Ay.config({}),ng.config({}),tg("elementPathEvents",[nr((function(o,r){n.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return Jm.focusIn(o)})),n.on("NodeChange",(function(r){var i,u,a=function(t){for(var e=[],o=t.length;o-- >0;){var r=t[o];if(1===r.nodeType&&!KA(r)){var i=n.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e}(r.parents);a.length>0?ng.set(o,(i=H(a||[],(function(t,o){return np.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:t.name},action:function(e){n.focus(),n.selection.select(t.element),n.nodeChanged()},buttonBehaviours:qa([Dv(e.isDisabled),Tv()])})})),u={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+t.delimiter+" "}},U(i.slice(1),(function(n,t){var e=n;return e.push(u),e.push(t),e}),[i[0]]))):ng.set(o,[])}))}))])]),components:[]}},QA=function(n,t){var e=function(){var e,o=[];return n.getParam("elementpath",!0,"boolean")&&o.push($A(n,{},t)),n.hasPlugin("wordcount")&&o.push(function(n,t){var e,o=function(n,e,o){return ng.set(n,[ou(t.translate(["{0} "+o,e[o]]))])};return np.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:qa([Dv(t.isDisabled),Tv(),Ay.config({}),ng.config({}),Ff.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),tg("wordcount-events",[or((function(n){var t=Ff.getValue(n),e="words"===t.mode?"characters":"words";Ff.setValue(n,{mode:e,count:t.count}),o(n,t.count,e)})),nr((function(t){n.on("wordCountUpdate",(function(n){var e=Ff.getValue(t).mode;Ff.setValue(t,{mode:e,count:n.wordCount}),o(t,n.wordCount,e)}))}))])]),eventOrder:(e={},e[ho()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(n,t)),n.getParam("branding",!0,"boolean")&&o.push({dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+(e=Ph.translate(["Powered by {0}","Tiny"]))+'">'+e+"</a>"}}),o.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:o}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=function(n){var t=!n.hasPlugin("autoresize"),e=n.getParam("resize",t);return!1===e?bE.None:"both"===e?bE.Both:bE.Vertical}(n);return r!==bE.None&&o.push(function(e){return{dom:{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:t.translate("Resize"),"aria-hidden":"true"},innerHtml:op("resize-handle",t.icons)},behaviours:qa([WA.config({mode:"mouse",repositionTarget:!1,onDrag:function(t,o,r){JA(n,r,e)},blockerClass:"tox-blocker"})])}}(r)),o}()}},ZA=function(n){var e,o,r,i,u=n.inline,a=u?CB:hB,c=yv(n)?MD:iD,s=b.none(),f=Me(),d=f.browser.isIE()?["tox-platform-ie"]:[],m=f.deviceType.isTouch()?["tox-platform-touch"]:[],g=gv(n),p=vv(n),h=Ph.isRtl()?{attributes:{dir:"rtl"}}:{},v={attributes:(e={},e[Fc]=g?Gu.BottomToTop:Gu.TopToBottom,e)},y=function(){return s.bind(eB.getHeader)},x=function(){Hi(Y.element,"width",document.body.clientWidth+"px")},w=uu((o=Re(Ii(),p)&&"grid"===Li(p,"display"),r={dom:l({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(d).concat(m)},h),behaviours:qa([Ws.config({useFixed:function(){return c.isDocked(y)}})])},i={dom:{styles:{width:document.body.clientWidth+"px"}},events:Uo([Xo(_o(),x)])},In(r,o?i:{}))),S=function(){return un.value(w)},k=tp({dom:{tag:"div",classes:["tox-anchorbar"]}}),C=function(){return s.bind((function(n){return eB.getThrobber(n)})).getOrDie("Could not find throbber element")},O=D_(w,n,(function(){return s.bind((function(n){return k.getOpt(n)})).getOrDie("Could not find a anchor bar element")})),_=eB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:O,onEscape:function(){n.focus()}}),T=fv(n),E=eB.parts.toolbar(l({dom:{tag:"div",classes:["tox-toolbar"]},getSink:S,providers:O.shared.providers,onEscape:function(){n.focus()},type:T,lazyToolbar:function(){return s.bind((function(n){return eB.getToolbar(n)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return y().getOrDie("Could not find header element")}},v)),D=eB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:O.shared.providers,onEscape:function(){n.focus()},type:T}),B=eB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),A=eB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),M=eB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:O}),F=n.getParam("statusbar",!0,"boolean")&&!u?b.some(QA(n,O.shared.providers)):b.none(),I={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[B,A]},R=cv(n),V=uv(n),P=iv(n),H=eB.parts.header({dom:l({tag:"div",classes:["tox-editor-header"]},v),components:X([P?[_]:[],R?[D]:V?[E]:[],hv(n)?[]:[k.asSpec()]]),sticky:yv(n),editor:n,sharedBackstage:O.shared}),N=X([g?[]:[H],u?[]:[I],g?[H]:[]]),L=X([[{dom:{tag:"div",classes:["tox-editor-container"]},components:N}],u?[]:F.toArray(),[M]]),j=bv(n),U=l(l({role:"application"},Ph.isRtl()?{dir:"rtl"}:{}),j?{"aria-hidden":"true"}:{}),W=uu(eB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(u?["tox-tinymce-inline"]:[]).concat(g?["tox-tinymce--toolbar-bottom"]:[]).concat(m).concat(d),styles:l({visibility:"hidden"},j?{opacity:"0",border:"0"}:{}),attributes:U},components:L,behaviours:qa([Tv(),$h.config({disableClass:"tox-tinymce--disabled"}),Jm.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a"})])}));s=b.some(W),n.shortcuts.add("alt+F9","focus menubar",(function(){eB.focusMenubar(W)})),n.shortcuts.add("alt+F10","focus toolbar",(function(){eB.focusToolbar(W)})),n.addCommand("ToggleToolbarDrawer",(function(){eB.toggleToolbarDrawer(W)})),n.addQueryStateHandler("ToggleToolbarDrawer",(function(){return eB.isToolbarDrawerToggled(W)}));var G=Oy(W),Y=Oy(w);!function(n,t,e){var o=function(n,o){z([t,e],(function(t){t.broadcastEvent(n,o)}))},r=function(n,o){z([t,e],(function(t){t.broadcastOn([n],o)}))},i=function(n){return r(gf(),{target:n.target})},u=uy(fe.fromDom(document),"touchstart",i),a=uy(fe.fromDom(document),"touchmove",(function(n){return o(ko(),n)})),c=uy(fe.fromDom(document),"touchend",(function(n){return o(Co(),n)})),s=uy(fe.fromDom(document),"mousedown",i),f=uy(fe.fromDom(document),"mouseup",(function(n){0===n.raw.button&&r(hf(),{target:n.target})})),l=function(n){return r(gf(),{target:fe.fromDom(n.target)})},d=function(n){0===n.button&&r(hf(),{target:fe.fromDom(n.target)})},m=function(n){return o(Oo(),cy(n))},g=function(n){r(pf(),{}),o(_o(),cy(n))},p=function(){return r(pf(),{})},h=function(t){t.state&&r(gf(),{target:fe.fromDom(n.getContainer())})};n.on("PostRender",(function(){n.on("click",l),n.on("tap",l),n.on("mouseup",d),n.on("ScrollWindow",m),n.on("ResizeWindow",g),n.on("ResizeEditor",p),n.on("AfterProgressState",h)})),n.on("remove",(function(){n.off("click",l),n.off("tap",l),n.off("mouseup",d),n.off("ScrollWindow",m),n.off("ResizeWindow",g),n.off("ResizeEditor",p),n.off("AfterProgressState",h),s.unbind(),u.unbind(),a.unbind(),c.unbind(),f.unbind()})),n.on("detach",(function(){ef(t),ef(e),t.destroy(),e.destroy()}))}(n,G,Y);var q=function(){var t=bB(xB(n)),e=bB(function(n){return wB(n).getOr(nv(n))}(n));return n.inline||(Gi("div","width",e)&&Hi(W.element,"width",e),Gi("div","height",t)?Hi(W.element,"height",t):Hi(W.element,"height","200px")),t};return{mothership:G,uiMothership:Y,backstage:O,renderUI:function(){c.setup(n,O.shared,y),PB(n,O),rA(n,S,O),function(n){var t=n.ui.registry.getAll().sidebars;z(yn(t),(function(e){var o=t[e],r=function(){return b.from(n.queryCommandValue("ToggleSidebar")).is(e)};n.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(t){n.execCommand("ToggleSidebar",!1,e),t.setActive(r())},onSetup:function(t){var e=function(){return t.setActive(r())};return n.on("ToggleSidebar",e),function(){n.off("ToggleSidebar",e)}}})}))}(n),qD(n,C,O.shared),Sn(function(n){return n.getParam("toolbar_groups",{},"object")}(n),(function(t,e){n.ui.registry.addGroupToolbarButton(e,t)}));var t=n.ui.registry.getAll(),e=t.buttons,o=t.menuItems,r=t.contextToolbars,i=t.sidebars,u=av(n),s={menuItems:o,menus:xv(n),menubar:wv(n),toolbar:u.getOrThunk((function(){return function(n){return n.getParam("toolbar",!0)}(n)})),allowToolbarGroups:T===Gp.floating,buttons:e,sidebar:i};qE(n,r,w,{backstage:O}),qA(n,w);var f=n.getElement(),l=q(),d={mothership:G,uiMothership:Y,outerContainer:W},m={targetNode:f,height:l};return a.render(n,d,s,O,m)},getUi:function(){return{channels:{broadcastAll:Y.broadcast,broadcastOn:Y.broadcastOn,register:t}}}}},nM=o([Pt("lazySink"),Xt("dragBlockClass"),re("getBounds",Fu),Qt("useTabstopAt",s),Qt("eventOrder",{}),If("modalBehaviours",[Jm]),ia("onExecute"),aa("onEscape")]),tM={sketch:r},eM=o([fl({name:"draghandle",overrides:function(n,t){return{behaviours:qa([WA.config({mode:"mouse",getTarget:function(n){return zu(n,'[role="dialog"]').getOr(n)},blockerClass:n.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(t,null,2)).message),getBounds:n.getDragBounds})])}}}),cl({schema:[Pt("dom")],name:"title"}),cl({factory:tM,schema:[Pt("dom")],name:"close"}),cl({factory:tM,schema:[Pt("dom")],name:"body"}),fl({factory:tM,schema:[Pt("dom")],name:"footer"}),sl({factory:{sketch:function(n,t){return l(l({},n),{dom:t.dom,components:t.components})}},schema:[Qt("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),Qt("components",[])],name:"blocker"})]),oM=Object.freeze({__proto__:null,block:function(n,t,e,o){Pr(n.element,"aria-busy",!0);var r=t.getRoot(n).getOr(n),i=qa([Jm.config({mode:"special",onTab:function(){return b.some(!0)},onShiftTab:function(){return b.some(!0)}}),ug.config({})]),u=o(r,i),a=r.getSystem().build(u);ng.append(r,au(a)),a.hasConfigured(Jm)&&Jm.focusIn(a),e.isBlocked()||t.onBlock(n),e.blockWith((function(){return ng.remove(r,a)}))},unblock:function(n,t,e){Lr(n.element,"aria-busy"),e.isBlocked()&&t.onUnblock(n),e.clear()}}),rM=[re("getRoot",b.none),ra("onBlock"),ra("onUnblock")],iM=Ka({fields:rM,name:"blocking",apis:oM,state:Object.freeze({__proto__:null,init:function(){var n=AE();return li({readState:n.isSet,blockWith:function(t){n.set({destroy:t})},clear:n.clear,isBlocked:n.isSet})}})}),uM=Pl({name:"ModalDialog",configFields:nM(),partFields:eM(),factory:function(n,t,e,o){var i,u=ce(b.none()),a=qr("modal-events"),c=l(l({},n.eventOrder),((i={})[To()]=[a].concat(n.eventOrder["alloy.system.attached"]||[]),i));return{uid:n.uid,dom:n.dom,components:t,apis:{show:function(t){u.set(b.some(t));var e=n.lazySink(t).getOrDie(),r=o.blocker(),i=e.getSystem().build(l(l({},r),{components:r.components.concat([au(t)]),behaviours:qa([ug.config({}),tg("dialog-blocker-events",[Zo(no(),(function(){Jm.focusIn(t)}))])])}));Js(e,i),Jm.focusIn(t)},hide:function(n){u.set(b.none()),gr(n.element).each((function(t){n.getSystem().getByDom(t).each((function(n){Qs(n)}))}))},getBody:function(t){return kl(t,n,"body")},getFooter:function(t){return kl(t,n,"footer")},setIdle:function(n){iM.unblock(n)},setBusy:function(n,t){iM.block(n,t)}},eventOrder:c,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Vf(n.modalBehaviours,[ng.config({}),Jm.config({mode:"cyclic",onEnter:n.onExecute,onEscape:n.onEscape,useTabstopAt:n.useTabstopAt}),iM.config({getRoot:u.get}),tg(a,[nr((function(t){var e,o,i,u,a,c;e=t.element,o=kl(t,n,"title").element,i=zr(e,"id").fold((function(){var n=qr("dialog-label");return Pr(o,"id",n),n}),r),Pr(e,"aria-labelledby",i),u=t.element,a=kl(t,n,"body").element,c=b.from(Hr(u,"id")).fold((function(){var n=qr("dialog-describe");return Pr(a,"id",n),n}),r),Pr(u,"aria-describedby",c)}))])])}},apis:{show:function(n,t){n.show(t)},hide:function(n,t){n.hide(t)},getBody:function(n,t){return n.getBody(t)},getFooter:function(n,t){return n.getFooter(t)},setBusy:function(n,t,e){n.setBusy(t,e)},setIdle:function(n,t){n.setIdle(t)}}}),aM=at([Nt("type"),Nt("name")].concat(bh)),cM=Mt,sM=[gt("name","name",jn((function(){return qr("button-name")})),At),Jt("icon"),ee("align","end",["start","end"]),oe("primary",!1),oe("disabled",!1)],fM=m(sM,[Nt("text")]),lM=m([Lt("type",["submit","cancel","custom"])],fM),dM=m([Lt("type",["menu"]),Jt("text"),Jt("tooltip"),Jt("icon"),Gt("items",aM)],sM),mM=Tt("type",{submit:lM,cancel:lM,custom:lM,menu:dM}),gM=[Nt("type"),Nt("text"),Lt("level",["info","warn","error","success"]),Nt("icon"),Qt("url","")],pM=at(gM),hM=[Nt("type"),Nt("text"),oe("disabled",!1),oe("primary",!1),gt("name","name",jn((function(){return qr("button-name")})),At),Jt("icon"),oe("borderless",!1)],vM=at(hM),bM=[Nt("type"),Nt("name"),Nt("label"),oe("disabled",!1)],yM=at(bM),xM=Mt,wM=[Nt("type"),Nt("name")],SM=wM.concat([Jt("label")]),kM=SM.concat([Qt("columns","auto")]),CM=at(kM),OM=bt([Nt("value"),Nt("text"),Nt("icon")]),_M=at(SM),TM=At,EM=at(SM),DM=At,BM=wM.concat([te("tag","textarea"),Nt("scriptId"),Nt("scriptUrl"),function(n,t){return Zt(n,t,Rt)}("settings",void 0)]),AM=wM.concat([te("tag","textarea"),jt("init")]),MM=xt((function(n){return St("customeditor.old",ut(AM),n).orThunk((function(){return St("customeditor.new",ut(BM),n)}))})),FM=At,IM=at(SM),RM=ct(vt),VM=function(n){return[Nt("type"),zt("columns"),n]},PM=[Nt("type"),Nt("html"),ee("presets","presentation",["presentation","document"])],HM=at(PM),zM=SM.concat([oe("sandboxed",!0)]),NM=at(zM),LM=At,jM=SM.concat([Ht("currentState",at([Pt("blob"),Nt("url")]))]),UM=at(jM),WM=SM.concat([Jt("inputMode"),Jt("placeholder"),oe("maximized",!1),oe("disabled",!1)]),GM=at(WM),XM=At,YM=function(n){return[Nt("type"),Nt("label"),n]},qM=[Nt("text"),Nt("value")],JM=[Nt("text"),Gt("items",function(n,t){return e=t,o=Vn((function(){return e()})),{extract:function(n,t,e){return o().extract(n,t,e)},toString:function(){return o().toString()}};var e,o}(0,(function(){return KM})))],KM=st([at(qM),at(JM)]),$M=SM.concat([Gt("items",KM),oe("disabled",!1)]),QM=at($M),ZM=At,nF=SM.concat([Wt("items",[Nt("text"),Nt("value")]),ne("size",1),oe("disabled",!1)]),tF=at(nF),eF=At,oF=SM.concat([oe("constrain",!0),oe("disabled",!1)]),rF=at(oF),iF=at([Nt("width"),Nt("height")]),uF=[Nt("type"),Gt("header",At),Gt("cells",ct(At))],aF=at(uF),cF=SM.concat([Jt("placeholder"),oe("maximized",!1),oe("disabled",!1)]),sF=at(cF),fF=At,lF=SM.concat([ee("filetype","file",["image","media","file"]),Qt("disabled",!1)]),dF=at(lF),mF=at([Nt("value"),Qt("meta",{})]),gF=function(n){return gt("items","items",Nn(),ct(xt((function(t){return St("Checking item of "+n,pF,t).fold((function(n){return un.error(Ot(n))}),(function(n){return un.value(n)}))}))))},pF=yt((function(){return _t("type",{alertbanner:pM,bar:at((n=gF("bar"),[Nt("type"),n])),button:vM,checkbox:yM,colorinput:_M,colorpicker:EM,dropzone:IM,grid:at(VM(gF("grid"))),iframe:NM,input:GM,listbox:QM,selectbox:tF,sizeinput:rF,textarea:sF,urlinput:dF,customeditor:MM,htmlpanel:HM,imagetools:UM,collection:CM,label:at(YM(gF("label"))),table:aF,panel:vF});var n})),hF=[Nt("type"),Qt("classes",[]),Gt("items",pF)],vF=at(hF),bF=[gt("name","name",jn((function(){return qr("tab-name")})),At),Nt("title"),Gt("items",pF)],yF=[Nt("type"),Wt("tabs",bF)],xF=at(yF),wF=fM,SF=mM,kF=at([Nt("title"),Ht("body",_t("type",{panel:vF,tabpanel:xF})),te("size","normal"),Gt("buttons",SF),Qt("initialData",{}),re("onAction",t),re("onChange",t),re("onSubmit",t),re("onClose",t),re("onCancel",t),Qt("onTabChange",t)]),CF=at(m([Lt("type",["cancel","custom"])],wF)),OF=at([Nt("title"),Nt("url"),qt("height"),qt("width"),function(n,t){return Yt(n,ct(t))}("buttons",CF),re("onAction",t),re("onCancel",t),re("onClose",t),re("onMessage",t)]),_F=function(n){return S(n)?[n].concat(Y(Tn(n),_F)):k(n)?Y(n,_F):[]},TF=function(n){return w(n.type)&&w(n.name)},EF={checkbox:xM,colorinput:TM,colorpicker:DM,dropzone:RM,input:XM,iframe:LM,sizeinput:iF,selectbox:eF,listbox:ZM,size:iF,textarea:fF,urlinput:mF,customeditor:FM,collection:OM,togglemenuitem:cM},DF=function(n){var t=function(n){return L(_F(n),TF)}(n),e=Y(t,(function(n){return function(n){return b.from(EF[n.type])}(n).fold((function(){return[]}),(function(t){return[Ht(n.name,t)]}))}));return at(e)},BF=function(n){return{internalDialog:kt(St("dialog",kF,n)),dataValidator:DF(n),initialData:n.initialData}},AF={open:function(n,t){var e=BF(t);return n(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(n,t){return n(kt(St("dialog",OF,t)))},redial:function(n){return BF(n)}},MF=function(n){var t=[],e={};return wn(n,(function(n,o){n.fold((function(){t.push(o)}),(function(n){e[o]=n}))})),t.length>0?un.error(t):un.value(e)},FF=function(n,t){var e=tp(RS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(n.classes)},components:H(n.items,(function(n){return RO(e,n,t)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:qa([Jm.config({mode:"acyclic",useTabstopAt:u(sk)}),US(e),QS(e,{postprocess:function(n){return MF(n).fold((function(n){return console.error(n),{}}),(function(n){return n}))}})])}},IF=Vl({name:"TabButton",configFields:[Qt("uid",void 0),Pt("value"),gt("dom","dom",Un((function(){return{attributes:{role:"tab",id:qr("aria"),"aria-selected":"false"}}})),Et()),Xt("action"),Qt("domModification",{}),If("tabButtonBehaviours",[ug,Jm,Ff]),Pt("view")],factory:function(n,t){return{uid:n.uid,dom:n.dom,components:n.components,events:xg(n.action),behaviours:Vf(n.tabButtonBehaviours,[ug.config({}),Jm.config({mode:"execution",useSpace:!0,useEnter:!0}),Ff.config({store:{mode:"memory",initialValue:n.value}})]),domModification:n.domModification}}}),RF=o([Pt("tabs"),Pt("dom"),Qt("clickToDismiss",!1),If("tabbarBehaviours",[nd,Jm]),ea(["tabClass","selectedClass"])]),VF=ll({factory:IF,name:"tabs",unit:"tab",overrides:function(n){var e=function(n,t){nd.dehighlight(n,t),Ho(n,Io(),{tabbar:n,button:t})},o=function(n,t){nd.highlight(n,t),Ho(n,Fo(),{tabbar:n,button:t})};return{action:function(r){var i=r.getSystem().getByUid(n.uid).getOrDie(),u=nd.isHighlighted(i,r);(u&&n.clickToDismiss?e:u?t:o)(i,r)},domModification:{classes:[n.markers.tabClass]}}}}),PF=o([VF]),HF=Pl({name:"Tabbar",configFields:RF(),partFields:PF(),factory:function(n,t,e,o){return{uid:n.uid,dom:n.dom,components:t,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Vf(n.tabbarBehaviours,[nd.config({highlightClass:n.markers.selectedClass,itemClass:n.markers.tabClass,onHighlight:function(n,t){Pr(t.element,"aria-selected","true")},onDehighlight:function(n,t){Pr(t.element,"aria-selected","false")}}),Jm.config({mode:"flow",getInitial:function(n){return nd.getHighlighted(n).map((function(n){return n.element}))},selector:"."+n.markers.tabClass,executeOnMove:!0})])}}}),zF=Vl({name:"Tabview",configFields:[If("tabviewBehaviours",[ng])],factory:function(n,t){return{uid:n.uid,dom:n.dom,behaviours:Vf(n.tabviewBehaviours,[ng.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),NF=o([Qt("selectFirst",!0),ra("onChangeTab"),ra("onDismissTab"),Qt("tabs",[]),If("tabSectionBehaviours",[])]),LF=cl({factory:HF,schema:[Pt("dom"),Ut("markers",[Pt("tabClass"),Pt("selectedClass")])],name:"tabbar",defaults:function(n){return{tabs:n.tabs}}}),jF=cl({factory:zF,name:"tabview"}),UF=o([LF,jF]),WF=Pl({name:"TabSection",configFields:NF(),partFields:UF(),factory:function(n,t,e,o){var r=function(t,e){Sl(t,n,"tabbar").each((function(n){e(n).each(zo)}))};return{uid:n.uid,dom:n.dom,components:t,behaviours:Rf(n.tabSectionBehaviours),events:Uo(X([n.selectFirst?[nr((function(n,t){r(n,nd.getFirst)}))]:[],[Xo(Fo(),(function(t,e){!function(t){var e=Ff.getValue(t);Sl(t,n,"tabview").each((function(o){W(n.tabs,(function(n){return n.value===e})).each((function(e){var r=e.view();zr(t.element,"id").each((function(n){Pr(o.element,"aria-labelledby",n)})),ng.set(o,r),n.onChangeTab(o,t,r)}))}))}(e.event.button)})),Xo(Io(),(function(t,e){var o=e.event.button;n.onDismissTab(t,o)}))]])),apis:{getViewItems:function(t){return Sl(t,n,"tabview").map((function(n){return ng.contents(n)})).getOr([])},showTab:function(n,t){r(n,(function(n){var e=nd.getCandidates(n);return W(e,(function(n){return Ff.getValue(n)===t})).filter((function(t){return!nd.isHighlighted(n,t)}))}))}}}},apis:{getViewItems:function(n,t){return n.getViewItems(t)},showTab:function(n,t,e){n.showTab(t,e)}}}),GF=function(n,t){Hi(n,"height",t+"px"),Me().browser.isIE()?Xi(n,"flex-basis"):Hi(n,"flex-basis",t+"px")},XF=function(n,t,e){zu(n,'[role="dialog"]').each((function(n){Nu(n,'[role="tablist"]').each((function(o){e.get().map((function(e){return Hi(t,"height","0"),Hi(t,"flex-basis","0"),Math.min(e,function(n,t,e){var o,r=dr(n).dom,i=zu(n,".tox-dialog-wrap").getOr(n);o="fixed"===Li(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var u=fu(t),a=t.dom.offsetLeft>=e.dom.offsetLeft+bu(e)?Math.max(fu(e),u):u,c=parseInt(Li(n,"margin-top"),10)||0,s=parseInt(Li(n,"margin-bottom"),10)||0;return o-(fu(n)+c+s-a)}(n,t,o))})).each((function(n){GF(t,n)}))}))}))},YF=function(n){return Nu(n,'[role="tabpanel"]')},qF=function(n){var t;return{smartTabHeight:(t=ce(b.none()),{extraEvents:[nr((function(e){var o=e.element;YF(o).each((function(r){Hi(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){var o=function(n){return Z($(n,(function(n,t){return n>t?-1:n<t?1:0})))}(function(n,t,e){return H(n,(function(o,r){ng.set(e,n[r].view());var i=t.dom.getBoundingClientRect();return ng.set(e,[]),i.height}))}(n,r,e));t.set(o)})),XF(o,r,t),Xi(r,"visibility"),function(n,t){Z(n).each((function(n){return WF.showTab(t,n.value)}))}(n,e),Zg.requestAnimationFrame((function(){XF(o,r,t)}))}))})),Xo(_o(),(function(n){var e=n.element;YF(e).each((function(n){XF(e,n,t)}))})),Xo(Gy,(function(n,e){var o=n.element;YF(o).each((function(n){var e=oc(wr(n));Hi(n,"visibility","hidden");var r=Ui(n,"height").map((function(n){return parseInt(n,10)}));Xi(n,"height"),Xi(n,"flex-basis");var i=n.dom.getBoundingClientRect().height;r.forall((function(n){return i>n}))?(t.set(b.from(i)),XF(o,n,t)):r.each((function(t){GF(n,t)})),Xi(n,"visibility"),e.each(ec)}))}))],selectFirst:!1}),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},JF=function(n,t){var e=ce({}),o=function(n){var t=Ff.getValue(n),o=MF(t).getOr({}),r=e.get(),i=In(r,o);e.set(i)},r=function(n){var t=e.get();Ff.setValue(n,t)},i=ce(null),a=H(n.tabs,(function(n){return{value:n.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:t.shared.providers.translate(n.title)},view:function(){return[RS.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:H(n.items,(function(n){return RO(e,n,t)})),formBehaviours:qa([Jm.config({mode:"acyclic",useTabstopAt:u(sk)}),tg("TabView.form.events",[nr(r),tr(o)]),nc.config({channels:Yn([{key:"send-data-to-section",value:{onReceive:o}},{key:"send-data-to-view",value:{onReceive:r}}])})])}}))]}}})),c=qF(a).smartTabHeight;return WF.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(n,t,e){var o=Ff.getValue(t);Ho(n,Wy,{name:o,oldName:i.get()}),i.set(o)},tabs:a,components:[WF.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[HF.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:qa([Ay.config({})])}),WF.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:c.selectFirst,tabSectionBehaviours:qa([tg("tabpanel",c.extraEvents),Jm.config({mode:"acyclic"}),Ul.config({find:function(n){return Z(WF.getViewItems(n))}}),Ff.config({store:{mode:"manual",getValue:function(n){return n.getSystem().broadcastOn(["send-data-to-section"],{}),e.get()},setValue:function(n,t){e.set(t),n.getSystem().broadcastOn(["send-data-to-view"],{})}}})])})},KF=qr("update-dialog"),$F=qr("update-title"),QF=qr("update-body"),ZF=qr("update-footer"),nI=qr("body-send-message"),tI=function(n,t,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:l(l({},t.map((function(n){return{id:n}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:qa([WS(0),HT.config({channel:QF,updateState:function(n,t){return b.some({isTabPanel:function(){return"tabpanel"===t.body.type}})},renderComponents:function(n){switch(n.body.type){case"tabpanel":return[JF(n.body,e)];default:return[FF(n.body,e)]}},initialData:n})])}},eI=Nv.deviceType.isTouch(),oI=function(n,t){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[n,t]}},rI=function(n,t){return uM.parts.close(np.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close")}},action:n,buttonBehaviours:qa([Ay.config({})])}))},iI=function(){return uM.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},uI=function(n,t){return uM.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:XD("<p>"+t.translate(n)+"</p>")}]}]})},aI=function(n){return uM.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:n})},cI=function(n,t){return[Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:n}),Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:t})]},sI=function(n){var t,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return uM.sketch({lazySink:n.lazySink,onEscape:function(t){return n.onEscape(t),b.some(!0)},useTabstopAt:function(n){return!sk(n)},dom:{tag:"div",classes:[e].concat(n.extraClasses),styles:l({position:"relative"},n.extraStyles)},components:m([n.header,n.body],n.footer.toArray()),parts:{blocker:{dom:XD('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:eI?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:qa(m([ug.config({}),tg("dialog-events",n.dialogEvents.concat([Zo(no(),(function(n,t){Jm.focusIn(n)}))])),tg("scroll-lock",[nr((function(){_i(Ii(),i)})),tr((function(){Ei(Ii(),i)}))])],n.extraBehaviours)),eventOrder:l((t={},t[ho()]=["dialog-events"],t[To()]=["scroll-lock","dialog-events","alloy.base.behaviour"],t[Eo()]=["alloy.base.behaviour","dialog-events","scroll-lock"],t),n.eventOrder)})},fI=function(n){return np.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close"),title:n.translate("Close")}},components:[{dom:{tag:"div",classes:["tox-icon"],innerHtml:op("close",n.icons)}}],action:function(n){Po(n,zy)}})},lI=function(n,t,e){var o=function(n){return[ou(e.translate(n.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:l({},t.map((function(n){return{id:n}})).getOr({}))},components:o(n),behaviours:qa([HT.config({channel:$F,renderComponents:o})])}},dI=function(){return{dom:XD('<div class="tox-dialog__draghandle"></div>')}},mI=function(n,t){return function(n,t){var e=uM.parts.title(lI(n,b.none(),t)),o=uM.parts.draghandle(dI()),r=uM.parts.close(fI(t)),i=[e].concat(n.draggable?[o]:[]).concat([r]);return Cy.sketch({dom:XD('<div class="tox-dialog__header"></div>'),components:i})}({title:t.shared.providers.translate(n),draggable:t.dialog.isDraggableModal()},t.shared.providers)},gI=function(n,t,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(n)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:t,components:[{dom:XD('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},pI=function(n,t,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){uM.setBusy(n(),(function(n,o){return gI(e.message,o,t)}))},onUnblock:function(){uM.setIdle(n())}}},hI=function(n,t,e,o){var r;return uu(sI(l(l({},n),{lazySink:o.shared.getSink,extraBehaviours:m([HT.config({channel:KF,updateState:function(n,t){return b.some(t)},initialData:t}),tk({})],n.extraBehaviours),onEscape:function(n){Po(n,zy)},dialogEvents:e,eventOrder:(r={},r[po()]=[HT.name(),nc.name()],r[To()]=["scroll-lock",HT.name(),"messages","dialog-events","alloy.base.behaviour"],r[Eo()]=["alloy.base.behaviour","dialog-events","messages",HT.name(),"scroll-lock"],r)})))},vI=function(n){return H(n,(function(n){return"menu"===n.type?function(n){var t=H(n.items,(function(n){var t=ce(!1);return l(l({},n),{storage:t})}));return l(l({},n),{items:t})}(n):n}))},bI=function(n){return U(n,(function(n,t){return"menu"===t.type?U(t.items,(function(n,t){return n[t.name]=t.storage,n}),n):n}),{})},yI=function(n,t){return[Ko(no(),ck),n(Hy,(function(n,e){t.onClose(),e.onClose()})),n(zy,(function(n,t,e,o){t.onCancel(n),Po(o,Hy)})),Xo(Uy,(function(n,e){return t.onUnblock()})),Xo(jy,(function(n,e){return t.onBlock(e.event)}))]},xI=function(n,t){var e=function(t,e){return Xo(t,(function(t,r){o(t,(function(o,i){e(n(),o,r.event,t)}))}))},o=function(n,t){HT.getState(n).get().each((function(e){t(e,n)}))};return m(yI(e,t),[e(Ny,(function(n,t,e){t.onAction(n,{name:e.name})}))])},wI=function(n,t,e){var o=function(t,e){return Xo(t,(function(t,o){r(t,(function(r,i){e(n(),r,o.event,t)}))}))},r=function(n,t){HT.getState(n).get().each((function(e){t(e.internalDialog,n)}))};return m(yI(o,t),[o(Ly,(function(n,t){return t.onSubmit(n)})),o(Py,(function(n,t,e){t.onChange(n,{name:e.name})})),o(Ny,(function(n,t,o,r){var i=function(){return Jm.focusIn(r)},u=function(n){return Nr(n,"disabled")||zr(n,"aria-disabled").exists((function(n){return"true"===n}))},a=wr(r.element),c=oc(a);t.onAction(n,{name:o.name,value:o.value}),oc(a).fold(i,(function(n){u(n)||c.exists((function(t){return Pe(n,t)&&u(t)}))?i():e().toOptional().filter((function(t){return!Pe(t.element,n)})).each(i)}))})),o(Wy,(function(n,t,e){t.onTabChange(n,{newTabName:e.name,oldTabName:e.oldName})})),tr((function(t){var e=n();Ff.setValue(t,e.getData())}))])},SI=function(n,t){var e=t.map((function(n){return n.footerButtons})).getOr([]),o=N(e,(function(n){return"start"===n.align})),r=function(n,t){return Cy.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+n]},components:H(t,(function(n){return n.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},kI=function(n,t){return{dom:XD('<div class="tox-dialog__footer"></div>'),components:[],behaviours:qa([HT.config({channel:ZF,initialData:n,updateState:function(n,e){var o=H(e.buttons,(function(n){var e=tp(function(n,t){return kC(n,n.type,t)}(n,t));return{name:n.name,align:n.align,memento:e}}));return b.some({lookupByName:function(n,t){return function(n,t,e){return W(t,(function(n){return n.name===e})).bind((function(t){return t.memento.getOpt(n)}))}(n,o,t)},footerButtons:o})},renderComponents:SI})])}},CI=function(n,t){return uM.parts.footer(kI(n,t))},OI=function(n,t){if(n.getRoot().getSystem().isConnected()){var e=Ul.getCurrent(n.getFormWrapper()).getOr(n.getFormWrapper());return RS.getField(e,t).fold((function(){var o=n.getFooter();return HT.getState(o).get().bind((function(n){return n.lookupByName(e,t)}))}),(function(n){return b.some(n)}))}return b.none()},_I=function(n,t,e){var o=function(t){var e=n.getRoot();e.getSystem().isConnected()&&t(e)},r={getData:function(){var t=n.getRoot(),o=t.getSystem().isConnected()?n.getFormWrapper():t,r=Ff.getValue(o),i=Sn(e,(function(n){return n.get()}));return l(l({},r),i)},setData:function(t){o((function(o){var i=r.getData(),u=l(l({},i),t),a=function(n,t){var e=n.getRoot();return HT.getState(e).get().map((function(n){return kt(St("data",n.dataValidator,t))})).getOr(t)}(n,u),c=n.getFormWrapper();Ff.setValue(c,a),wn(e,(function(n,t){Dn(u,t)&&n.set(u[t])}))}))},disable:function(t){OI(n,t).each($h.disable)},enable:function(t){OI(n,t).each($h.enable)},focus:function(t){OI(n,t).each(ug.focus)},block:function(n){if(!w(n))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(t){Ho(t,jy,{message:n})}))},unblock:function(){o((function(n){Po(n,Uy)}))},showTab:function(t){o((function(e){var o=n.getBody();HT.getState(o).get().exists((function(n){return n.isTabPanel()}))&&Ul.getCurrent(o).each((function(n){WF.showTab(n,t)}))}))},redial:function(n){o((function(e){var o=t(n);e.getSystem().broadcastOn([KF],o),e.getSystem().broadcastOn([$F],o.internalDialog),e.getSystem().broadcastOn([QF],o.internalDialog),e.getSystem().broadcastOn([ZF],o.internalDialog),r.setData(o.initialData)}))},close:function(){o((function(n){Po(n,Hy)}))}};return r},TI=function(n,t,e){var o=mI(n.internalDialog.title,e),r=function(n,t){var e=tI(n,b.none(),t,!1);return uM.parts.body(e)}({body:n.internalDialog.body},e),i=vI(n.internalDialog.buttons),u=bI(i),a=CI({buttons:i},e),c=wI((function(){return d}),pI((function(){return l}),e.shared.providers,t),e.shared.getSink),s=function(n){switch(n){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(n.internalDialog.size),f={header:o,body:r,footer:b.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=hI(f,n,c,e),d=_I({getRoot:function(){return l},getBody:function(){return uM.getBody(l)},getFooter:function(){return uM.getFooter(l)},getFormWrapper:function(){var n=uM.getBody(l);return Ul.getCurrent(n).getOr(n)}},t.redial,u);return{dialog:l,instanceApi:d}},EI=function(n,t,e,o){var r,i,u,a,c,s=qr("dialog-label"),f=qr("dialog-content"),l=tp((u={title:n.internalDialog.title,draggable:!0},a=s,c=e.shared.providers,Cy.sketch({dom:XD('<div class="tox-dialog__header"></div>'),components:[lI(u,b.some(a),c),dI(),fI(c)],containerBehaviours:qa([WA.config({mode:"mouse",blockerClass:"blocker",getTarget:function(n){return Lu(n,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])}))),d=tp(function(n,t,e,o){return tI(n,b.some(t),e,o)}({body:n.internalDialog.body},f,e,o)),m=vI(n.internalDialog.buttons),g=bI(m),p=tp(function(n,t){return kI(n,t)}({buttons:m},e)),h=wI((function(){return y}),{onBlock:function(n){iM.block(v,(function(t,o){return gI(n.message,o,e.shared.providers)}))},onUnblock:function(){iM.unblock(v)},onClose:function(){return t.closeWindow()}},e.shared.getSink),v=uu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=s,r["aria-describedby"]=""+f,r)},eventOrder:(i={},i[po()]=[HT.name(),nc.name()],i[ho()]=["execute-on-form"],i[To()]=["reflecting","execute-on-form"],i),behaviours:qa([Jm.config({mode:"cyclic",onEscape:function(n){return Po(n,Hy),b.some(!0)},useTabstopAt:function(n){return!sk(n)&&("button"!==rr(n)||"disabled"!==Hr(n,"disabled"))}}),HT.config({channel:KF,updateState:function(n,t){return b.some(t)},initialData:n}),ug.config({}),tg("execute-on-form",h.concat([Zo(no(),(function(n,t){Jm.focusIn(n)}))])),iM.config({getRoot:function(){return b.some(v)}}),ng.config({}),tk({})]),components:[l.asSpec(),d.asSpec(),p.asSpec()]}),y=_I({getRoot:function(){return v},getFooter:function(){return p.get(v)},getBody:function(){return d.get(v)},getFormWrapper:function(){var n=d.get(v);return Ul.getCurrent(n).getOr(n)}},t.redial,g);return{dialog:v,instanceApi:y}},DI=tinymce.util.Tools.resolve("tinymce.util.URI"),BI=["insertContent","setContent","execCommand","close","block","unblock"],AI=function(n){return S(n)&&-1!==BI.indexOf(n.mceAction)},MI=function(n,t,e,o){var r,i,a,c=mI(n.title,o),s=function(n){var t={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[uk({dom:{tag:"iframe",attributes:{src:n.url}},behaviours:qa([Ay.config({}),ug.config({})])})]}],behaviours:qa([Jm.config({mode:"acyclic",useTabstopAt:u(sk)})])};return uM.parts.body(t)}(n),f=n.buttons.bind((function(n){return 0===n.length?b.none():b.some(CI({buttons:n},o))})),d=xI((function(){return k}),pI((function(){return x}),o.shared.providers,t)),m=l(l({},n.height.fold((function(){return{}}),(function(n){return{height:n+"px","max-height":n+"px"}}))),n.width.fold((function(){return{}}),(function(n){return{width:n+"px","max-width":n+"px"}}))),g=n.width.isNone()&&n.height.isNone()?["tox-dialog--width-lg"]:[],p=new DI(n.url,{base_uri:new DI(window.location.href)}),h=p.protocol+"://"+p.host+(p.port?":"+p.port:""),v=ce(b.none()),y=[tg("messages",[nr((function(){var t=uy(fe.fromDom(window),"message",(function(t){if(p.isSameOrigin(new DI(t.raw.origin))){var o=t.raw.data;AI(o)?function(n,t,e){switch(e.mceAction){case"insertContent":n.insertContent(e.content);break;case"setContent":n.setContent(e.content);break;case"execCommand":var o=!!C(e.ui)&&e.ui;n.execCommand(e.cmd,o,e.value);break;case"close":t.close();break;case"block":t.block(e.message);break;case"unblock":t.unblock()}}(e,k,o):function(n){return!AI(n)&&S(n)&&Dn(n,"mceAction")}(o)&&n.onMessage(k,o)}}));v.set(b.some(t))})),tr((function(){v.get().each((function(n){return n.unbind()}))}))]),nc.config({channels:(r={},r[nI]={onReceive:function(n,t){Nu(n.element,"iframe").each((function(n){n.dom.contentWindow.postMessage(t,h)}))}},r)})],x=hI({header:c,body:s,footer:f,extraClasses:g,extraBehaviours:y,extraStyles:m},n,d,o),k=(i=x,a=function(n){i.getSystem().isConnected()&&n(i)},{block:function(n){if(!w(n))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");a((function(t){Ho(t,jy,{message:n})}))},unblock:function(){a((function(n){Po(n,Uy)}))},close:function(){a((function(n){Po(n,Hy)}))},sendMessage:function(n){a((function(t){t.getSystem().broadcastOn([nI],n)}))}});return{dialog:x,instanceApi:k}},FI=function(n,t,e){return t&&e?[]:[_D.config({contextual:{lazyContext:function(){return b.some(Au(fe.fromDom(n.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},II=function(n){var t=n.backstage,e=n.editor,o=yv(e),r=function(n){var t=n.backstage.shared;return{open:function(e,o){var r=function(){uM.hide(c),o()},i=tp(kC({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:b.none()},"cancel",n.backstage)),u=iI(),a=rI(r,t.providers),c=uu(sI({lazySink:function(){return t.getSink()},header:oI(u,a),body:uI(e,t.providers),footer:b.some(aI(cI([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Xo(zy,r)],eventOrder:{}}));uM.show(c);var s=i.get(c);ug.focus(s)}}}(n),i=function(n){var t=n.backstage.shared;return{open:function(e,o){var r=function(n){uM.hide(s),o(n)},i=tp(kC({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:b.none()},"submit",n.backstage)),u=kC({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:b.none()},"cancel",n.backstage),a=iI(),c=rI((function(){return r(!1)}),t.providers),s=uu(sI({lazySink:function(){return t.getSink()},header:oI(a,c),body:uI(e,t.providers),footer:b.some(aI(cI([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Xo(zy,(function(){return r(!1)})),Xo(Ly,(function(){return r(!0)}))],eventOrder:{}}));uM.show(s);var f=i.get(s);ug.focus(f)}}}(n),u=function(n,o){return AF.openUrl((function(n){var r=MI(n,{closeWindow:function(){uM.hide(r.dialog),o(r.instanceApi)}},e,t);return uM.show(r.dialog),r.instanceApi}),n)},a=function(n,e){return AF.open((function(n,o,r){var i=o,u=TI({dataValidator:r,initialData:i,internalDialog:n},{redial:AF.redial,closeWindow:function(){uM.hide(u.dialog),e(u.instanceApi)}},t);return uM.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),n)},c=function(n,r,i,u){return AF.open((function(n,a,c){var s,f=kt(St("data",c,a)),d=(s=ce(b.none()),{clear:function(){return s.set(b.none())},set:function(n){return s.set(b.some(n))},isSet:function(){return s.get().isSome()},on:function(n){return s.get().each(n)}}),g=t.shared.header.isPositionedAtTop(),p=function(){return d.on((function(n){Lg.reposition(n),_D.refresh(n)}))},h=EI({dataValidator:c,initialData:f,internalDialog:n},{redial:AF.redial,closeWindow:function(){d.on(Lg.hide),e.off("ResizeEditor",p),d.clear(),i(h.instanceApi)}},t,u),v=uu(Lg.sketch(l(l({lazySink:t.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},g?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:qa(m([tg("window-manager-inline-events",[Xo(Do(),(function(n,t){Po(h.dialog,zy)}))])],FI(e,o,g))),isExtraPart:function(n,t){return function(n){return sy(n,".tox-alert-dialog")||sy(n,".tox-confirm-dialog")}(t)}})));return d.set(v),Lg.showWithin(v,r,au(h.dialog),b.some(Ii())),o&&g||(_D.refresh(v),e.on("ResizeEditor",p)),h.instanceApi.setData(f),Jm.focusIn(h.dialog),h.instanceApi}),n)};return{open:function(n,e,o){return void 0!==e&&"toolbar"===e.inline?c(n,t.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(n,t.shared.anchors.cursor(),o,e.ariaAttrs):a(n,o)},openUrl:function(n,t){return u(n,t)},alert:function(n,t){r.open(n,(function(){t()}))},close:function(n){n.close()},confirm:function(n,t){i.open(n,(function(n){t(n)}))}}};f.add("silver",(function(n){var t=ZA(n),e=t.uiMothership,r=t.backstage,i=t.renderUI,u=t.getUi;ry(n,r.shared);var a=II({editor:n,backstage:r});return{renderUI:i,getWindowManagerImpl:o(a),getNotificationManagerImpl:function(){return ap(0,{backstage:r},e)},ui:u()}}))}()}).call(this,e(59))},656:function(n,t,e){e(620)}}]);